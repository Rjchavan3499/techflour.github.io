var ZCSecurity=new function(){this.isURLXSSVulnerable=function(E){if(E){var B=E.trim().toLowerCase();var D=document.createElement("a");D.href=B;var A=D.protocol;if(A.indexOf("javascript:")===0||A.indexOf("vbscript:")===0||A.indexOf("data:")===0){return true}B=B.replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,'"').replace(/'/g,"'");try{var F=decodeURIComponent(ZCSecurity.safariCheck(B)).replace(/[^\w:]/g,"").toLowerCase()}catch(C){}if(F.indexOf("javascript:")===0||F.indexOf("vbscript:")===0||F.indexOf("data:")===0){return true}}return false};this.isValidURL=function(B){try{if(B){B=B.trim().toLowerCase();if(B.match("^(#|www|\\/|https?:|ftp:|mailto:)")){return true}}}catch(A){return false}return false};this.safariCheck=function(A){return A.replace(/&([#\w]+);/g,function(C,B){if(B==="colon"){return":"}if(B.charAt(0)==="#"){return B.charAt(1)==="x"?String.fromCharCode(parseInt(B.substring(2),16)):String.fromCharCode(+B.substring(1))}return""})}}();var FormController=(function(G){ControllerFactory.call(this,G,ObjectType.FORM);var H=this;var I=[],B=[],E="";var A,J,C,D,F=false;this.fieldControllers={},this.buttonControllers={};this.hasSubforms=false;H.isSubmitted=false;this.isFormFullScreen=function(){return false};this.isEmbedorPerma=function(){var M=document.body.classList.contains("zc-page-perma");var L=document.body.classList.contains("zc-form-perma");var K=document.body.classList.contains("zc-form-embed");var N=document.body.classList.contains("zc-report-embed")||document.body.classList.contains("zc-report-perma");return L||K||N||M};this.modifyStylesToContainer=function(){document.getElementById("zc-component").classList.add("zc-form-container")};this.bindCloseBtn=function(){};this.bindEvents=function(){H.getView().removeStyleFromForm();document.body.classList.remove("zc-subform-header-fixed");if(document.getElementById("zc-component")){document.getElementById("zc-component").classList.remove("zc-form-container","zc-form-edit-container")}if(!isMobileBrowser()){H.bindCloseBtn()}var L=H.container||H.getView().getDOM().getFormParentContainer().parentElement;this.withinPopup=L.classList.contains("popupConentContainer");this.hasSubforms=L.querySelectorAll("[elname=subformdiv]").length>0;if(this.hasSubforms){this.subFormElems=L.querySelectorAll("[elname=subformdiv]")}this.isNotPage=!document.getElementById("zc-component").classList.contains("zc-page-content-wrapper")&&!document.getElementById("zc-component").querySelector(".zc-htmlpage-old-table")&&!document.body.classList.contains("zc-page-perma");this.isNotPage=this.isNotPage||this.withinPopup;var O=document.body.classList.contains("zc-form-perma");var P=document.body.classList.contains("zc-form-embed");var R=O||P||document.body.classList.contains("zc-page-perma");if(R&&!this.withinPopup){L=document}if(this.withinPopup){if(this.hasSubforms){$(L).trigger("popupSubformClass")}else{if(G.getAccessType()==FormAccessType.ADD_RECORD||G.getAccessType()==FormAccessType.LOOKUP_ADD){$(L).closest(".popupbox").addClass("formWithinPopup")}}}D=this.addFormStyle();C=this.adjustFormAlign();window.addEventListener("message",openURLListener);promises=H.resolveDependency();Promise.all(promises).then(function(){H.bindFormEvents();H.recalculateFormHeight()},H.handleDependencyErrors);document.addEventListener("scroll",function(T){$("#zc-fieldTooltipMsg").remove()},true);if(this.isNotPage&&this.hasSubforms&&!isMobileBrowser()){H.modifyStylesToContainer();var M=this.getView().getDOM().getFormDOM();this.appHeaderHeight=0;var S=this.getModel().getAccessType()==FormAccessType.VIEW_ADD_RECORD||this.getModel().getAccessType()==FormAccessType.VIEW_EDIT_RECORD;if((this.isFormFullScreen()&&!this.isEmbedorPerma()&&S)||(!this.withinPopup&&!R)){this.appHeaderHeight=this.appHeaderHeight||K()}if(H.isEmbedorPerma()&&!this.withinPopup){M=document}M.addEventListener("scroll",function(T){Q(L,H.appHeaderHeight,R,H.withinPopup,H.subFormElems)},true);function K(){switch(appMeta.APPTHEME){case 2:case 6:return document.querySelector(".zc-header .brand").offsetHeight+document.getElementById("zc_inner_nav_menu").offsetHeight;case 3:return 46+15;case 4:return document.getElementById("zc_inner_nav_menu").offsetHeight;case 5:return 52+15;case 7:case 9:return 50;case 8:return 49;default:return 0}}function Q(V,U,X,Z,W){var T=V.querySelector('[subformHeader="true"]');var Y=V.querySelector("#zc-subform-header-parent");W.forEach(function(c){if(c.querySelectorAll("[elname=dataRow]").length<=1&&c.querySelector('[rowno="t::row_0"]')){return }var b=0;if(c.parentElement.querySelector(".zc-help-txt")){b=c.parentElement.querySelector(".zc-help-txt").offsetHeight}if(T){var a=T.querySelector("[subformname="+c.getAttribute("name")+"]");if(a){if($(c).parent()[0].style.display!=="none"&&$(c).parent().offset().top+b<U&&($(c).parent().height()+$(c).parent().offset().top>U)){if(X&&!Z){$(a).offset({left:$(c).children(".subform-inner-wrapper:first").offset().left})}else{$(T).offset({left:$(c).children(".subform-inner-wrapper:first").offset().left})}if(-$(c).parent().height()+100>$(c).parent().offset().top+b){T.style.display="none";Y.style.top=null;document.body.classList.remove("zc-subform-header-fixed")}else{if($(c).parent().offset().top+b<U-55-30){T.style.display=null;Y.style.top="0px";a.style.display=null;$(a).siblings().hide();document.body.classList.add("zc-subform-header-fixed")}else{if($(c).parent().offset().top+b>U){T.style.display="none";Y.style.top=null;document.body.classList.remove("zc-subform-header-fixed")}else{if((X&&Z)||(!X&&$(c).parent().offset().top+b<U-30)){return }T.style.display="none";Y.style.top=null;document.body.classList.remove("zc-subform-header-fixed")}}}}else{a.style.display="none";if($(c).parent().offset().top+b>U&&$(c).parent().offset().top+b<U+36){document.body.classList.remove("zc-subform-header-fixed")}}}}})}}if(G.hasCaptcha()&&G.getFormAlign()==FormAlign.INPLACE){var N=this.getView().getDOM().getCaptchaLabel();$(N).addClass("adjustInplaceWidth");$(N).css({"max-width":"108px"});$(N).parent().css({"max-width":"108px"})}};this.recalculateFormHeight=function(){var K=H.container||H.getView().getDOM().getFormParentContainer().parentElement;if(H.withinPopup&&H.hasSubforms){if(!this.isEmbedorPerma()){H.recalculateSubformWidth(K,H.subFormElems)}H.setPopupDimensions(K)}};this.recalculateSubformWidth=function(K,L){L.forEach(function(M){var N=M.parentElement.offsetWidth;var O=M.querySelector(".subform-inner-wrapper").offsetWidth;if(O<K.offsetWidth){if(N<O){M.parentElement.style.width=O+"px"}}})};this.setPopupDimensions=function(L){var K=H.getView().getFormContainer().height()+120>(window.innerHeight*90/100);var M=H.getView().getFormContainer().width()>(window.innerWidth*90/100);if(K||M){if(K){$(L).trigger("subformFixedHeader",{percentValue:90,type:"h"})}if(M){$(L).trigger("subformFixedHeader",{percentValue:90,type:"w"})}}else{$(L).trigger("subformFixedHeader",{type:"h"});$(L).trigger("subformFixedHeader",{type:"w"})}};this.handleDependencyErrors=function(K){if(K.message=="geoFenced"){$(H.getView().getDOM().getFormDOM()).remove();$("#geo-fence").show();H.unlockForm()}else{if(K.message=="ZE"){Console.log("ZE init error")}}};this.resolveDependency=function(){promiseArray=[];if(G.isGeoLocationMandatory()){if(H.getModel().hasOnLoad()){LIB._stopLoading()}geoLocationPromise=new Promise(function(L,K){Geolocation.init({overlay:H.getView().getGeoOverlay(),headerMsg:i18n.geoheaderform,success:L})}).then(function(){if(G.isGeoFenceEnabled()&&!isInsideFence(G.getGeoFenceObj(),Geolocation.getLocationDataObj())){throw new Error("geoFenced")}});promiseArray.push(geoLocationPromise)}if(G.hasDependencyField()){rtePromise=new Promise(H.checkForDepedency);promiseArray.push(rtePromise)}return promiseArray};this.applyStyles=function(K){if(K.origin===ZCGlobal.appbuilderserverprefix){H.getView().applyStyles(K.data)}};this.checkForDepedency=function(L,K){try{ZE}catch(M){if(M instanceof ReferenceError){setTimeout(function(){return H.checkForDepedency(L,K)},1000);return }K(new Error("ZE"))}F=true;L()};this.bindFormEvents=function(){var L=true;if(G.getAccessType()==FormAccessType.VIEW_EDIT_RECORD&&G.showOnlyViewFields()){L=false}if((H.removeLoading()||!L)&&!G.isPaymentCallback()){H.unlockForm()}var K=H.registerFields();if(K){H.resetForm()}else{H.getView().bindSubmit(G.getFormType());if(G.isPaymentCallback()){H.paymentCallback()}if(L){H.bindWorkflow()}H.bindButtonAction();H.bindAutomation();H.bindPermissions();if(isMobileBrowser()){H.addImageFields();H.triggerImagePopup()}H.focusFirstField();H.getView().bindScrollEvents();H.resetCaptcha();H.getView().getResetCaptchIcon().on("click",function(){H.resetCaptcha()});if(G.getFormAlign()==FormAlign.INPLACE&&G.hasCaptcha()){this.getView().bindCaptchaFocus()}}};this.getFieldController=function(K){return this.fieldControllers[K]};this.getButtonController=function(K){return this.buttonControllers[K]};this.disableButton=function(K){H.getView().disableButton(K)};this.disableButtons=function(){var O=G.getButtons();for(var N=0,L=O.length;N<L;N++){var M=O[N];var K=M.BUTTONLABEL_NAME;this.disableButton(K)}};this.enableButton=function(K){H.getView().enableButton(K)};this.enableButtons=function(){var O=G.getButtons();for(var N=0,L=O.length;N<L;N++){var M=O[N];var K=M.BUTTONLABEL_NAME;this.enableButton(K)}};this.bindWorkflow=function(){A=new WorkflowController(this);A.execute()};this.paymentCallback=function(){var K=this;var L=false;var M={recLinkId:G.getRecordLinkIdFromMeta(),transactionId:G.getPmtTransactionId()};var O=function(){if(!LIB._isNull(G.getSuccessMsg())&&!L){$.successMsg(G.getSuccessMsg(),2000)}};var N=function(){if(LIB._isNull(G.getNextURL())){K.unlockForm()}else{K.nextUrlHandler()}};$.ajax({url:this.getURL().getPaymentPollURL(),method:"GET",data:M,success:function(Q){delete Controller.FormController.cache[G.getFormLinkName()+"_"+G.getRandStr()];Console.log(Q);Console.log("Payment process completed..");var P=Q.onCommitMsgs;if(!LIB._isNull(P)){if(!LIB._isNull(P.successMsg)){L=false;$.successMsg(P.successMsg,1000)}else{O()}if(!LIB._isNull(P.generatedJs)){evaluateJs(P.generatedJs,G.getAccessType())}else{N()}}else{O();N()}}})};this.bindAutomation=function(){var K=G.getRulesScript();if(K!=undefined){J=new AutomationController(this,K);J.execute()}};this.bindPermissions=function(){var K=this.getFormFields(),O=0,P=Object.keys(K),L=P.length;for(;O<L;++O){var N=K[P[O]],M=N.getModel();if(M.isReadOnly()){N.disableField()}if(!M.isVisible()){N.hideField()}}};this.getWorkflowController=function(){return A};this.getAutomationController=function(){return J};this.getFormAlignStyle=function(){return C.sheet};this.getFormStyle=function(){return D.sheet};this.resetCaptcha=function(){if(G.hasCaptcha()){this.getView().resetCaptcha(this.getURL().getCaptchaURL())}};this.showCaptchaError=function(K){if(G.hasCaptcha()){this.getView().showCaptchaError(K)}};this.clearCaptchaError=function(){this.getView().clearCaptchaError()};this.focusFirstField=function(){if(isMobileBrowser()&&G.getImageFieldWithOnLoadShow().length>0){return }var K=G.getFirstFieldName();if(!isNull(K)&&G.focusFirstField()){this.getFieldController(K).focus()}};this.addImageFields=function(){G.addImageFieldWithOnLoadShow();G.addImageFieldWithSubmitAfterScan()};this.triggerImagePopup=function(M){var L=G.getImageFieldWithOnLoadShow();var K=G.getImageFieldWithSubmitAfterScan();if(L.length>0){if(M!=undefined&&M.indexOf(G.getOpenedPopup())!=-1&&K.includes(G.getOpenedPopup())){G.removeImageFieldWithOnLoadShow(L[0]);return }else{this.getFieldController(L[0]).getView().imagePopup();G.removeImageFieldWithOnLoadShow(L[0])}}};this.triggerSubformImagePopup=function(M,N){var L=H.getSubfrmImgCntrlWithShowLoad();var K=H.getSubfrmImgCntrlWithSmtAftScn();if(L.length>0){if(N!=undefined&&N.indexOf(H.getOpenedPopup())!=-1&&K.includes(G.getOpenedPopup())){H.removeSubfrmImgCntrlWithShowLoad(M.getLabelName());return }else{M.getView().imagePopup();H.removeSubfrmImgCntrlWithShowLoad(M.getLabelName())}}};this.getSubfrmImgCntrlWithShowLoad=function(){return I};this.addSubfrmImgCntrlWithShowLoad=function(K){I=K};this.removeSubfrmImgCntrlWithShowLoad=function(K){if(I.length>0){for(i=0;i<I.length;i++){if(I[i].getLabelName()==K){I.splice(i,1);E=K;break}}}};this.getSubfrmImgCntrlWithSmtAftScn=function(){return B};this.addSubfrmImgCntrlWithSmtAftScn=function(K){B=K};this.removeSubfrmImgCntrlWithSmtAftScn=function(K){for(i=0;i<B.length;i++){if(B.length>0&&v[i].getLabelName()==K){B.splice(i,1);break}}};this.getOpenedPopup=function(){return E};this.subFormAddRow=function(){var M=G.getFormFields();for(var S=0,U=Object.keys(M),P=U.length;S<P;++S){var T=M[U[S]];var K=T.FIELDCOMPTYPE;if(K==FieldType.SUB_FORM_GRID){var R=new SubformModel(T,G);var Q=R.getDefaultRow(),N=R.getCurrRows();if(R.hasOnAddRow()&&N==0&&Q==0){var O=H.getWorkflowController();var L={fieldname:R.getActualLabelName(),rowseqid:"t::row_1"};O.trigger(O.WFTYPE.ONADD_ROW,L)}}}};this.addActiveUploads=function(){G.incrementActiveUploads()};this.removeActiveUploads=function(){G.decrementActiveUploads()};this.submitTimeout;this.submitForm=function(){if(!H.isSubmitted){H.isSubmitted=true;$(".zc-scroll-mask").hide();$("#active-DatePicker-Cont").empty();H.disableButtons();if((A!=undefined&&A.isActive())||G.getNoOfActiveUploads()!=0||G.getNoOfActiveAddressOps()!=0){LIB._startLoading();H.isSubmitted=false;H.waitForPendingTasks(H.submitForm);return }if(!H.validateData()){$.alert({msg:i18n.invalidentriesfound,desc:i18n.correctandsubmit,handleFocus:true});LIB._stopLoading();H.enableButtons();H.isSubmitted=false;return false}if(G.isGeoLocationMandatory()&&Geolocation.locationData==undefined){Geolocation.locationError=(Geolocation.locationError==undefined)?i18n.formgeolocationerror:Geolocation.locationError;$.alert({msg:Geolocation.locationError,desc:(Geolocation.locationError==i18n.formgeolocationerror)?i18n.formgeolocationdesc:i18n.geolocbrowsererror,handleFocus:false});H.enableButtons();H.isSubmitted=false;return false}H.getModel().setTriggeredControllerType("formController");$.ajax({beforeSend:function(){LIB._startLoading()},type:"POST",url:H.getURL().getSubmitURL(),data:H.collectData(undefined,Constants.REQUEST_TYPE.FORM_SUBMIT),success:function(L){LIB._stopLoading();var K=H.getMsgFromResponse(L);H.responseHandler(K);H.isSubmitted=false},error:function(M,K,L){LIB._stopLoading();H.isSubmitted=false;H.enableButtons()}})}};this.cancelSubmitForm=function(){clearTimeout(this.submitTimeout);this.enableButtons();H.isSubmitted=false};this.waitForPendingTasks=function(K){if((A!=undefined&&A.isActive())||G.getNoOfActiveUploads()!=0||G.getNoOfActiveAddressOps()!=0){this.submitTimeout=setTimeout(function(){H.waitForPendingTasks(K)},100)}else{LIB._stopLoading();K()}};this.validateData=function(O,V){var b=this.getFormFields();var n=[];var L=true;var c=true;for(var j=0,Z=Object.keys(b),e=Z.length;j<e;++j){if(c){if(O&&V.indexOf(Z[j])==-1){continue}if(this.fieldControllers[Z[j]].getModel().getComponentType()==FieldType.SUB_FORM_GRID){var o=this.fieldControllers[Z[j]].getModel().getAllFields();for(subfld_key in o){var Q=o[subfld_key].FIELDS;for(rowNo in Q){if(Q[rowNo].FIELDTYPE==FieldType.PHONE_NUMBER||Q[rowNo].FIELDTYPE==FieldType.EMAIL_ADDRESS){Q[rowNo].CONTROLLER.getField().trigger("blur");if(Q[rowNo].CONTROLLER.getView().hasError){c=false}}if(Q[rowNo].FIELDTYPE==FieldType.CURRENCY&&Q[rowNo].CONTROLLER.getModel().containsValidationError()){c=false}if(Q[rowNo].CONTROLLER.getModel().isMandatory()){var R=Q[rowNo].CONTROLLER.getValue();var m=Q[rowNo].CONTROLLER.getModel().getActualLabelName();var d=Q[rowNo].FIELDTYPE;var N=Q[rowNo].CONTROLLER.getModel().getDisplayName();var K="SF("+this.fieldControllers[Z[j]].getModel().getActualLabelName()+").FD("+subfld_key+").SV("+m+")";var T="";var a;var P=0;var S=false;var h={};if(d==FieldType.NAME||d==FieldType.ADDRESS){var X=JSON.parse(R);var M=Object.keys(X);var Y=false;for(var U=0;U<M.length;U++){if(M[U]!="status"){if(!X[M[U]]){var W=Q[rowNo].CONTROLLER.getModel().getCompositeFields()[M[U]];if(W!=undefined&&W.FIELDCLASSNAME.indexOf("ADDRESS_LINE_2")==-1){Y=true;T=W.FIELDDISPLAYNAME;a=W.FIELDTYPE;P++}}}}if(Y){if(d==FieldType.ADDRESS){if(P>1){h[K]='{"errType":1,"errMsg":"'+i18n.mandatoryMsg+'"}'}else{if(a==FieldType.INLINE_SINGLE_SELECT){h[K]='{"errType":1,"errMsg":"'+i18n.mandatorySelectMsg+'"}'}else{h[K]='{"errType":1,"errMsg":"'+i18n.mandatoryMsg+'"}'}}}else{if(P>1){h[K]=i18n.mandatoryMsg}else{h[K]=i18n.mandatoryMsg}}n.push(h);L=false}}else{if(R==""||((R=="[]")&&(FieldType.MULTI_SELECT))||((R=="zc_unchecked")&&(d==FieldType.DECISIONBOX))||((d==FieldType.URL)&&(R.indexOf("zcurl-"+m+'":""')!=-1))||((d==FieldType.IMAGE)&&(R.indexOf("zcsource-"+m+'":""')!=-1))||((R.indexOf(m+'":""')!=-1)&&((d==FieldType.AUDIO)||(d==FieldType.VIDEO)||(d==FieldType.FILE_UPLOAD)))){if(Q[rowNo].FIELDTYPE==FieldType.SINGLE_SELECT||Q[rowNo].FIELDTYPE==FieldType.INLINE_SINGLE_SELECT||Q[rowNo].FIELDTYPE==FieldType.SYSTEM_LOOKUP){h[K]=i18n.mandatorySelectMsg}else{if(Q[rowNo].FIELDTYPE==FieldType.MULTI_SELECT){h[K]=i18n.mandatoryMultiSelectMsg}else{if(Q[rowNo].FIELDTYPE==FieldType.IMAGE){h[K]=i18n.mandatoryImageMsg}else{if(Q[rowNo].FIELDTYPE==FieldType.DECISIONBOX){h[K]=i18n.mandatoryDecisionMsg}else{if(Q[rowNo].FIELDTYPE==FieldType.URL){h[K]=i18n.mandatoryUrlMsg}else{h[K]=i18n.mandatoryMsg}}}}}n.push(h);L=false}}}}}}if(this.fieldControllers[Z[j]].getModel().getComponentType()==FieldType.PHONE_NUMBER||this.fieldControllers[Z[j]].getModel().getComponentType()==FieldType.EMAIL_ADDRESS){this.fieldControllers[Z[j]].getField().trigger("blur");if(this.fieldControllers[Z[j]].getView().hasError){c=false}}if(this.fieldControllers[Z[j]].getModel().getComponentType()==FieldType.CURRENCY&&this.fieldControllers[Z[j]].getModel().containsValidationError()){c=false}}if(this.fieldControllers[Z[j]].getModel().isMandatory()){var R=this.fieldControllers[Z[j]].getValue();var d=this.fieldControllers[Z[j]].getModel().getComponentType();var N=this.fieldControllers[Z[j]].getModel().getDisplayName();var T="";var a;var P=0;var S=false;var m=this.fieldControllers[Z[j]].getModel().getActualLabelName();var h={};if(d==FieldType.NAME||d==FieldType.ADDRESS){var X=JSON.parse(R);var M=Object.keys(X);var Y=false;for(var U=0;U<M.length;U++){if(M[U]!="status"){if(!X[M[U]]){var W=this.fieldControllers[Z[j]].getModel().getCompositeFields()[M[U]];if(W!=undefined&&W.FIELDCLASSNAME.indexOf("ADDRESS_LINE_2")==-1){Y=true;T=W.FIELDDISPLAYNAME;a=W.FIELDTYPE;P++}}}}if(Y){if(d==FieldType.ADDRESS){if(P>1){h[m]='{"errType":1,"errMsg":"'+i18n.mandatoryMsg+'"}'}else{if(a==FieldType.INLINE_SINGLE_SELECT){h[m]='{"errType":1,"errMsg":"'+i18n.mandatorySelectMsg+'"}'}else{h[m]='{"errType":1,"errMsg":"'+i18n.mandatoryMsg+'"}'}}}else{if(P>1){h[m]=i18n.mandatoryMsg}else{h[m]=i18n.mandatoryMsg}}n.push(h);L=false}}else{if(R==""||((R=="[]")&&(FieldType.MULTI_SELECT))||((R=="zc_unchecked")&&(d==FieldType.DECISIONBOX))||((d==FieldType.URL)&&(R.indexOf("zcurl-"+m+'":""')!=-1))||((d==FieldType.IMAGE)&&(R.indexOf("zcsource-"+m+'":""')!=-1))||((R.indexOf(m+'":""')!=-1)&&((d==FieldType.AUDIO)||(d==FieldType.VIDEO)||(d==FieldType.FILE_UPLOAD)))){if(d==FieldType.DROPDOWN||d==FieldType.INLINE_PICK_LIST||d==FieldType.INLINE_RADIO||d==FieldType.SYSTEM_LOOKUP||d==FieldType.SINGLE_SELECT){h[m]=i18n.mandatorySelectMsg}else{if(d==FieldType.CHECK_BOXES||d==FieldType.LIST){h[m]=i18n.mandatoryMultiSelectMsg}else{if(d==FieldType.IMAGE){h[m]=i18n.mandatoryImageMsg}else{if(d==FieldType.DECISIONBOX){h[m]=i18n.mandatoryDecisionMsg}else{if(d==FieldType.URL){h[m]=i18n.mandatoryUrlMsg}else{h[m]=i18n.mandatoryMsg}}}}}n.push(h);L=false}}}}if(!L){H.errorhandler("",n)}return c&&L};this.addFormStyle=function(){return this.getView().addStyleToForm("formStyle",G.getFormStyle())};this.bindButtonAction=function(){var K=G.getButtons(),O=this.getView();for(var N=0,L=K.length;N<L;N++){var M=K[N];this.buttonControllers[M.BUTTONLABEL_NAME]=Controller.FormButtonController.create({model:M,formcontroller:this})}};this.resetForm=function(L){if(G.getAccessType()!=FormAccessType.VIEW_EDIT_RECORD){Controller.FormController.loadFromCacheOrfetchForm(G.getFormLinkName(),G.getRandStr(),G.getFromParams(),L)}if(!(G.isPerma()||G.isEmbed())){if(!isNull(getCookie("zc-walkthroughstep"))){var K=parseInt(getCookie("zc-walkthroughstep"));new WalkThrough().proceed(K)}}};this.lockForm=function(){this.getView().showOverlay()};this.unlockForm=function(){if(this.isPage&&this.container){this.container.querySelector("#form-overlay").style.display="none"}else{this.getView().hideOverlay()}H.getView().hidePreloader();LIB._stopLoading()};this.showProgress=function(){this.getView().showProgress()};this.hideProgress=function(){this.getView().hideProgress()};this.adjustFormAlign=function(){var e="",Q=this.getView(),R=0,M=30,a=Q.getFormContainerLeftRightPadding(),p="#"+G.getFormLinkName()+"_"+G.getRandStr();var c=Q.getContainerWidth();if(!isMobileBrowser()){var x=this.getModel().getAccessType()==FormAccessType.VIEW_ADD_RECORD||this.getModel().getAccessType()==FormAccessType.VIEW_EDIT_RECORD;var j=H.container||H.getView().getDOM().getFormParentContainer().parentElement;if(this.isEmbedorPerma()){j=j.parentElement}if((this.isFormFullScreen()&&x&&H.isNotPage)||(!H.withinPopup&&H.isNotPage)){var d=document.getElementById("zc-component");if(this.isEmbedorPerma()){H.scrollBarWidth=d.offsetWidth-Q.getDOM().getFormContainer().offsetWidth}else{H.scrollBarWidth=(d.offsetWidth-c);if($(d).css("paddingLeft")!="0px"){c-=30}if(appMeta.APPTHEME===2){c-=2}}if((this.isFormFullScreen()&&x)){var T=this.getView().getDOM().formOuterWrapper.offsetHeight+this.getView().getDOM().formOuterWrapper.previousElementSibling.offsetHeight+this.getView().getDOM().formOuterWrapper.nextElementSibling.offsetHeight;if(T<Q.getContainerHeight()){H.resetScrollWidth=true}}c+=H.scrollBarWidth}H.scrollBarWidth=0;if(H.withinPopup&&!(this.isFormFullScreen()&&x)){H.scrollBarWidth=j.offsetWidth-this.getView().getDOM().formOuterWrapper.offsetWidth;if(H.scrollBarWidth<0){H.scrollBarWidth=0}}}var X=".zcform_"+G.getFormLinkName()+" ";var w=$.isEmptyObject(G.getFormFields());var o=0;var V=1;var Y=0;var h=0;if(!G.isCustomFormLabelWidth()&&(G.getFormType()==2)){var O=$(".form-outer-wrapper").length-1;$(".form-outer-wrapper").eq(O).addClass("statelessFormWidth")}while(V<=G.getMaxCol()){if(V==G.getMaxCol()){M=0}var u=V==1?".first-column":(V==2?".second-column":".column-"+V);var P=b(G.getFieldsByColumnNo(V));var Z=Q.findCaptchaLabelWidth();P.LABEL=(V==1&&G.hasCaptcha()&&P.LABEL<Z)?Z:P.LABEL;P.INPUT=(V==1&&G.hasCaptcha()&&P.INPUT<Constants.CAPTCHA_MIN_WIDTH)?Constants.CAPTCHA_MIN_WIDTH:P.INPUT;var L=(G.isCustomFormLabelWidth())?G.getLabelWidth():P.LABEL;e+=X+u+" .form-label{width : "+L+((G.isCustomFormLabelWidth())?G.getLabelWidthUnit():"px")+";}\n";e+=X+u+" .form-field{width : "+P.INPUT+"px;}\n";if(G.getFormAlign()==FormAlign.LEFT||G.getFormAlign()==FormAlign.RIGHT){var m=L+P.INPUT+R+M;var N=y(G.getFieldsByColumnNo(V))+R+M;m=Math.max(m,N);m=Math.ceil(m);m=m<Constants.COLUMN_MINWIDTH?Constants.COLUMN_MINWIDTH:m;e+=X+".label-left "+u+", .label-right "+u+" {width : "+m+"px;}\n";o+=m;Y=Y+m}else{var U=Math.max(L,P.INPUT)+M;U=U<Constants.COLUMN_MINWIDTH?Constants.COLUMN_MINWIDTH:U;U=Math.ceil(U)+15;e+=X+".label-top "+u+", .label-inplace "+u+" {width : "+U+"px;}\n";o+=U;h=h+U}var K=W(P,N,R,M,u);e+=X+u+" .notes-field{width:"+K+"px}\n";V++}o+=a;e+=X+".decision-box-label {width:auto !important}\n";if(w&&!G.isPerma()){e+=X+"form[name='"+G.getFormLinkName()+"'].label-left {width : 100%;}\n"}else{var q=(window.location!=window.parent.location)?document.body.scrollWidth:screen.width;if((!G.isPerma()&&!G.isEmbed())||((G.isPerma()||G.isEmbed())&&o>q)){var n=(Y+a),S=(h+a);if(!isMobileBrowser()&&(H.scrollBarWidth||n>=c)){n+=H.scrollBarWidth+30}if(!isMobileBrowser()&&(H.scrollBarWidth||S>=c)){S+=H.scrollBarWidth+30}e+="form[name='"+G.getFormLinkName()+"'].label-left {width : "+Math.max(c,n)+"px;}\n";e+="form[name='"+G.getFormLinkName()+"'].label-top {width : "+Math.max(c,S)+"px;}\n";e+="form[name='"+G.getFormLinkName()+"'].label-right {width : "+Math.max(c,n)+"px;}\n";e+="form[name='"+G.getFormLinkName()+"'].label-inplace {width : "+Math.max(c,S)+"px;}\n"}if(G.isPerma()&&o>q){if($("body").hasClass("zc-form-perma")){$("body").removeClass("zc-form-perma");$("body").addClass("zc-form-embed")}}}return this.getView().addStyleToForm("alignmentStyle",e);function s(z){var AA=$(Q.getDOM().getFormDOM().querySelector('div[name="'+z+'"]'));if(AA!=null){return $(AA).parents('div[elname="formRow"]').children(".formColumn").not(".column-0").children().length==1}return false}function b(AG){var AI=0,AB=0,AD=0;maxPlainTextWidth=0;for(var AF=0,AK=Object.keys(AG),AE=AK.length;AF<AE;++AF){var AJ=AG[AK[AF]],z=AJ.FIELDCOMPTYPE,AC=AJ.ISSUBFORM,AH,AA;if(AJ.FIELDISHIDDEN||z==FieldType.SUB_FORM_GRID||z==FieldType.SECTION||z==FieldType.DECISIONBOX){continue}else{if(z==FieldType.PLAIN_TEXT){if(s(AJ.ACTUALLABEL)){$(Q.getDOM().getFormDOM().querySelector('div[name="'+AJ.ACTUALLABEL+'"]')).width("auto");continue}K=Q.plainTextWidth(AJ.FIELDCLASSNAME);K=(K<Constants.PLAINTEXT_MIN_WIDTH)?Constants.PLAINTEXT_MIN_WIDTH:K;if(K>maxPlainTextWidth){maxPlainTextWidth=K}}else{AH=Q.findFieldLabelWidth(AJ.FIELDCLASSNAME+"-label");AA=Q.findFieldInputWidthEveryColumn(AJ.FIELDCLASSNAME);if(z==FieldType.IMAGE&&AJ.IMAGETYPE==Constants.LINKANDLOCAL){AA=AA+30}}}if(AH>AI){AI=AH}if(AA>AB){AB=AA}}if((G.getFormAlign()==FormAlign.LEFT||G.getFormAlign()==FormAlign.RIGHT)&&(maxPlainTextWidth>AI+AB)){AB=maxPlainTextWidth-AI}else{if((G.getFormAlign()==FormAlign.TOP||G.getFormAlign()==FormAlign.INPLACE)&&(maxPlainTextWidth>AI&&maxPlainTextWidth>AB)){AB=maxPlainTextWidth}}return{LABEL:AI,INPUT:AB,}}function W(AB,AE,AG,AC,AF){var AA=(G.isCustomFormLabelWidth())?G.getLabelWidth():AB.LABEL;var z=null;if(AB.INPUT==0){z=Q.getFormContainer().find(AF).width()}else{z=AB.INPUT+AG+AC;if(G.getFormAlign()!=FormAlign.TOP&&G.getFormAlign()!=FormAlign.INPLACE){z+=AA}}var AD=Math.max(z,AE);return Math.ceil(AD)}function y(AE){var AD=0;for(var AB=0,AC=Object.keys(AE),z=AC.length;AB<z;++AB){var AA=AE[AC[AB]];if(AA.FIELDISHIDDEN||AA.FIELDCOMPTYPE!=FieldType.SUB_FORM_GRID||AA.FIELDWIDTH==undefined){continue}AD=Math.max(AD,AA.FIELDWIDTH)}return AD}};this.registerFields=function(){var M=G.getFormFields();var R=G.isPermaOrEmbed();var K=(window.performance!=undefined&&(window.performance.navigation.type==window.performance.navigation.TYPE_BACK_FORWARD));var N=G.hasOnLoad();var L=[];for(var P=0,S=Object.keys(M),O=S.length;P<O;++P){if(R&&K&&(G.getAccessType()==FormAccessType.ADD_RECORD)&&(N||M[S[P]].ONCHANGEEXIST)&&!ZCGlobal.stopResetClick){ZCGlobal.stopResetClick=true;return true}this.fieldControllers[S[P]]=Controller.FieldController.create({model:G.getFormFieldMeta(S[P]),formController:this,data:G.getFormFieldData(S[P])});if(G.getAccessType()!=FormAccessType.VIEW_EDIT_RECORD&&M[S[P]].FIELDCOMPTYPE==FieldType.SUB_FORM_GRID&&M[S[P]].ISFORMULAEXIST=="true"&&this.fieldControllers[S[P]].getModel().getCurrRows()){L.push(S[P])}}for(var P=0,Q=L.length;P<Q;P++){this.fieldControllers[L[P]].getField().trigger("change");break}return false};this.handlePopupPositionForMobile=function(){if((window.self!==window.top)&&isMobileBrowser()&&!ZCGlobal.isMobileLayout){var L=$(".popupbox-wrapper");$(L[L.length-1]).removeClass("zc-alert-popupissue").addClass("zc-alert-popupissue");var K=$(".zc-freezer.zc-freezer-layer");$(K[K.length-1]).removeClass("zc-alert-popupissue").addClass("zc-alert-popupissue")}};this.responseHandler=function(N){this.getView().hideFormErrorInfo();if(N.errMsg!=undefined&&N.errMsg.length>0){this.getView().showFormErrorInfo(N.errMsg);H.enableButtons()}var Q=N.fieldAlertMsg!=undefined?true:false;if(N.fieldErrObj!=undefined||Q){if(N.paidUserFieldError!=undefined){$.alert({msg:N.paidUserFieldError,handleFocus:false});this.getView().showFormErrorInfo(N.paidUserFieldError)}else{$.alert({msg:i18n.invalidentriesfound,desc:i18n.correctandsubmit,handleFocus:false,callback:function(){if(Q){H.errorhandler(null,N.fieldAlertMsg)}else{H.errorhandler(N.errMsg,N.fieldErrObj)}}})}H.handlePopupPositionForMobile();this.resetCaptcha();H.enableButtons();if(!Q){return }}if(N.succMsg!=undefined){if(N.paymentConfig!=undefined){$.successMsg(i18n.redirectopaypal,4000);this.lockForm();this.showProgress();this.proceedPayment(N.paymentConfig,N.recLinkID);return false}if(H.isNewPage){$(document).trigger("datachange",[H.getModel().getFormId(),$(this.container).closest("[eltype]")])}this.successHandler(N)}if(N.hostedPageUrl!=undefined){$.successMsg(i18n.redirectopaypal,4000);this.lockForm();this.showProgress();this.redirectToCheckout(N.hostedPageUrl,N.recLinkID);return false}if(N.PMT_ERROR!=undefined){$.alert({msg:N.PMT_ERROR})}if(N.alertMsg!=undefined&&N.alertMsg.length>0){for(alertsInd in N.alertMsg){var P=N.alertMsg[alertsInd];for(var M=0,K=P.length;M<K;M++){var O=P[M];O=O.replace(/\n/g,"<br>").replace(/\\r/g,"").replace(/#zc_amp#/g,"&");$.alert({msg:O});H.handlePopupPositionForMobile()}}}if(N.infoMsg!=undefined&&Object.keys(N.infoMsg).length>0){var L=(G.getAccessType()!=1)?true:((N.succMsg!=undefined)?false:true);if(L){this.infoMsgHandler(N.infoMsg)}}if(N.errorMsg!=undefined&&Object.keys(N.errorMsg).length>0){this.showError(N.errorMsg);return }if(N.isScriptCancelSubmit){if(!LIB._isNull(N.generatedjs)){evaluateJs(N.generatedjs,G.getAccessType())}if(!Q){if(N.alertMsg==undefined||N.alertMsg.length<=0){$.alert({msg:i18n.invalidentriesfound,desc:i18n.correctandsubmit,handleFocus:false,callback:function(){H.errorhandler(N.errMsg,N.fieldErrObj)}});H.handlePopupPositionForMobile()}this.resetCaptcha();H.enableButtons()}return }if(!N.isScriptCancelSubmit){this.nextUrlHandler(N)}};this.nextUrlHandler=function(P){var N=this;$(document).on("onAlertClose",function(){N.resetForm()});if(!LIB._isNull(P)&&!LIB._isNull(P.generatedjs)){var V=evaluateJs(P.generatedjs,G.getAccessType());if(V){return false}}if(!LIB._isNull(G.getNextURL())){var W=G.getNextURL();var Y=G.getURLType();if(Y=="ZC_NOT_TRUSTED_DOMAIN"){$.confirm({message:i18n["zc.live.form.secureurlconfirmation"],success:function(){LIB._openURL(W,G.openFormIn())},failure:function(){N.resetForm()},buttonConfirm:"Proceed",buttonCancel:"Cancel"})}else{if(Y=="ZC_INVALID_URL"){$.alert({msg:i18n["zc.live.form.invalidurlerror"],callback:function(){N.resetForm()}})}else{var V=(W!=null)?LIB._openURL(W,G.openFormIn()):false;if(V){return false}}}}function L(a,Z){if(Z==a){if($zcmodal.hasInstance()){$zcmodal.getTopPopup().close()}$(window).trigger("hashchange")}}if(!LIB._isNull(P)&&!LIB._isNull(P.nexturl_rule)){var U=P.nexturl_rule;if(U!=undefined&&U!=null&&!$.isEmptyObject(U)){var W=P.nexturl_rule.nexturl;W=ZCSecurity.isURLXSSVulnerable(W)?null:W;var R=U.openin;var T=U.type;T=(T=="form")?"Form":(T=="view")?"Report":(T=="html")?"Page":T;if(T!="url"||ZCSecurity.isValidURL(W)){if((G.isPerma()||G.isEmbed())&&T!="url"){return true}var K=U.component;if(R=="2"){if(T=="url"){ZSEC.secureRedirector.open(W,"_new")}else{var O=window.location.href.split("#")[0]+"#"+T+":"+K;window.open(O)}}else{if(R=="3"){var M=window.opener;var S=window;S=(M!=null)?M:window.parent;if(T=="url"){S.location.href=W}else{var Q=S.location.hash;var X="#"+T+":"+K;S.location.hash=X;L(Q,X)}}else{if(T=="url"){window.location=W}else{var Q=window.location.hash;var X="#"+T+":"+K;window.location.hash=X;L(Q,X)}}}return true}}}return true};this.proceedPayment=function(L,W){var S=false;var U=false;if(G.isPermaOrEmbed()&&!G.isPublic()){LIB._initGlobals()}if(L.isDemo){L[ZCGlobal.csrfTokenName]=ZCGlobal.csrfToken}if(G.isPerma()||H.isPagePerma){S=true}if(G.isEmbed()||H.isPageEmbed){U=true}var K=G.getPrivateLink();var N=this.getURL().getPaymentCallbackURL(L.environment,W,S,U);var Q=this.getURL().getNotificationUrl(L.environment,W,S,U);var O=N+"/cancel";var T=N+"/return";if(!LIB._isNull(K)){Q+="?privatelink="+K;O+="?privatelink="+K;T+="?privatelink="+K}var M=!LIB._isNull(K)?"&":"?";O+=M;T+=M;if(!LIB._isNull(G.getNextURL())){O+="zc_NextUrl="+G.getNextURL()+"&";T+="zc_NextUrl="+G.getNextURL()+"&"}else{if(H.isPage){var R=window.location.href;if(R.indexOf("#")!=-1){var P=encodeURIComponent(R.substring(R.indexOf("#")));O+="zc_NextUrl="+P+"&";T+="zc_NextUrl="+P+"&"}else{R=encodeURIComponent(R);O+="zc_NextUrl="+R+"&";T+="zc_NextUrl="+R+"&"}}}if(!LIB._isNull(G.openFormIn())){O+="zc_OpenUrlIn="+G.openFormIn()+"&";T+="zc_OpenUrlIn="+G.openFormIn()+"&"}if(!LIB._isNull(G.getSuccessMsg())){O+="zc_SuccMsg="+i18n.paypaypaymentcancel;T+="zc_SuccMsg="+G.getSuccessMsg()}else{O+="zc_SuccMsg="+i18n.paypaypaymentcancel}L.notify_url=Q;L.cancel_return=O;L["return"]=T;var V=document.createElement("form");V.setAttribute("method","post");V.setAttribute("action",(L.isDemo)?"/app/form/jsp/paypalTesting.jsp":L.paypalUrl);V.setAttribute("target","_top");delete L.paypalUrl;delete L.environment;$.each(L,function(Y,X){var Z=document.createElement("input");Z.setAttribute("type","hidden");Z.setAttribute("name",Y);Z.setAttribute("value",X);V.appendChild(Z)});$(V).appendTo("body").submit()};this.redirectToCheckout=function(K,L){window.open(K,"_self")};this.successHandler=function(P){if(!(G.isPerma()||G.isEmbed())){if(!isNull(getCookie("zc-walkthroughstep"))){var L=parseInt(getCookie("zc-walkthroughstep"));if(L===17||L===18||L===19){setCookie("zc-walkthroughstep",L+1,30,"","/");new WalkThrough().proceed(L)}}}var W=(!LIB._isNull(G.getSuccessMsg()))?G.getSuccessMsg():P.succMsg;var V=G.getNextURL();if(W!="zc_success"){if(G.getAccessType()!=FormAccessType.VIEW_EDIT_RECORD){$.successMsg(W,3000)}}if(!LIB._isNull(P.formrestriction)){this.resetForm()}else{function O(Y){if(Y.indexOf("openWindowTask")!=-1){var c="openWindowTask('";var X=Y.substring(Y.indexOf("openWindowTask(")+"openWindowTask('".length);openType=X.split(",")[1];openWindowType=openType.substring(1,openType.length-1).toLowerCase();openWindowType=M(openWindowType);X=X.substring(0,X.indexOf("'"));X=M(X);if(openWindowType=="popup window"){var Z=false;var a=H.getView().getDOM().isPopup();var b=a?(H.getView().getDOM().isFullScreenPopup()?true:false):false;if(b&&(getScriptCloseType(X)!=0)){return false}if(!b&&!a){Z=true}return(X!=""&&!Z)}return(X!=""&&(openWindowType=="same window"||openWindowType=="parent window"))}else{return false}}function M(X){return X.replace(/\\x([0-9a-f]{2})/ig,function(Y,Z){return String.fromCharCode(parseInt(Z,16))})}function N(a){var X=P.nexturl_rule;if(X!=undefined&&X!=null&&!$.isEmptyObject(X)){if((G.isPerma()||G.isEmbed())&&!LIB._isNull(X.component)){return false}var Y=P.nexturl_rule.nexturl;var Z=X.openin;return(Y!=""&&(Z=="SameWindow"||Z=="1"))}else{return false}}var S=function(X){if(LIB._isNull(X)){return true}switch(X.toLowerCase()){case"same window":case"same":case"this":case"this window":return true;default:return false}};var U=function(X){if(LIB._isNull(X)||X.toLowerCase().indexOf("?zc_loadin=")==-1){return""}X=X.toLowerCase();X=X.substring(X.indexOf("?zc_loadin=")+11);if(X.indexOf("&")!=-1){return X.substring(0,X.indexOf("&"))}return X};if(G.getAccessType()==FormAccessType.VIEW_EDIT_RECORD){var K=function(){if(!LIB._isNull(P.generatedjs)&&!O(P.generatedjs)){var X=H.getURL().getRecordSuccessURL(G.getViewLinkName());var Z=document.createElement("form");Z.method="POST";Z.action=X;var a=document.createElement("input");a.name="successMsg";a.type="hidden";a.value=W;if(G.getPrivateLink()!=undefined){var Y=document.createElement("input");Y.name="privateLink";Y.type="hidden";Y.value=G.getPrivateLink();Z.appendChild(Y)}Z.appendChild(a);document.body.appendChild(Z);Z.submit()}};var T=function(){var X=P.nexturl_rule;if(X!=undefined&&X!=null&&!$.isEmptyObject(X)){if((G.isPerma()||G.isEmbed())&&!LIB._isNull(X.component)){return false}return true}return false};var R=function(){if(!LIB._isNull(P.generatedjs)&&(P.generatedjs.indexOf("openWindowTask(")!=-1)&&!G.isPerma()&&!G.isEmbed()){return true}return false};if(!LIB._isNull(V)){var Q=G.openFormIn();if(!LIB._isNull(Q)&&!S(Q)){K()}}else{if(R()||T()){return true}else{K()}}}else{if((!LIB._isNull(P.generatedjs)&&!O(P.generatedjs))&&(!LIB._isNull(P.nexturl_rule)&&!N(P.nexturl_rule))){if(LIB._isNull(G.getNextURL())||!S(U(G.getNextURL()))){this.resetForm(P.infoMsg)}}}}};this.errorhandler=function(Q,W){var V=0,P={SF:"SUBFROM",FD:"ROW",SV:"FIELD",MV:"FIELD"},R=this;for(var L in W){var M=W[L];for(var N in M){if(N=="zc_captcha_txt"){R.showCaptchaError(M[N]);continue}var O=M[N],U={};if(N.indexOf("(")!=-1){S(N,U,0);N=U.SUBFROM}var T=R.getFieldController(N);if(T!=undefined){T.showError(O,U.ROW,U.FIELD);if(V==0){T.focus(U.ROW,U.FIELD)}}}V++}if(!(G.isPerma()||G.isEmbed())){if(!isNull(getCookie("zc-walkthroughstep"))){var K=parseInt(getCookie("zc-walkthroughstep"));setCookie("zc-walkthroughstep",(K),30,"","/");new WalkThrough().proceed(K)}}function S(Z,d,c){var Y=Z.indexOf("(",c),b=Z.indexOf(")",Y),X=Z.length;if(b!=X-1){S(Z,d,b)}var a=P[Z.substr((Y-2),2)];d[a]=Z.substring(Y+1,b)}};this.infoMsgHandler=function(K){this.getView().showFormInfo(K)};this.showInfo=function(K){$.zcmodal({type:ZCModalConstants.JIT_MODAL,width:450,beforeShow:function(M){for(var N in K){var O=K[N];for(var L in O.UserMsgs){$(M).find("#info-"+N+""+L).text(O.UserMsgs[L])}}},buildDOM:function(){var L="";for(var N in K){var O=K[N];L+="<h3>"+O.HeaderMsg+"</h3>";for(var M in O.UserMsgs){L+="<span id='info-"+N+""+M+"'></span></br>";while(O.UserMsgs[M].indexOf("#zc_amp#")!=-1){O.UserMsgs[M]=O.UserMsgs[M].replace("#zc_amp#","&")}}}return'<div class="infoMsg" style="white-space:pre-line">'+L+"</div>"},buttons:[]})};this.showError=function(K){$.zcmodal({type:ZCModalConstants.JIT_MODAL,width:450,buildDOM:function(){var M="";var L="Error";M+="<h3>"+L+"</h3><p>"+K+"</p><br/>";return'<div class="infoMsg">'+M+"</div>"},buttons:[]})};this.getMsgFromResponse=function(O){var M={},P=G.getFormId();if(typeof (O)=="object"){for(var L in O){var Q=O[L];if(typeof (Q)=="object"){for(var N in Q){var K=Q[N];if(N==("success"+P)){M.succMsg=K}else{if(N==("errors"+P)&&typeof (K)=="object"){M.fieldErrObj=K}else{if(N==("errors"+P)){M.errors=K}else{if(N==("errorList"+P)&&typeof (K)=="object"){M.errorList=K}else{if(N==("successList"+P)&&typeof (K)=="object"){M.successList=K}else{if(N==("successes"+P)){M.fieldSuccObj=K}else{if(N==("recordDetails"+P)){M.recordDetails=K}else{if(N==("msg"+P)){M.errMsg=K}else{if(N==("info"+P)){M.infoMsg=K}else{if(N==("alert"+P)){M.alertMsg=K}else{if(N==("fieldAlert"+P)){M.fieldAlertMsg=K}else{if(N==("successMsgDuration"+P)){M.successMsgDuration=K}else{if(N==("captcha"+P)){M.captchaTxt=K}else{if(N==("generatedjs"+P)){M.generatedjs=K}else{if(N==("errorMsg"+P)){M.errorMsg=K}else{if(N==("status"+P)){M.statusMsg=K}else{if(N==("dummyForm")){M.dummyForm=K}else{if(N==("execType")){M.execType=K}else{if(N==("successmsg")){M.successmsg=K}else{if(N==("lookupFieldValue"+P)){M.lookupFieldValue=K}else{if(N==("childFormAccessType"+P)){M.childFormAccessType=K}else{if(N==("childFieldLabelName"+P)){M.childFieldLabelName=K}else{if(N==("childFormLinkName"+P)){M.childFormLinkName=K}else{if(N==("isFromSubForm"+P)){M.isFromSubForm=K}else{if(N==("compType"+P)){M.compType=K}else{if(N==("childSubformField"+P)){M.childSubformField=K}else{if(N==("rowNo"+P)){M.rowNo=K}else{if(N==("recLinkID"+P)){M.recLinkID=K}else{if(N==("paymentConfigId"+P)){M.paymentConfigId=K}else{if(N==("paymentConfig"+P)){M.paymentConfig=K}else{if(N==("hostedPageUrl")+P){M.hostedPageUrl=K}else{if(N==("PMT_ERROR")+P){M.PMT_ERROR=K}else{if(N==("combinedValue"+P)){M.combinedValue=K}else{if(N==("paidUserFieldError"+P)){M.paidUserFieldError=K}else{if(N===("nexturl_rule"+P)){M.nexturl_rule=K}else{if(N===("formrestriction"+P)){M.formrestriction=K}else{if(N==("showHtmlOnly")){M.showHtmlOnly=K}else{if(N==("scriptCancelSubmit"+P)){M.isScriptCancelSubmit=K}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}return M};this.applyDataChanges=function(K){if(G.getAccessType()==FormAccessType.VIEW_EDIT_RECORD){K.viewLinkName=G.getViewLinkName();K.pkValue=G.getPKValue()}return K};this.collectFieldData=function(M,R){var Q={},P=this.getFormFields();for(var O=0,T=Object.keys(P),N=T.length;O<N;++O){var K=P[T[O]].getModel().getZiaType()!=undefined?true:false;if((R!=Constants.REQUEST_TYPE.FORMULA&&P[T[O]].getModel().getComponentType()==FieldType.SCRIPT)){continue}var S=P[T[O]].getModel();var L=S.getComponentType();if(!K&&(L==FieldType.DROPDOWN||L==FieldType.INLINE_PICK_LIST||L==FieldType.POPUP_SINGLE||L==FieldType.SYSTEM_LOOKUP||L==FieldType.EXTERNAL_FIELD)&&this.getModel().getTriggeredControllerType()=="formController"){if(P[T[O]].getValue()==""){Q[S.getActualLabelName()]="-Select-"}else{P[T[O]].fillValue(Q,R)}}else{P[T[O]].fillValue(Q,R)}if(!M){P[T[O]].clearError()}}return Q};this.collectData=function(M,K){var L=this.collectFieldData(M,K);if(!M&&G.hasCaptcha()){this.clearCaptchaError();L.zc_captcha=this.getView().getCaptchaVal();L.cdigest=this.getView().getCaptchaDigest()}if(!M&&G.isGeoLocationMandatory()&&Geolocation.locationData!=undefined){L.geolocation=Geolocation.locationData}L.formid=G.getFormId();L[ZCGlobal.csrfTokenName]=ZCGlobal.csrfToken;L.recType=G.getAccessType();if(!isNull(G.getPrivateLink())){if(G.getAccessType()==FormAccessType.BULK_EDIT){L.privateLink=G.getPrivateLink()}L.privatelink=G.getPrivateLink();if(G.getAccessType()==FormAccessType.VIEW_ADD_RECORD||G.getAccessType()==FormAccessType.VIEW_EDIT_RECORD||G.getAccessType()==FormAccessType.BULK_EDIT){L.viewPrivateLink=G.getPrivateLink()}if(G.getAccessType()==FormAccessType.LOOKUP_ADD){L.childFormPrivateLink=G.getPrivateLink()}}return this.applyDataChanges(L)};this.triggerOnUserInput=function(){};this.childRelations=[];this.getChildRelation=function(){var L={zc_lookupCount:1,zc_childappname_1:G.getActualAppLinkName(),zc_childformname_1:G.getFormLinkName(),childFormAccessType:G.getAccessType(),childFormLinkName:G.getFormLinkName(),childAppLinkName:G.getActualAppLinkName(),baseAccessType:1};for(var K in this.childRelations){L=$.extend(L,this.childRelations[K])}return L};this.addChildRelation=function(K){this.childRelations.push(K)};this.getFormFields=function(){return this.fieldControllers};this.getFormButtons=function(){return this.buttonControllers};this.closeForm=function(){if($zcmodal.getTopPopup()!=undefined){$zcmodal.getTopPopup().close()}};this.removeLoading=function(){if(G.getAccessType()==FormAccessType.VIEW_EDIT_RECORD&&G.showOnlyViewFields()){return true}else{if(G.hasDependencyField()&&!H.getModel().hasOnLoad()){return F}}return !H.getModel().hasOnLoad()};this.addPendingTask=function(K){H.getModel().addPendingTask(K)};this.removePendingTask=function(K){H.getModel().removePendingTask(K)};this.getPendingTaskFields=function(){return H.getModel().getPendingTaskFields()};this.resizeInPage=function(){if(H.isNewPage){$(document).trigger("resizeform",[$("#"+H.getModel().getFormLinkName()+"_"+H.getModel().getRandStr()),H.getModel().getAccessType()])}}});FormController.prototype=Object.create(ControllerFactory.prototype);FormController.prototype.constructor=FormController;var PreviewFormController=(function(B,C){FormController.call(this,B);var A=this;this.bindEvents=function(){formStyle=this.addFormStyle();alignStyle=this.adjustFormAlign();this.registerFields();this.unlockForm();if(window.self!==window.top){window.addEventListener("message",A.applyStyles);parent.postMessage("zc-formpublishpreview",ZCGlobal.appbuilderserverprefix)}};this.removeLoading=function(){return true};$(document).on("contextmenu",function(D){return false})});PreviewFormController.prototype=Object.create(FormController.prototype);PreviewFormController.prototype.constructor=PreviewFormController;var ReportFormController=(function(B,C){FormController.call(this,B);var A=this;this.bindCloseBtn=function(){var D=A.getView().getDOM().getFormParentContainer().parentElement;var E=A.getView().getDOM().getFormDOM().querySelector("#formCloseBtn");E.style.display=null;$(E).off("click").on("click",function(F){if(A.isFormFullScreen){document.getElementById("zc-component").classList.remove("zc-form-container","zc-form-edit-container")}$(D).trigger("formPopupCloseBtn")})};this.isFormFullScreen=function(){var D=A.getView().getDOM().getFormParentContainer().parentElement;return $(D).parents(".zcpopup").length==1};this.modifyStylesToContainer=function(){document.getElementById("zc-component").classList.add("zc-form-container","zc-form-edit-container")};this.recalculateFormHeight=function(){var D=A.getView().getDOM().getFormParentContainer().parentElement;$(D).trigger("popupEditSubformClass");if(A.hasSubforms){if($(D).parents(".zcpopup").length>1){A.recalculateSubformWidth(D,A.subFormElems);A.setPopupDimensions(D)}else{if($(D).parents(".zcpopup:first")[0].classList.contains("fullscreen")){$(D).trigger("popupSubformClass")}else{A.setPopupDimensions(D)}}}};this.successHandler=function(D){if(D.succMsg!="zc_success"){$.successMsg(D.succMsg,3000)}if(ZCGlobal.isMobileLayout&&$zcmodal.hasInstance()){setTimeout(function(){$(".zc-mobile-back-button").show()})}C.showReport("","","","",undefined,true)};this.applyDataChanges=function(E){var D;var F=C.getModel();if(F.isSavedReport()){D=F.getParentReportLinkName()}else{D=F.getReportLinkName()}E.viewLinkName=D;E.pkValue=B.getPKValue();return E};this.infoMsgHandler=function(D){this.showInfo(D)}});ReportFormController.prototype=Object.create(FormController.prototype);ReportFormController.prototype.constructor=ReportFormController;var ReportAddFormController=(function(B,C){FormController.call(this,B);var A=this;this.bindCloseBtn=function(){var D=A.getView().getDOM().getFormParentContainer().parentElement;var E=A.getView().getDOM().getFormDOM().querySelector("#formCloseBtn");E.style.display=null;$(E).off("click").on("click",function(F){if(A.isFormFullScreen){document.getElementById("zc-component").classList.remove("zc-form-container","zc-form-edit-container")}$(D).trigger("formPopupCloseBtn")})};this.modifyStylesToContainer=function(){document.getElementById("zc-component").classList.add("zc-form-container","zc-form-edit-container")};this.isFormFullScreen=function(){var D=A.getView().getDOM().getFormParentContainer().parentElement;return $(D).parents(".zcpopup").length==1};this.recalculateFormHeight=function(){var D=A.getView().getDOM().getFormParentContainer().parentElement;$(D).trigger("popupEditSubformClass");$(D).trigger("popupAddRecordClass");if(A.hasSubforms){if($(D).parents(".zcpopup").length>1){A.recalculateSubformWidth(D,A.subFormElems);A.setPopupDimensions(D)}else{if($(D).parents(".zcpopup:first")[0].classList.contains("fullscreen")){$(D).trigger("popupSubformClass")}else{A.setPopupDimensions(D)}}}};this.successHandler=function(D){if(D.succMsg!="zc_success"){$.successMsg(D.succMsg,3000)}this.closeForm();C.showRelatedListRecord()};this.infoMsgHandler=function(D){this.showInfo(D)}});ReportAddFormController.prototype=Object.create(FormController.prototype);ReportAddFormController.prototype.constructor=ReportAddFormController;var BulkEditFormController=(function(B,C){FormController.call(this,B);var A=this;A.isSubmitted=false;this.bindEvents=function(){formStyle=this.addFormStyle();alignStyle=this.adjustFormAlign();this.registerFields();this.getView().bindSubmit(B.getFormType());this.unlockForm()};this.registerFields=function(){var J=B.getFormFields(),E=[];var I=B.getSortedKeys();for(var G=0,D=I.length;G<D;++G){var F=Controller.FieldController.create({model:B.getFormFieldMeta(I[G]),formController:this,data:B.getFormFieldData(I[G])});var H={};H.text=J[I[G]].FIELDDISPLAYNAME;H.id=I[G];E.push(H);F.hideField();this.fieldControllers[I[G]]=F}this.getView().bindBulkEditInput(E)};this.submitForm=function(E){if(!A.isSubmitted){A.isSubmitted=true;var D=C.getSelectedRecords().length,F=A.getView().getBulkEditSelFields().length;$(".zc-scroll-mask").hide();$("#active-DatePicker-Cont").empty();A.disableButtons();if(D==0){A.isSubmitted=false;A.enableButtons();$.alert({msg:i18n.norecordselect,desc:i18n.updatenorecord});return false}if(F==0){A.isSubmitted=false;A.enableButtons();$.alert({msg:i18n.nofieldselect,desc:i18n.updatenofield});return false}if(B.isGeoLocationMandatory()&&Geolocation.locationData==undefined){Geolocation.locationError=(Geolocation.locationError==undefined)?i18n.formgeolocationerror:Geolocation.locationError;A.isSubmitted=false;A.enableButtons();$.alert({msg:Geolocation.locationError,desc:(Geolocation.locationError==i18n.formgeolocationerror)?i18n.formgeolocationdesc:i18n.geolocbrowsererror,handleFocus:false});return false}if(!A.validateData(true,A.getView().getBulkEditSelFields())){$.alert({msg:i18n.invalidentriesfound,desc:i18n.correctandsubmit,handleFocus:false});A.isSubmitted=false;A.enableButtons();return false}A.getModel().setTriggeredControllerType("formController");var G=C.getModel();if(E){$.ajax({beforeSend:function(){LIB._startLoading()},type:"POST",url:A.getURL().getSubmitURL(),data:A.collectData(undefined,Constants.REQUEST_TYPE.FORM_SUBMIT),success:function(I){LIB._stopLoading();A.isSubmitted=false;var H=A.getMsgFromResponse(I);A.responseHandler(H)}})}else{$.confirm({message:((D>1)?(G.getCustomMessagesMap().updaterecords).replace(new RegExp("&#x7b;0&#x7d;","g"),D):G.getCustomMessagesMap().updaterecord),success:function(){if(B.getNoOfActiveAddressOps()!=0||B.getNoOfActiveUploads()!=0){A.isSubmitted=false;A.waitForPendingTasks();return }$.ajax({beforeSend:function(){LIB._startLoading()},type:"POST",url:A.getURL().getSubmitURL(),data:A.collectData(undefined,Constants.REQUEST_TYPE.FORM_SUBMIT),success:function(I){LIB._stopLoading();A.isSubmitted=false;var H=A.getMsgFromResponse(I);A.responseHandler(H)}})},failure:function(){A.enableButtons();A.isSubmitted=false}})}}};this.waitForPendingTasks=function(){if(B.getNoOfActiveAddressOps()!=0||B.getNoOfActiveUploads()!=0){A.submitTimeout=setTimeout(function(){A.waitForPendingTasks()},100);return }else{A.submitForm(true)}};this.collectFieldData=function(J,F){var G={},D=this.getView().getBulkEditSelFields();for(var I=0,E=D.length;I<E;I++){var H=this.getFieldController(D[I]);H.fillValue(G,F);H.clearError()}return G};this.applyDataChanges=function(E){var F=C.getModel();var D=F.getReportLinkName();if(F.isSavedReport()){D=F.getParentReportLinkName()}E.viewLinkName=D;E.SelLabel=JSON.stringify(this.getView().getBulkEditSelFields());E.updateIdList=JSON.stringify(C.getSelectedRecords());return E};this.showhideField=function(E,D){if(D){this.getFieldController(E).showField()}else{this.getFieldController(E).hideField()}};this.successHandler=function(D){if(D.succMsg!="zc_success"){$.successMsg(D.succMsg,3000)}if($zcmodal.hasInstance()){$zcmodal.getTopPopup().close()}C.showReport()};this.nextUrlHandler=function(){return true};this.infoMsgHandler=function(D){this.showInfo(D)}});BulkEditFormController.prototype=Object.create(FormController.prototype);BulkEditFormController.prototype.constructor=BulkEditFormController;var LookupFormController=(function(B,C){FormController.call(this,B);var A=this;this.getChildRelation=function(){var D=C.getChildRelation(),E=D.zc_lookupCount+1;D.zc_lookupCount=E;D["zc_childappname_"+E]=B.getAppLinkName();D["zc_childformname_"+E]=B.getFormLinkName();D.childFormAccessType=B.getAccessType();D.childFormLinkName=B.getFormLinkName();D.childAppLinkName=B.getAppLinkName();return D};this.successHandler=function(I){var D={id:I.lookupFieldValue,text:I.combinedValue};var P=C.getModel();C.addValue(D);if(P.getComponentType()==FieldType.LIST||P.getComponentType()==FieldType.CHECK_BOXES){var R=C.getSelectedChoice();R.push(D);C.setFieldValue(R)}else{C.setFieldValue(D)}if(P.isSubformField()){var N=P.getFormModel();var Q=N.getAvailableRows();for(var M=0;M<Q.length;M++){var S=Q[M];var O=N.getRow(S).FIELDS;var H=-1;if(H!=-1){var L=O[H].CONTROLLER.getModel();var F=[{isSelected:false,id:I.lookupFieldValue,text:I.combinedValue}];var G={isSaturated:L.isSaturated(""),data:F,count:1};L.addChoices("",L.getCurrentPage(),G,true)}else{for(var K=0;K<O.length;K++){var L=O[K].CONTROLLER.getModel();if(L.getActualLabelName()==I.childFieldLabelName&&P!=L){H=K;var F=[{isSelected:false,id:I.lookupFieldValue,text:I.combinedValue}];var G={isSaturated:L.isSaturated(""),data:F,count:1};L.addChoices("",L.getCurrentPage(),G,true)}}}}}closeDialog();var E=P.getFormModel();var J=A.getModel().getFormLinkName()};this.nextUrlHandler=function(){return true};this.infoMsgHandler=function(D){};this.applyDataChanges=function(F){F.recType=5;var D=C.getChildRelation();for(var E in D){if(D.hasOwnProperty(E)){F[E]=D[E]}}return F}});LookupFormController.prototype=Object.create(FormController.prototype);LookupFormController.prototype.constructor=LookupFormController;var FormButtonController=(function(D,F){ControllerFactory.call(this,D,ObjectType.FORMBUTTON);AutomationOperation.call(this);var E={62:{TYPE:"SUBMIT",ACTION:1},63:{TYPE:"RESET",ACTION:2},64:{TYPE:"CANCEL",ACTION:2},61:{TYPE:"BUTTON",ACTION:1}};var A=F.getModel().getAccessType(),B=F.getModel().getFormType(),C=F.getWorkflowController();this.bindEvents=function(){if(E[D.getButtonID()].ACTION==1){this.bindPrimaryAction()}else{this.bindSecondaryAction()}return this};this.resetToCancel=function(){$(this.getButton()).val(i18n.cancel);$(this.getButton()).off("click").on("click",function(){F.closeForm()})};this.getButton=function(){return F.getView().getButton(D.getButtonName())};this.getLabelName=function(){return D.getButtonName()};this.isVisible=function(){return this.visibility};this.isAccessible=function(){return this.accessibility};this.hideField=function(){$(this.getButton()).hide()};this.showField=function(){$(this.getButton()).show()};this.enableField=function(){this.enableButton()};this.disableField=function(){this.disableButton()};this.disableButton=function(G){F.getView().disableButton(D.getButtonName())};this.enableButton=function(G){F.getView().enableButton(D.getButtonName())};this.bindPrimaryAction=function(){if(B==2&&D.getButtonEvent()==51){var G={buttonname:D.getButtonName()};this.getButton().on("click",function(I){var H=F.getPendingTaskFields();if(H.length){$(this).attr("autosubmit",true);return }C.trigger(C.WFTYPE.BUTTON_CLICK,G);I.preventDefault()})}};this.bindSecondaryAction=function(){$(this.getButton()).on("click",function(G){if(A==1){F.resetForm()}else{F.closeForm()}G.preventDefault()})};this.visibility=$(this.getButton()).is(":visible");this.accessibility=!$(this.getButton()).is(":disabled")});FormButtonController.prototype=Object.create(ControllerFactory.prototype);FormButtonController.prototype.constructor=FormButtonController;var FieldController=(function(B,D){var C=D;ControllerFactory.call(this,B,ObjectType.FIELD,D);AutomationOperation.call(this);this.recordsLimit=100000;this.init=function(){var F=B.getDefaultValue();if(F!==""){this.getView().setValue(F)}if(B.getComponentType()===FieldType.PLAIN_TEXT){F=B.getPlainTextVal();var E=(F.replace(new RegExp(ZCGlobal.creatorappDomainConfig.oldDomain,"g"),ZCGlobal.creatorappDomainConfig.newDomain).replace(new RegExp(ZCGlobal.creatorappDomainConfig.oldPublicDomain,"g"),ZCGlobal.creatorappDomainConfig.newPublicDomain));if(F!==E){this.getView().setValue(E)}}if((B.getComponentType()===FieldType.SINGLE_LINE)&&(!B.isCompositeSubField())){this.getView().getDOM().getFieldDOM().autocomplete="off"}};this.positionDropDown=function(I,E){if(ZCGlobal.appDirectionMeta.isRTL){var G=$(I);var H=$(E);var F=G.width()-H.width();if(H.offset().left==G.offset().left){G.css("left",G.offset().left-F)}}};this.bindEvents=function(){this.getView().fieldEvents();this.getView().bindChange();var F=B.getComponentType();if(B.isZiaInput()){this.getView().bindZia()}if(B.isFormulaExist()&&F!=FieldType.IMAGE&&F!=FieldType.FILE_UPLOAD&&F!=FieldType.VIDEO&&F!=FieldType.AUDIO){this.getView().bindFormula()}if(this.getView().isFloatLabelAlignment()){this.getView().bindFocus()}var G=B.getDescType();if(B.getTitle()!=undefined&&!isNull(B.getTitle().trim())&&G!=0){function E(H){if(!ZCGlobal.isMobileLayout&&!isMobileBrowser()){if(H==1||(H==2&&B.isSubformField())){return"tooltip"}else{if(H==2){return"helptext"}}}else{if(!B.isSubformField()){return"helptext"}}return"none"}switch(E(G)){case"tooltip":this.getView().bindFieldDescription();break;case"helptext":this.getView().bindFieldHelpText();break;case"none":break}}if(this.getView().isFloatLabelAlignment()&&(F!=FieldType.CHECK_BOXES||(F==FieldType.CHECK_BOXES&&B.isLookup()))&&this.isFieldSupportedInInplace(F)){if(B.getDefaultValue()!=""&&B.getDefaultValue()!=undefined&&F!=FieldType.PHONE_NUMBER){this.getView().adjustLabelWidth(F,true)}else{this.getView().adjustLabelWidth(F,false)}}return this};this.getFormController=function(){return C};this.fillValue=function(F,E){F[B.getActualLabelName()]=this.getValue(E)};this.getValue=function(){return this.getView().getValue()};this.showError=function(E){if(B.getDescType()==2&&!B.isSubformField()){this.getView().hideHelpText()}this.getView().showError(E)};this.clearError=function(){if(B.getDescType()==2&&!B.isSubformField()){this.getView().showHelpText()}this.getView().clearError()};this.focus=function(){this.getView().focus()};this.validate=function(){try{this.specificValidator.validate(this)}catch(E){if(E.name!="MandatoryException"){this.showError(E.message)}}};this.getLabelName=function(){return B.getLabelName()};this.getEmptyRowKey=function(){return".t::row_0."};this.destroy=function(){this.getView().destroy()};this.showLoader=function(){this.getView().showLoader()};this.hideLoader=function(){this.getView().hideLoader()};this.showInPage=function(){this.getView().showInPage()};this.hideInPage=function(){this.getView().hideInPage()};this.getChildRelation=function(){var E=D.getChildRelation();E["zc_childlabelname_"+E.zc_lookupCount]=B.getActualLabelName();E.isFromSubForm=B.isSubformField();E.childFieldLabelName=B.getActualLabelName();if(E.isFromSubForm==false){E.isNewTypeSubform=false}return E};this.hideFieldinSubform=function(){var E=this.getFormController().getFormController().getView().getDOM().getFormParentContainer().parentElement;if(this.getFormController().getFormController().getModel().isPermaOrEmbed()){E=E.parentElement}var F=E.querySelector('[subformname="'+this.getFormController().getModel().getLabelName()+'"]');if(F){F.querySelector('[val="'+B.getActualLabelName()+'"]').style.display="none"}};this.hideSubform=function(){var E=this.getFormController().getView().getDOM().getFormParentContainer().parentElement;if(this.getFormController().getModel().isPermaOrEmbed()){E=E.parentElement}var F=E.querySelector('[subformname="'+this.getModel().getLabelName()+'"]');if(F){F.style.display="none"}};this.hideField=function(){if(this.getValue()==""){this.clearError()}this.getView().hideField(B.getClassName());if(B.isSubformField()){this.hideFieldinSubform()}if(B.getComponentType()===FieldType.SUB_FORM_GRID){this.hideSubform()}B.setVisible(false);if(!B.isSubformField()){D.resizeInPage()}this.triggerFormHeightCalculation()};this.showFieldinSubform=function(){var E=this.getFormController().getFormController().getView().getDOM().getFormParentContainer().parentElement;if(this.getFormController().getFormController().getModel().isPermaOrEmbed()){E=E.parentElement}var F=E.querySelector('[subformname="'+this.getFormController().getModel().getLabelName()+'"]');if(F){F.querySelector('[val="'+B.getActualLabelName()+'"]').style.display=null}};this.showField=function(){this.getView().showField(B.getClassName());if(B.isSubformField()){this.showFieldinSubform()}B.setVisible(true);if(!B.isSubformField()){D.resizeInPage()}this.triggerFormHeightCalculation()};this.isVisible=function(E){return B.isVisible(E)};this.disableField=function(){if(ZCGlobal.isMobileLayout){this.getView().getDOM().getFieldParentGroup().addClass("zc-fld-disabled")}this.getView().disableField();B.setReadOnly(true)};this.enableField=function(){if(ZCGlobal.isMobileLayout){this.getView().getDOM().getFieldParentGroup().removeClass("zc-fld-disabled")}this.getView().enableField();B.setReadOnly(false)};this.isAccessible=function(E){return !B.isReadOnly(E)};this.hideShowField=function(E){if(E){this.getView().showField()}else{this.getView().hideField()}B.setVisiblity(E)};this.clear=function(){this.getView().setValue("")};this.triggerEventsOnSetFieldValue=function(F,G,E){if(B.isFormulaExist()&&F){this.getView().trigger("triggerformula")}if(B.isZiaInput()&&G){this.getView().trigger("triggerzia")}if(B.isOnChangeExist()&&!(B.isZiaInput()&&B.isZiaOnUserInputExist())&&(!B.isSubformField()||B.isAddedToParent)){if(E){this.getView().trigger("onuserinput")}B.isAddedToParent=false}};this.setFieldValue=function(F,E){var G=this.getValue();this.setValue(F,true);this.triggerEventsOnSetFieldValue((G!=F),true,(!(B.getComponentType()==FieldType.EXTERNAL_FIELD&&E!=undefined&&E!=""&&E.compType==FieldType.EXTERNAL_LINK_FIELD)))};this.setValue=function(G,E){this.getView().setValue(G);if(B.isCompositeSubField()){var H=this.getParentField();var F=H.getModel();if(B.isAddressSubField()){H.subFieldsGroupHandler(B.getGMAPKEY(),E)}else{if(F.isOnChangeExist()&&E){H.getView().trigger("onuserinput")}}}};this.reset=function(){this.setValue(B.getDefaultValue())};this.getField=function(){return this.getView().getField()};this.getParentField=function(){var E=B.isSubformField()?D.getFormController():D;if(B.isCompositeSubField()&&B.getGroupParentField()!=undefined){return B.isSubformField()?D.getModel().getSubformField(B.getRowID(),B.getGroupParentField()):E.getFieldController(B.getGroupParentField())}};this.isFieldSupportedInInplace=function(E){var F=[FieldType.NAME,FieldType.ADDRESS,FieldType.DECISIONBOX,FieldType.PLAIN_TEXT,FieldType.RICH_TEXT_AREA,FieldType.SECTION,FieldType.SIGNATURE,FieldType.SUB_FORM_GRID,FieldType.INLINE_RADIO];return(F.indexOf(E)==-1)};this.triggerFormHeightCalculation=function(){if(B.isSubformField()){D.getFormController().recalculateFormHeight()}else{D.recalculateFormHeight()}};var A=B.getComponentType();if(A==FieldType.EMAIL_ADDRESS){this.specificValidator=new EmailValidator()}else{if(A==FieldType.NUMBER||A==FieldType.PERCENTAGE||A==FieldType.DECIMAL){this.specificValidator=new NumericValidator()}else{if(A==FieldType.PHONE_NUMBER){this.specificValidator=new PhoneNumberValidator()}else{this.specificValidator=new BasicValidator()}}}});createPrototype(FieldController,ControllerFactory.prototype,new BasicValidator());var ZiaTextController=(function(A,B){FieldController.call(this,A,B);this.setValue=function(D,C){this.getView().setValue(D)};this.getValue=function(){var E=this.getView().getValue();if(A.getFieldType()==FieldType.CURRENCY){var F=E.split(" ",2);var C=F[1];var D=A.getValueFormat();if(!isNull(C)&&D!==FormatConstants.DEFAULTFORMAT){return C.replace(new RegExp("\\"+FormatSeparators[D][0],"g"),"").replace(new RegExp("\\"+FormatSeparators[D][1],"g"),".")}}return E}});createPrototype(ZiaTextController,FieldController.prototype,new BasicValidator());var CurrencyController=(function(A,B){FieldController.call(this,A,B);this.getValue=function(){var D=this.getView().getValue();var C=A.getValueFormat();if(!isNull(D)&&C!==FormatConstants.DEFAULTFORMAT){return D.replace(new RegExp("\\"+FormatSeparators[C][0],"g"),"").replace(new RegExp("\\"+FormatSeparators[C][1],"g"),".")}return D}});createPrototype(CurrencyController,FieldController.prototype,new BasicValidator());var URLController=(function(B,C){FieldController.call(this,B,C);var D=this.getView(),A=B.getActualLabelName();this.init=function(){var E=B.getData();D=this.getView();D.setURLVal(E.urlSRC);D.setLinkVal(E.urlLinkName);D.setTitleVal(E.urlTitle)};this.getValue=function(){var E={};E[A]="";E["zcurl-"+A]=D.getURLVal();E["zctarg-"+A]=B.getURLTarget();if(B.isLinkNameReq()){E["zclnkname-"+A]=D.getLinkVal()}if(B.isTitleReq()){E["zctitle-"+A]=D.getTitleVal()}return JSON.stringify(E)};this.setValue=function(F){var E=parseAttr(B.getComponentType(),F);D.setURLVal(E.zcurl);D.setLinkVal(E.zclnkname);D.setTitleVal(E.zctitle);B.setURLTarget(E.target);D.fieldEvents()};this.reset=function(){D.reset()}});createPrototype(URLController,FieldController.prototype,new BasicValidator());var ImageController=(function(B,F){FieldController.call(this,B,F);var G=this.getView(),A=B.getActualLabelName();var E={};var D=B.getImageType(),C=B.getImageSelectedType();this.init=function(){var H=B.getData();G=this.getView();(H.imgLink)?G.setLinkVal(H.imgLink):G.getDOM().getLinkComp().parent().addClass("hide");(H.imgTitle)?G.setTitleVal(H.imgTitle):G.getDOM().getTitleComp().parent().addClass("hide");if(H.imgSRC&&C===1||C===3||(C===2&&D==Constants.LINK)){G.setSourceVal(H.imgSRC)}if(D==Constants.LINK||D==Constants.LINKANDCAMERA||C==3){G.getDOM().getSourceCompDiv().show();G.getDOM().getFileInput().hide()}};this.regImageEvent=function(){if(D!=Constants.LINK&&D<=Constants.IMAGEALLOPTION){var J=B.isSubformField()?B.getFormModel().getLabelName():undefined;var L=this.getURL().getUploadURL();var M=this.getURL().getDeleteFileURL();var I=B.isSubformField()?B.getFormModel().getFormModel():B.getFormModel();var K={};K.data={subform:J};if(!LIB._isNull(I.getViewLinkName())){K.data.viewLinkName=I.getViewLinkName()}K.data.formAccessType=I.getAccessType();if(I.getAccessType()==FormAccessType.LOOKUP_ADD){var H=this.getChildRelation();K.data=$.extend(K.data,H)}if(I.hasPrivateLink()&&!isNull(I.getPrivateLink())){L=L+"/"+I.getPrivateLink();M=M+"/"+I.getPrivateLink()}K.name=B.getLabelName();K.url=L;K.deleteUrl=M;K.data[ZCGlobal.csrfTokenName]=ZCGlobal.csrfToken;K.dimension=this.getView().getDOM().getFileInputEl().attr("dimension");if(!LIB._isNull(B.getDefaultValue())&&B.isLocalImgSRC()){K.defaultVal=B.getImgBrowse()}E=Object.create(MediaPopup);E.setOpts(K);E.formController=F;K.isDefaultValuePreseent=false;if(B.getDefaultValue()!=""&&B.getDefaultValue()!=undefined){K.isDefaultValuePreseent=true}G.createUpload(K)}if(D==Constants.LINKANDLOCAL||D==Constants.LOCALANDCAMERA||D==Constants.IMAGEALLOPTION){G.createTab(B.isLocalImgSRC()||LIB._isNull((B.getImageSRC()!=undefined?B.getImageSRC().trim():B.getImageSRC())))}if(G.isFloatLabelAlignment()){G.bindFocus()}};this.getImageObj=function(){return E};this.getValue=function(H){var J={};if(D==Constants.LINK){G.setSelectedType(1)}else{G.setSelectedType(E.getSelectedType())}var I=(D==Constants.LOCAL||(D==Constants.LINKANDLOCAL&&G.getSelectedType()==Constants.LOCAL)||(D==Constants.CAMERA&&G.getSelectedType()==Constants.LOCAL)||(D==Constants.CAMERAANDLOCAL&&G.getSelectedType()==Constants.LOCAL)||(D==Constants.LINKANDCAMERA&&G.getSelectedType()==Constants.LOCAL)||(D==Constants.IMAGEALLOPTION&&G.getSelectedType()==Constants.LOCAL));J[A]="";J["zcsource-"+A]=G.getSourceVal(I&&G.getSelectedType()!=3);J["zcimagetype-"+A]=(I&&G.getSelectedType()!=3)?"2":"1";J.addToStore=G.addToStore();J["zctarget-"+A]=B.getImageTarget();if(B.isLinkReq()){J["zcfieldlink-"+A]=G.getLinkVal()}if(B.isTitleReq()){J["zctitle-"+A]=G.getTitleVal()}if(B.isAltReq()){J["zcalttext-"+A]=G.getAltVal()}return JSON.stringify(J)};this.setFieldValue=function(J,I){var L=this.getValue();var K=($((this.getView().getFieldContainer())[0].querySelectorAll(".filename i")).length!=0);var H=(J==""&&K);this.setValue(J);this.triggerEventsOnSetFieldValue((!H&&L!=J),!H,!H)};this.setValue=function(I){if(B.isZiaInput()){this.getView().trigger("triggerzia")}if(I==""){G.clearValue();return }var H=parseAttr(B.getComponentType(),I);G.setSourceVal(H.zcsource);G.setLinkVal(H.zcfieldlink);G.setTitleVal(H.zctitle);G.setAltVal(H.zcalttext);B.setImageTarget(H.target);G.showLink();if(B.getImageType()==1){G.fieldEvents()}};this.reset=function(){G.reset()};this.clear=function(){G.clearValue()}});createPrototype(ImageController,FieldController.prototype,new BasicValidator());var FileUploadController=(function(A,B){FieldController.call(this,A,B);this.regFileUploadEvent=function(){var C=A.isOneFileUpload(),I=this.getView(),K=this;var L=A.isSubformField()?A.getFormModel().getLabelName():undefined;var F=true;var D=this.getURL().getUploadURL();var H=this.getURL().getDeleteFileURL();var J=A.isSubformField()?A.getFormModel().getFormModel():A.getFormModel();var E={};E.data={subform:L};if(!LIB._isNull(J.getViewLinkName())){E.data.viewLinkName=J.getViewLinkName()}E.data.formAccessType=J.getAccessType();if(J.getAccessType()==FormAccessType.LOOKUP_ADD){var G=this.getChildRelation();E.data=$.extend(E.data,G)}if(J.hasPrivateLink()&&!isNull(J.getPrivateLink())){D=D+"/"+J.getPrivateLink();H=H+"/"+J.getPrivateLink()}E.name=A.getActualLabelName();E.url=D;E.deleteUrl=H;E.isCloud=!C;E.data[ZCGlobal.csrfTokenName]=ZCGlobal.csrfToken;if(A.getDefaultValue()){E.defaultVal=A.getDefaultValue()}if(F){E.services=A.getCloudService()}E.isDefaultValuePreseent=false;if(A.getDefaultValue()!=""&&A.getDefaultValue()!=undefined){E.isDefaultValuePreseent=true}I.createUpload(E);if(I.isFloatLabelAlignment()){I.bindFocus()}};this.isPickerRestricted=function(){return A.isPickerRestricted()};this.getValue=function(C){var D={};D[A.getActualLabelName()]=this.getView().getValue();D.addToStore=this.getView().addToStore();return JSON.stringify(D)};this.setFieldValue=function(F,D){var H=this.getValue();var E=$((this.getView().getFieldContainer())[0].querySelectorAll(".filename i"));var G=E.length!=0;var C=(F==""&&G);if(C){E.trigger("click")}else{this.setValue(F,true)}this.triggerEventsOnSetFieldValue((!C&&H!=F),!C,!C)};this.clear=function(){var C=$((this.getView().getFieldContainer())[0].querySelectorAll(".filename i"));if(C.length==0){this.getView().setValue("")}else{C.trigger("click")}}});createPrototype(FileUploadController,FieldController.prototype,new BasicValidator());var MediaController=(function(A,D){FieldController.call(this,A,D);var C={},B={};this.regFileUploadEvent=function(){var L=this.getView();var E=this;var H=A.isSubformField()?A.getFormModel().getLabelName():undefined;var J=this.getURL().getUploadURL();var K=this.getURL().getDeleteFileURL();var G=A.isSubformField()?A.getFormModel().getFormModel():A.getFormModel();if(G.hasPrivateLink()&&!isNull(G.getPrivateLink())){J=J+"/"+G.getPrivateLink();K=K+"/"+G.getPrivateLink()}var I={};I.name=A.getActualLabelName();I.url=J;I.deleteUrl=K;I.data={subform:H};I.data[ZCGlobal.csrfTokenName]=ZCGlobal.csrfToken;I.data.formAccessType=G.getAccessType();if(!LIB._isNull(G.getViewLinkName())){I.data.viewLinkName=G.getViewLinkName()}if(G.getAccessType()==FormAccessType.LOOKUP_ADD){var F=this.getChildRelation();I.data=$.extend(I.data,F)}if(A.getDefaultValue()){I.defaultVal=A.getDefaultValue()}I.fieldType=A.getComponentType();if(A.getComponentType()==137){C=Object.create(MediaPopup);C.setOpts(I)}else{if(A.getComponentType()==138){B=Object.create(MediaPopup);B.setOpts(I)}}I.isDefaultValuePreseent=false;if(A.getDefaultValue()!=""&&A.getDefaultValue()!=undefined){I.isDefaultValuePreseent=true}L.createUpload(I)};this.getMediaPopup=function(){if(A.getComponentType()==137){return C}else{if(A.getComponentType()==138){return B}}return null};this.setFieldValue=function(H,F){var J=this.getValue();var G=$((this.getView().getFieldContainer())[0].querySelectorAll(".filename i"));var I=G.length!=0;var E=(H==""&&I);if(E){G.trigger("click")}else{this.setValue(H,true)}this.triggerEventsOnSetFieldValue((!E&&J!=H),!E,!E)};this.clear=function(){var E=$((this.getView().getFieldContainer())[0].querySelectorAll(".filename i"));if(E.length==0){this.getView().setValue("")}else{E.trigger("click")}};this.getValue=function(E){var F={};F[A.getActualLabelName()]=this.getView().getValue();F.addToStore=this.getView().addToStore();return JSON.stringify(F)}});createPrototype(MediaController,FieldController.prototype,new BasicValidator());var SelectController=(function(C,H){FieldController.call(this,C,H);var E=this.getURL(),A=this,D,F,B;this.createSelect=function(){var V=this;var M=C;var O=false;var Q=[],S,R,T,L,W,K,X,J;var I={more:false,results:M.getChoices(""),cache:true};function N(Z){try{return Z.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}catch(Y){return Z}}function P(a,d,e){var c=a.filter(function(h){if(h.text!=undefined&&h.UserName!=undefined){h.text=h.UserName+" ("+h.EmailID+")"}return((d==""||N(h.text.toUpperCase()).indexOf(N(d.toUpperCase()))>=0)&&h.text!="")});if(C.isFromReport()&&C.getFieldType()==FieldType.EXTERNAL_FIELD){K=D.select2("data");if(K.length!=0){K.filter(function(h){c=c.filter(function(j){return(j.text!=h.text)})})}}if(!C.isLookup()&&C.isOtherEnabled()){c.push({id:Constants.OTHER_OPTION,text:i18n.otheroption})}if(d==""){if(M.isFromReport()==undefined){V.toggleSearchBox(c)}}if(C.isFromReport()&&C.getFieldType()==FieldType.MULTI_SELECT&&C.getTotalRecordsCount()<V.recordsLimit){K=D.select2("data");if(K.length!=0&&d!=""){var b=K[K.length-1];var Y=true,Z;$.each(c,function(h,j){R=j.id;T=j.text;Z="";Y=true;if(R!=b.id){var m=[];if(b.id instanceof Object){$.each(b.id,function(n,o){o=o.substring(1,o.length);if(o==T||!C.isPredefinedChoices(o)){Y=false}m.push("#"+o)})}else{if(!C.isPredefinedChoices(b.id)){Y=false}m.push("#"+b.text)}m.push("#"+T);if(m.length<=3&&Y){J={id:m,text:b.text+" & "+T};c.push(J)}}})}}return{more:e,results:c}}if(M.isExternalField()&&M.getModuleType()!=18){O=true}F={placeholder:(!(this.getView().isFloatLabelAlignment())||C.isSubformField())?i18n.dropdownselect:" ",allowClear:true,dropdownCssClass:C.getActualLabelName()+"-switch-search",data:M.getChoices(""),separator:"@#zoho-comma#@",formatSearching:function(){if(C.isLookup()&&C.isLookupFirstFetchNeeded()){return"Loading..."}else{return"Searching..."}},createSearchChoice:function(Y){if(C.isFromReport()&&$.trim(Y)!=""){return{id:$.trim(Y),text:$.trim(Y)}}else{return }},query:function(p){var s=this;var a=E.getRelDataURL();var h=false;var j=false;if((p.page==undefined&&p.term==undefined)||!M.isRequestCompleted()){p.callback(I);--s.element.data().select2.queryCount;return }var d=M.getCacheTerm(p.term),Y=(M.isSaturated(""))?M.getChoices(""):M.getChoices(d),o=p.page;var c=(M.isSaturated(""))?false:!M.isSaturated(d);if(C.isSubformField()){C.getFormModel().getFormModel().setTriggeredControllerType("fieldController")}else{C.getFormModel().setTriggeredControllerType("fieldController")}if(!j&&M.isLookup()){var Z,b;Z=p.ZCTriggerAjax;b=p.dataPresent;if(!b&&Y.length>0){b=true;jQuery.each(Y,function(u,w){if(w.text){b=false;return false}})}j=(Z||b)}if(M.isExternalField()&&p.term.length==1){h=true}if((((Y.length>0&&o<=M.getCurrentPage(d))||!c)&&!j)||h){if(p.term!=""){F.isFirstValue=true}var n=P(Y,p.term,c);n.cache=true;I=n;p.callback(n);return }else{var e={};if(!M.isExternalField()&&!M.isIntegrationField()){e=H.collectData()}e.searchVal=d;if(M.isIntegrationField()){e.noOfRecsInCache=!M.getIntegRecCount()?0:M.getIntegRecCount();if(d!=""){e.noOfRecsInCache=M.getChoices(d).length;$(s.element.data().select2.search).addClass("select2-active")}}else{if(d==""){var q=M.getChoices("zckey_appendedValues");e.noOfRecsInCache=Y.length-q.length}else{e.noOfRecsInCache=Y.length}}if(M.isSubformField()){e.subformName=M.getFormModel().getLabelName();e.rowseqid=M.getRowID()}if(M.isExternalField()){e.serviceType=M.getServiceType();e.moduleType=M.getModuleType()}var m=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();e.formAccessType=m.getAccessType();if(V.getChildRelation()!=""){e=$.extend(e,V.getChildRelation())}if(m.hasPrivateLink()&&!isNull(m.getPrivateLink())){e.privatelink=m.getPrivateLink()}M.sendingReq();delete e.updateIdList;$.ajax({url:"",method:"POST",data:e,beforeSend:function(){this.url=a},success:function(x){var w=null;if(M.isIntegrationField()){var y=M.getIntegRecCount()?M.getIntegRecCount()+x.count:x.count;M.setIntegRecCount(y);if(d!=""){$(s.element.data().select2.search).removeClass("select2-active")}}var u=M.getChoices(d).length;if(M.isValuesAlreadyPopulated()&&e.searchVal==""&&e.noOfRecsInCache==0){x.data=M.getChoices("");x.count=M.getChoices("").length;x.isSaturated=true}else{z()}if(e.searchVal!=""){F.isFirstValue=(u==0)?true:false;x.data=C.getChoices(d);$((D.data("select2").dropdown)[0].querySelector("ul")).empty()}w=P(x.data,$(s.element.data().select2.search).val(),!x.isSaturated);w.ajax=true;I=w;M.lookupFirstFetchCompleted();M.reqCompleted();var AA=e.searchVal==""?($(s.element.data().select2.search).val()!=""?true:false):true;if(M.isLookup()&&!x.isSaturated&&AA&&e.searchVal!=$(s.element.data().select2.search).val()){p.ZCTriggerAjax=true;p.term=$(s.element.data().select2.search).val();s.query(p)}else{if(w.results.length==0&&!x.isSaturated){p.dataPresent=true;s.query(p)}else{p.callback(w)}}function z(){if(M.isLookup()&&!M.isDynamicLookup()&&M.isSubformField()){var AB=M.getFormModel();var AI=AB.getAvailableRows();var AE=-1;for(var AF=0;AF<AI.length;AF++){var AD=AI[AF];var AH=AB.getRow(AD).FIELDS;if(AE!=-1){var AG=AH[AE].CONTROLLER.getModel();AG.addChoices(d,o,x,true)}else{for(var AC=0;AC<AH.length;AC++){var AG=AH[AC].CONTROLLER.getModel();if(AG.getActualLabelName()==M.getActualLabelName()){AE=AC;AG.addChoices(d,o,x,true);break}}}}}else{M.addChoices(d,o,x,true)}}}})}}};if(!M.isExternalField()&&M.getChoiceCount()<=10&&M.isSaturated("")){this.getView().getDOM().getSearchBoxContainer().addClass("select2-search-hidden select2-offscreen")}if(O){F.formatNoMatches=function(Y){if(Y.length==1){return i18n.mincharacter}else{return i18n.nomatchfound}}}if(C.getComponentType()==FieldType.LIST||C.getComponentType()==FieldType.CHECK_BOXES||C.isFromReport()==true||(C.getComponentType()==FieldType.SYSTEM_LOOKUP&&C.getSystemDisplayType()==FieldType.USER_MULTI_SELECT)){F.multiple=true;F.closeOnSelect=false}if(C.isFromReport()==true){F.createSearchChoicePosition="bottom";F.openOnEnter=false}if(C.getComponentType()==FieldType.POPUP_SINGLE&&!C.isIntegrationField()){F.formatResult=function(Z){var Y='<div class="crm-user" id="'+Z.id+'"><p class="crm-text">'+Z.text+"</p></div>";if(Z.UserName!=undefined&&Z.EmailID!=undefined){Y='<div class="crm-user" id="'+Z.id+'"><p class="crm-user-name">'+Z.UserName+'</p><p class="crm-user-email">'+Z.EmailID+"</p></div>"}return Y};F.formatSelection=function(Y){if(Y.UserName!=undefined&&Y.EmailID!=undefined){return Y[C.getDisplayField()]}else{return Y.text}}}if(((C.getComponentType()==FieldType.RADIO||C.getComponentType()==FieldType.CHECK_BOXES)&&!C.isSubformField())&&(!C.isLookup()||!C.isSearchEnabled())||(C.getComponentType()==FieldType.INLINE_RADIO&&!C.isSubformField())){if(!C.isExternalField()){return }}if(C.isFromReport()){D=this.getView().intitateSelect(F,H.getReportViewInstance())}else{D=this.getView().intitateSelect(F)}if(M.isFromReport()){D.on("select2-focus",function(){var Y=V.getView().getDOM().getField();$(".zc-active-search-block").removeClass("zc-active-search-block");$(Y).parents("li").addClass("zc-active-search-block")})}if(C.hasAddToParent()){var U=$("<div>",{id:"addNew","class":"addnewparent",text:C.getAddToParentText()});U.prepend("<i class='fa fa-plus'></i>");U.click(function(){V.addNewParent(D)});$((D.data("select2").dropdown)[0].querySelector("ul")).after(U)}D.select2("zcData",C.getDefaultValue())};this.setValue=function(O,I){var L=O;O=C.sanitizeChoices(O);if(L instanceof Array){L=[];var M=0;for(var J in O){if(O!=undefined&&C.hasChoice(O[J].id)){L[M++]=O[J]}}}if(L!=undefined&&((L.length>0)||C.hasChoice(L.id)||((C.isExternalField()||C.isIntegrationField())&&L.id))){if(C.isExternalField()&&L!=""&&L.id==-1){L.id=null}this.getView().setValue(L)}else{if(!C.isOtherEnabled()){this.getView().setValue("")}}if(C.isOtherEnabled()){if(L!=undefined&&L.id&&!C.hasChoice(L.id)){this.getView().setValue({id:Constants.OTHER_OPTION,text:i18n.otheroption});$((this.getField().parent())[0].querySelector('div[elname="othersinput"]')).show();var N=this.getView().getDOM();N.getOtherValueField().val(O.text)}else{if(L==""){this.clearSelectedValues();$((this.getField().parent())[0].querySelector('div[elname="othersinput"]')).hide()}else{$((this.getField().parent())[0].querySelector('div[elname="othersinput"]')).hide()}}}if(C.isCompositeSubField()){var P=this.getParentField();var K=P.getModel();if(C.isAddressSubField()){P.subFieldsGroupHandler(C.getGMAPKEY(),I)}else{if(K.isOnChangeExist()&&I){P.getView().trigger("onuserinput")}}}};this.toggleSearchBox=function(I){if(!C.isExternalField()){if(I!=undefined&&I.length<=10&&C.isSaturated("")){this.getView().getDOM().getSearchBoxContainer().addClass("select2-search-hidden select2-offscreen")}else{this.getView().getDOM().getSearchBoxContainer().removeClass("select2-search-hidden select2-offscreen")}}};if(C.isExternalField()||C.isIntegrationField()){this.getValue=function(){if(C.isIntegrationField()){I=C.getIntegrationFieldValue()}else{if(C.getModuleType()!=18){I=this.getSelectedChoice()}else{var K=this.getView().getValue(),J=C.getChoices(""),I;if(J.length>0){I=J.filter(function(L){return L.id==K});I=(I!=undefined)?I[0]:{}}else{if(C.getDefaultValue()!=undefined){I=C.getDefaultValue()}else{if(K!=undefined){I=this.getSelectedChoice()}}}}}I=(I!=undefined)?I:{};return JSON.stringify(I)}}this.getChildRelation=function(){var I=H.getChildRelation();I["zc_childlabelname_"+I.zc_lookupCount]=C.getActualLabelName();I.isFromSubForm=C.isSubformField();I.childFieldLabelName=C.getActualLabelName();I.lookupFieldName=C.getRefFieldLabel();if(I.isFromSubForm==false){I.isNewTypeSubform=false}return I};this.resetLoadLookup=function(){C.resetLoadLookup()};this.addValue=function(I){C.addChoice("",I,1)};this.addNewParent=function(J){if(!C.hasActiveRequest){var P,L,O;var I=this;if(C.isLookupAddRestricted()){$.alert({msg:i18n.lookupaddrestriction});if(C.isSelectField()){D.select2("close")}return }LIB._startLoading();if(!C.isSelectField()){C.isAddedToParent=true}var K=E.getRelatedForm();var N=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();if(N.hasPrivateLink()&&!isNull(N.getPrivateLink())){K=K+"&privatelink="+N.getPrivateLink()}if(C.hasActiveRequest!=undefined){C.hasActiveRequest=true}$.zcAjax({beforeSend:function(){LIB._startLoading()},url:K,data:I.getChildRelation(),type:"GET",success:function(R,Q,S){M(R);LIB._stopLoading();if(C.hasActiveRequest!=undefined){C.hasActiveRequest=false}if(C.isSelectField()){J.select2("close")}},error:function(Q){M(Q.responseText);LIB._stopLoading();if(C.hasActiveRequest!=undefined){C.hasActiveRequest=false}if(C.isSelectField()){J.select2("close")}}});function M(Q){$.zcmodal({type:Constants.JIT_MODAL,bodyClass:"popup-form",wrapperClass:"zc-mob-fullscreen",buildDOM:function(){return Q.HTML?Q.HTML:Q},beforeShow:function(){if(Q.MODEL!=undefined){Controller.FormController.create({model:Q.MODEL,type:FormControllerType.LOOKUPFORM,childField:I,data:Q.RECORD,dynamicMeta:Q.DYNAMIC_META})}},afterClose:function(){I.focus()}})}}};this.clear=function(){if(!C.isRequestCompleted()){C.setValuesPopulated()}C.clearChoices();this.setValue("");this.clearSelectedValues()};this.clearSelectedValues=function(){this.getView().setValue("");if(C.isOtherEnabled()){var I=this.getView().getDOM();I.getOtherValueField().val("")}A.dynamicUpdateSelect2Choices()};this.appendValue=function(J,I){C.appendChoices(J,I);A.dynamicUpdateSelect2Choices()};this.deselectValue=function(I){var K=D.select2("data");var J;if(Array.isArray(K)){J=K.filter(function(L){var M=I.filter(function(N){return(N.id==L.id)});return(M.length==0)})}else{if(K!=null){J=K;if(I[0].id==K.id){J=[]}}}this.setValue(J)};this.selectAll=function(){if(C.isLookup()&&C.isLookupFirstFetchNeeded()){this.getView().loadValues()}else{this.setValue(C.getChoices(""))}};this.deselectAll=function(){this.setValue("")};this.getSelectedChoice=function(){return this.getView().getSelectedChoice()};this.dynamicUpdateSelect2Choices=function(){var J=this.getView().getDOM();var I=$(J.getField()).parent().find(".select2-container-active");if(I!=undefined&&I.hasClass("select2-dropdown-open")){$(J.getField()).select2("close");$(J.getField()).select2("open")}};this.validateSelectedValues=function(L,M){if(L instanceof Array){var K=[];for(var J=0,I=L.length;J<I;++J){if(G(L[J],M)){K.push(L[J])}}return K}else{return G(L,M)?L:""}};function G(K,L){for(var J=0,I=L.length;J<I;++J){if(L[J].id===K.id){return true}}return false}this.getTranslatedTexts=function(O,M,K){var N=[];for(var L=0,J=M.length;L<J;L++){var I=M[L];if(K[I.id]!==undefined){N.push(A.getTranslatedText(O,I))}else{N.push(I)}}return N};this.getTranslatedText=function(L,K){if(K===undefined||K.length===0){return K}for(var J=0,I=L.length;J<I;++J){if(L[J].id===K.id){return L[J]}}return K};this.getTranslatedTextFromId=function(L,K){if(K===undefined||K.length===0){return K}for(var J=0,I=L.length;J<I;++J){if(L[J].id===K){return L[J].text}}return K}});createPrototype(SelectController,FieldController.prototype);var SingleSelectController=(function(A,B){SelectController.call(this,A,B);this.init=function(){if(!A.isLookup()&&!A.isExternalField()&&!A.getGMAPKEY()){this.validateAndFillSelectedValues()}};this.validateAndFillSelectedValues=function(I){var H=A.getChoices("");var G=A.getData().FIELDVALUE;var F=this.validateSelectedValues(G,H);var C=B.getModel().getAccessType();if(G!==F){if(A.isOtherEnabled()){this.getView().getDOM().getOtherValueContainer().show(400);var E=decode(undefined,G.text);$(this.getView().getDOM().getOtherValueContainer().find("input")).val(E);F={id:Constants.OTHER_OPTION,text:i18n.otheroption}}else{if(C===FormAccessType.VIEW_EDIT_RECORD||C===FormAccessType.SEARCH_FORM){var D=$.extend(true,[],[G]);if(!I){this.appendValue(D)}F=G}}}else{if(A.isTranslatedField()){F=this.getTranslatedText(H,F)}}A.setDefaultValue(F)}});createPrototype(SingleSelectController,SelectController.prototype,new BasicValidator());var DropdownController=(function(A,B){SingleSelectController.call(this,A,B)});createPrototype(DropdownController,SingleSelectController.prototype,new BasicValidator());var RadioController=(function(B,D){SingleSelectController.call(this,B,D);var C=this.getURL(),A=this;if(!B.isSelectField()){_superinit=this.init;this.init=function(){_superinit.call(this);if(B.isLiveVariableCriteriaLookup()||B.isDynamicLookup()){var E=B.getChoices("");this.appendValue(E);this.validateAndFillSelectedValues(true)}if(B.getDefaultValue()!==undefined&&B.getDefaultValue()!==""){this.getView().setValue(B.getDefaultValue())}};this.clear=function(){B.clearChoices();this.getView().clearChoices()};this.appendValue=function(E){B.appendChoices(E);this.getView().appendChoices(E)}}this.addValue=function(F){var E=[];E.push(F);B.appendChoices(E);this.getView().appendChoices(E)};this.deselectValue=function(E){this.getView().deselect(E)};if(B.isDynamicLookup()){this.getView().appendChoices(B.getAllChoices()["data"])}});createPrototype(RadioController,FieldController.prototype,new BasicValidator());var MultiSelectController=(function(A,B){SelectController.call(this,A,B);this.init=function(){if(!A.isLookup()){this.validateAndFillSelectedValues()}};this.validateAndFillSelectedValues=function(C){var L=A.getChoices("");var F=A.getData().FIELDVALUE;var G=this.validateSelectedValues(F,L);var J={};for(var H=0,I=G.length;H<I;H++){var D=G[H];J[D.id]=true}var K=B.getModel().getAccessType();if(G.length<F.length){if(A.isTranslatedField()){F=this.getTranslatedTexts(L,F,J)}if(K===FormAccessType.VIEW_EDIT_RECORD||K===FormAccessType.SEARCH_FORM){var E=F.filter(function(M){return J[M.id]===undefined});E=$.extend(true,[],E);if(!C){this.appendValue(E)}G=F}}else{if(A.isTranslatedField()){G=this.getTranslatedTexts(L,G,J)}}A.setDefaultValue(G)}});createPrototype(MultiSelectController,SelectController.prototype,new BasicValidator());var CheckBoxController=(function(B,E){MultiSelectController.call(this,B,E);var C=this.getURL(),A=this;if(!B.isSelectField()){var D=this.init;this.init=function(){D.call(this);if(B.isLiveVariableCriteriaLookup()||B.isDynamicLookup()){var F=B.getChoices("");this.appendValue(F);this.validateAndFillSelectedValues(true)}if(B.getDefaultValue()!==undefined&&B.getDefaultValue()!==""){this.getView().setValue(B.getDefaultValue())}};this.clear=function(){B.clearChoices();this.getView().clearChoices()};this.appendValue=function(F){B.appendChoices(F);this.getView().appendChoices(F)};this.selectAll=function(){this.setValue(B.getChoices(""))};this.deselectAll=function(){this.setValue("")};this.deselectValue=function(F){this.getView().deselect(F)}}this.addValue=function(G){var F=[];F.push(G);B.appendChoices(F);this.getView().appendChoices(F)};if(B.isDynamicLookup()){this.getView().appendChoices(B.getAllChoices()["data"])}});createPrototype(CheckBoxController,MultiSelectController.prototype,new BasicValidator());var RichTextController=(function(A,B){FieldController.call(this,A,B);this.init=function(){this.getView().getDOM().getField().val(A.getDefaultValue())};this.createEditor=function(){var C=A.getToolbarConfig();C.content=A.getDefaultValue();editor=this.getView().createEditor(C)}});createPrototype(RichTextController,FieldController.prototype,new BasicValidator());var CompositeController=(function(A,B){FieldController.call(this,A,B);this.createSelect=function(C){this.getView().initiateSelect(C)};this.initiateCompositeField=function(){var D=this;var G=A.getFullCompositeFields();var F=[];for(var E in G){var I=G[E];I.GROUPPARENTFIELD=A.getActualLabelName();I.GROUPPARENTFIELDTYPE=A.getComponentType();I.ISSUBFORM=A.isSubformField()+"";I.ROWID=A.getRowID();var C=Controller.FieldController.create({model:I,formController:B,data:I.defaultData});I.CONTROLLER=C;if(I.GMAPKEY==="country"||I.GMAPKEY==="prefix"){D.createSelect(I.GMAPKEY)}if(!C.getModel().isCoordinateField()){A.setCompositeField(E,I)}else{A.setCoordinateField(E,I)}if(A.getComponentType()==FieldType.ADDRESS){var H=A.getParentFormModel().getParamFieldLabels();if(!isNull(H)&&H.indexOf(I.FIELDLABELNAME)!==-1){F.push(C.getModel().getGMAPKEY())}}}if(A.getComponentType()==FieldType.ADDRESS){this.getView().toggleAdjustLocationContent();if(A.isCaptureGeoCoordinates()){if(D.isGeocodeEligible(F)){D.geocodeAddress(false)}}else{if(D.hasMainFields(F)){this.getView().updateZMAPLocation("","",true)}}}};this.getValue=function(){var N=A.getCompositeFields(),C={};for(var M in N){var L=N[M],E=L.FIELDLABELNAME,J=L.ACTUALLABEL;if(L.GMAPKEY==="country"){var H=this.getView().getValue(E);var K=Constants.COUNTRY_MAP[H];K=(K!=undefined)?K:H;C[J]=K}else{C[J]=this.getView().getValue(E)}}var F=A.getDefaultValue();var G=A.isSubformField()?A.getFormModel().getFormModel():A.getFormModel();C.status=(F!=undefined&&F!="")?"edit":"add";if(G.getAccessType()==FormAccessType.BULK_EDIT||G.getAccessType()==FormAccessType.VIEW_EDIT_RECORD){C.status="edit"}C.recID=A.getRecID();if(A.getComponentType()==FieldType.ADDRESS){var I=this.getCompositeSubField(A.getActualLabelNameFromMapKey("latitude"));C.latitude=I.getValue();var D=this.getCompositeSubField(A.getActualLabelNameFromMapKey("longitude"));C.longitude=D.getValue()}return JSON.stringify(C)};this.setValue=function(F){if(typeof (F)=="object"){var E=A.getCompositeFields();for(i=0,l=E.length;i<l;i++){var D=E[i],C=D.ACTUALLABEL;if(F[C]!=undefined){this.getView().setValue(D.FIELDLABELNAME,F[C])}}}};this.reset=function(){var E=A.getCompositeFields();for(i=0,l=E.length;i<l;i++){var D=E[i],C=D.FIELDLABELNAME;if(D.FIELDTYPE==FieldType.INLINE_SINGLE_SELECT){this.getView().resetDropdown(C)}else{this.getView().setValue(C,"")}}};this.focus=function(){var C=A.getSubFieldLabelName(0);A.getCompositeFields()[C].CONTROLLER.focus()};this.getCompositeSubField=function(C){if(A.getFullCompositeFields()!=undefined&&A.getFullCompositeFields()[C]!=undefined){return A.getFullCompositeFields()[C].CONTROLLER}};this.init=function(){this.initiateCompositeField()}});createPrototype(CompositeController,FieldController.prototype,new BasicValidator());var NameController=(function(A,B){CompositeController.call(this,A,B)});createPrototype(NameController,CompositeController.prototype);var AddressController=(function(H,B){CompositeController.call(this,H,B);var J=this;var F=J.getModel().getParentFormModel();var C=null,E=null;var I=function(){F.incrementActiveAddressOps()};var G=function(){F.decrementActiveAddressOps()};this.isStreetFieldsOnly=function(){var M=["administrative_area_level_2","administrative_area_level_1","postal_code","country"];var L=H.getCompositeFields();for(var N in L){var K=L[N];if(M.indexOf(K.GMAPKEY)!==-1){return false}}return true};this.hasMainFields=function(O){var K=["route","locality","administrative_area_level_2","administrative_area_level_1","postal_code","country"];var N=false;var M=false;for(var L in O){if(K.indexOf(O[L])!==-1){N=true;break}}return N};this.isGeocodeEligible=function(L){var K=this.hasMainFields(L);if(K&&(L.indexOf("latitude")!==-1||L.indexOf("longitude")!==-1)){K=false}return K};this.showWarning=function(K){if(H.isAdjustLocation()){if(!this.isSubFieldsEmpty()){this.getView().showWarning(K)}var L=H.isSubformField()?B.getFormController():B;L.cancelSubmitForm()}};this.clearWarning=function(){this.getView().clearWarning()};this.showGeocodeLoader=function(){if(H.isAdjustLocation()){this.getView().showGeocodeLoader()}else{this.showLoader()}};this.hideGeocodeLoader=function(){if(H.isAdjustLocation()){this.getView().hideGeocodeLoader()}else{this.hideLoader()}};var A=[];this.subFieldsGroupHandler=function(L,K){I();if(C){clearTimeout(C);G()}A.push(L);C=setTimeout(function(){J.getView().toggleAdjustLocationContent();J.clearWarning();if(H.isCaptureGeoCoordinates()&&J.isGeocodeEligible(A)){J.geocodeAddress(K)}else{if(H.isCaptureGeoCoordinates()){J.clearGeocodeRequest();if(H.isOnChangeExist()&&K){J.getView().trigger("onuserinput")}}else{if(J.isGeocodeEligible(A)){J.getView().updateZMAPLocation("","",K)}else{if(H.isOnChangeExist()&&K){J.getView().trigger("onuserinput")}}}}A=[];G();C=null},0)};this.getGeocodeQuery=function(){var X=H.getCompositeFields();var L=["filter=3"];var P={};P.limit=1;var N={};var U="",R="";for(var W in X){var V=X[W],O=V.FIELDLABELNAME,T=V.ACTUALLABEL;var K=this.getView().getValue(O);K=K.replace(/"/g,"'");K=K.replace(/</g,"");K=K.replace(/>/g,"");switch(V.GMAPKEY){case"route":U=K;break;case"locality":R=K;break;case"administrative_area_level_2":if(!isNull(K)){N.city=K}break;case"administrative_area_level_1":if(!isNull(K)){N.state=K}break;case"postal_code":if(!isNull(K)){N.postalcode=K}break;case"country":if(!isNull(K)){var S=Constants.COUNTRY_MAP[K.toLowerCase()];var Q=Constants.INVERTED_COUNTRY_MAP[K.toLowerCase()];if(!isNull(S)||!isNull(Q)){N.country=!isNull(S)?S:K}}break}}if(U!=""||R!=""){var M=[];if(U!=""){M.push(U)}if(R!=""){M.push(R)}N.street=M.join(", ")}if(this.isStreetFieldsOnly()){P.q=N.street;L.push("params="+encodeURIComponent(JSON.stringify(P)))}else{P=N;L.push("params="+encodeURIComponent(JSON.stringify(P)));L.push("alevel=10")}return L.join("&")};this.clearGeocodeRequest=function(){if(D&&D.readyState!=4){D.abort();D=null;G()}if(E){clearTimeout(E);E=null;G()}};var D;this.geocodeAddress=function(K){A=[];I();if(D&&D.readyState!=4){D.abort();D=null;G()}if(!this.isSubFieldsEmpty()){J.showGeocodeLoader();if(H.isAdjustLocation()){J.getView().disableAdjustLocation()}if(E){G();clearTimeout(E)}var L={params:this.getGeocodeQuery(),isreverse:false};if(F.hasPrivateLink()&&!isNull(F.getPrivateLink())){L.privatelink=F.getPrivateLink()}E=setTimeout(function(){E=null;J.clearWarning();D=$.ajax({url:Constants.MAP_URL,type:"get",data:L,success:function(M){M=JSON.parse(M);var P="",Q="";if(M.length>0){var O=M[0];P=O.lat;Q=O.lon}else{var N=i18n.mapservicelocationnotfound;J.showWarning(N)}J.getView().updateZMAPLocation(P,Q,K);J.hideGeocodeLoader();G()},error:function(M){J.hideGeocodeLoader();if(M.statusText!="abort"){$.alert({msg:i18n["zc.general.errorMessage"]})}}})},100)}else{J.getView().updateZMAPLocation("","",K);G()}};this.isSubFieldsEmpty=function(){var L=Object.keys(H.getCompositeFields());var K=JSON.parse(this.getValue());return L.reduce(function(N,M){return N&&isNull(K[M])},true)}});createPrototype(AddressController,CompositeController.prototype);var SubformController=(function(L,D){FieldController.call(this,L,D);var I=this,E=L.getDefaultRow(),J=L.getMaxRows(),C=L.getCurrRows(),H,K=C+1,G=this.getView();var M,B,F=0;var N="t::row_0";this.setCurrRow=function(O,Q,P){H=O;M=Q;B=P};this.hasCurrentRow=function(){return(H!=undefined&&M!=undefined)};this.getNextSeqNo=function(){return K};this.isReadOnly=function(){return L.isReadOnly()};this.createDefaultRow=function(O){var Q,T;if(O==undefined){if(Object.keys(L.getAllFields()).length==0&&L.getNullRowFields().length==0){return }var Y=L.getAllFields(),X=Object.keys(Y),R=X.length;for(W in Y){I.setCurrRow(W,Y[W].FIELDS,Y[W].DATA);var P=G.getRow(W);this.bindRow(P,F===0,true);F++}Q=C;T=E}else{Q=0;T=Object.keys(O).length}for(var S=Q;S<T;S++){var V=L.getNullRowFields(),U=L.getNullRowData();I.setCurrRow("t::row_"+K,V,U);L.addNewFields(H,V,K,U);var P=G.getRow(H);if(O!=undefined){var W=Object.keys(O)[S];this.bindRow(P,F===0,false,O[W])}else{this.bindRow(P,F===0,true)}K++;F++}if(F==0){G.createVoidRow();if(this.isReadOnly()){this.hideAddLink();this.hideDeleteLink()}}else{G.hidePlaceHolder()}if(O==undefined){this.bindRowAction()}if(G.getDOM().getWrappingRow()[0].classList.contains("mono-column")){I.constructSubformHeader()}};this.constructSubformHeader=function(){var P=this.getFormController().container||this.getFormController().getView().getDOM().getFormParentContainer().parentElement;var O=P.classList.contains("popupConentContainer");var R=this.getFormController().getView().getDOM().getFormDOM().offsetWidth;var c=this.getFormController().getModel().getAccessType()==FormAccessType.VIEW_ADD_RECORD||this.getFormController().getModel().getAccessType()==FormAccessType.VIEW_EDIT_RECORD;var a=this.getFormController().isFormFullScreen();var d=!document.getElementById("zc-component").classList.contains("zc-page-content-wrapper");d=d||O;var U=document.body.classList.contains("zc-form-perma");var V=document.body.classList.contains("zc-form-embed");var Z=this.getFormController().isEmbedorPerma();if(Z&&!O){P=document}var T=P.querySelector('[subformHeader="true"]');var Q=P.querySelector("#zc-subform-header-parent");var S=this.getFormController().scrollBarWidth;if(d&&!isMobileBrowser()){var b,Y;if(!T){Y=document.createElement("div");Y.setAttribute("id","zc-subform-header-parent");Y.classList.add("zc-subform-header-container-parent");Y.style.overflow="hidden";if(V&&!O){Y.style.margin="0px 11px"}else{if(!Z&&O&&!(c&&a)){Y.style.margin="0px 20px"}else{if(!Z){if(appMeta.APPTHEME===2||appMeta.APPTHEME===3||appMeta.APPTHEME===5){Y.style.margin="0px 15px"}else{if(appMeta.APPTHEME===8||appMeta.APPTHEME===9){Y.style.margin="0px 25px"}else{if(appMeta.APPTHEME===4){Y.style.margin="0px 30px"}else{if(appMeta.APPTHEME===6){Y.style.margin="0px 15px"}else{Y.style.margin="0px 20px"}}}}}else{Y.style.margin="0px 20px"}}}b=document.createElement("div");b.setAttribute("subformHeader","true");b.setAttribute("elname","dataRow");b.setAttribute("rowno","t::row_0");b.classList.add("subformRow","clearfix","zc-subform-header-container");b.style.display="none";Y.appendChild(b);T=b;Q=Y}$(T).append(this.constructSubformLabel());if(Z&&!O){$(document.getElementById("zc-component")).before(Q)}else{var X=this.getFormController().getView().getDOM().getFormContainer();X.insertBefore(Q,X.firstChild)}P.querySelector('[rowno="t::row_0"]').style.display="none";if(V&&!O){P.querySelector('[rowno="t::row_0"]').style.width=R-22+"px"}if(U&&!O){if(S){P.querySelector('[rowno="t::row_0"]').style.width=R-40-S+"px"}else{P.querySelector('[rowno="t::row_0"]').style.width=R-40+"px"}}if(O){P.querySelector('[rowno="t::row_0"]').style.width=R-40+"px"}setTimeout(function(){var h=[];var e=0;$(I.getField()).find('[elname="dataRow"]:first').find("label.form-label").each(function(o,n){var m=n.offsetWidth;e+=m;var j=m+"px !important";h.push(j)});$(P).find('[rowno="t::row_0"]:first').children("[subformname="+L.getActualLabelName()+"]:first").find("li").each(function(n,m){var j=m.getAttribute("style");var o="width:"+h[n];if(j){o=j.endsWith(";")?j+o:j+";"+o}m.setAttribute("style",o)});P.querySelector('[rowno="t::row_0"]').querySelector('[subformname="'+L.getActualLabelName()+'"]').style.width=(e+1)+"px"},1000);var W=P.offsetWidth;if(V&&!O){W=document.body.clientWidth}if(S===undefined){S=0}if(!Z){if(appMeta.APPTHEME===2||appMeta.APPTHEME===3||appMeta.APPTHEME===5){if(O&&!(c&&a)){S+=0}else{S-=12}}if(appMeta.APPTHEME===4){if(O&&!(c&&a)){S+=0}else{S+=17}}if(appMeta.APPTHEME===8||appMeta.APPTHEME===9){if(c){S+=10}else{if(!O){S+=9}}}if(appMeta.APPTHEME===6){if(!O){S-=6}if(c&&a){S-=6}}if(appMeta.APPTHEME===3){if(O&&!(c&&a)){S+=0}else{S-=30}}if(c&&(appMeta.APPTHEME===5)){if(a){S-=30}else{S+=20}}if(c&&(appMeta.APPTHEME===7)){if(!a){S+=15}}}if(this.getFormController().resetScrollWidth&&!Z){if(appMeta.APPTHEME===4||appMeta.APPTHEME===5||appMeta.APPTHEME===6){S-=S/2}else{S-=S}}if(U&&!O){T.style.left=-S/2+"px"}if(V&&!O){Q.style.width=(W-22-S)+"px"}else{if(O){Q.style.width=(R-40-S)+"px"}else{if(R>W){Q.style.width=(R-40-S)+"px"}else{if(!U){Q.style.width=Math.max(R,(W-40-S)+"px")}}}}}};this.bindSortable=function(){var O={placeholder:"dragHover",start:function(P,Q){var S=Q.item.attr("rowno"),R=L.getFirstRow()},update:function(P,Q){var T=Q.item.attr("rowno"),S=L.getFirstRow();var R=L.getRow(T);I.getView().reorderSubform(Q.item,L.renameRow)}};this.getView().bindSortable(O)};this.focus=function(Q,R){R=(R!=undefined)?R:L.getFirstFieldName();Q=(Q!=undefined)?Q:L.getFirstRow();var P=L.getSubformField(Q,R);var O=L.getFormModel().focusFirstField();if(P!=undefined&&!(P instanceof Array)&&O){P.focus()}};this.showError=function(O,P,R){if(P!=undefined&&R!=undefined){var Q=L.getSubformField(P,R);if(Q!=undefined){Q.showError(O)}}else{this.getView().showError(O)}};this.clear=function(){if(L.getCurrRows()){L.clearRows();C=F=L.getCurrRows();K=C+1;this.getView().clearRows();if(L.isFormulaExist()){this.getField().trigger("change")}}};this.clearError=function(){var R=L.getAllFields(),S=Object.keys(R),P=S.length,U={};for(key in R){var T=R[key].FIELDS,Q={};for(rowNo in T){var O=T[rowNo].CONTROLLER;if(O!=undefined){O.clearError()}}}this.getView().clearError()};this.getValue=function(S){var X=L.getAllFields(),V=Object.keys(X),Q=V.length,O={};var T=L.getSubformType()==Constants.POPUP_SUBFORM;for(key in X){var W=X[key].FIELDS,R={};for(rowNo in W){var U=W[rowNo].CONTROLLER;var P=U.getModel().getComponentType();if(U!=undefined&&(!T||(P!=FieldType.PLAIN_TEXT&&P!=FieldType.SECTION))){R[U.getModel().getActualLabelName()]=U.getValue(S)}}R["record::status"]=X[key].STATUS;if(X[key].ID!=undefined){R.ID=X[key].ID+""}O[key]=R}return JSON.stringify(O)};this.reset=function(){var P=L.getAllFields(),Q=Object.keys(P),O=Q.length;for(key in P){var R=P[key].FIELDS;for(rowNo in R){R[rowNo].CONTROLLER.reset()}}};this.createRow=function(R){F++;if(!R||!this.hasCurrentRow()){var O=L.getNullRowFields();I.setCurrRow("t::row_"+K,O,L.getNullRowData());L.addNewFields(H,O,K,L.getNullRowData())}var T=L.getVoidRow(),Q=(F===1),S=H;T=T.replace(/t::row_0/g,H);var P=G.createNewRow(H,T,Q);this.bindRow(P,Q,R);if(!L.isDeleteLinkVisible()){G.hideDeleteLink()}D.resizeInPage();K++;return S};this.getSubFormImgController=function(){return D.getSubfrmImgCntrlWithShowLoad()};this.triggerSubformImagePopup=function(O){D.triggerSubformImagePopup(O)};this.bindRow=function(Y,O,U,V){G.setRow(Y);var Q=this.initiateController();this.bindPermissions(Q);if(isMobileBrowser()){var b=[];var a=[];for(var Z=0,X=0,W=0;Z<Q.length;Z++){if(Q[Z].getModel().getFieldType()==FieldType.IMAGE){if(Q[Z].getModel().getCameraProperties().ISSHOWONLOAD){b[X]=Q[Z];X++}if(Q[Z].getModel().getCameraProperties().ISSUBMITAFTERSCAN){a[W]=Q[Z];W++}}}D.addSubfrmImgCntrlWithShowLoad(b);D.addSubfrmImgCntrlWithSmtAftScn(a);if(b.length>0){D.triggerSubformImagePopup(b[0])}}var T=D.getWorkflowController();if(!U){if(T!=undefined){T.bindOnUserInput(Q,this,H);var c=this.getClientWorkflows();for(var Z=0,S=c.length;Z<S;Z++){var R=c[Z];R.rowNo=H;T.executeTask(R)}}this.bindDeleteAction(this,H)}if(O){G.calibrateWidth(Y);G.updateFieldLableHeight(Y)}G.clearRow();if(O){G.hidePlaceHolder()}if(V!=undefined){for(controlrIndx in Q){var P=Q[controlrIndx].getModel();if(P.isLookup()&&P.isDynamicLookup()){P.clearChoices(false);P.lookupFirstFetchNeeded()}}I.setCurrRowData(V,T)}else{if(L.isFormulaExist()){this.getField().trigger("change")}}I.setCurrRow(undefined,undefined,undefined)};this.setCurrRowData=function(R,Q){for(var S=0,U=R.length;S<U;S++){var Y=R[S].fieldName;Y=(R[S].compType==FieldType.EXTERNAL_LINK_FIELD&&Y!=undefined&&((Y).lastIndexOf("_ID")==((Y).length-3)))?(Y).substr(0,(Y).length-3):Y;var W=I.getFieldController(M,Y);if(W!=undefined&&Y==W.ACTUALLABEL){var T=W.CONTROLLER;var P=T.getModel();var V=P.getComponentType();var O;if(P.isCompositeField()&&R[S].subFieldName!=null){T=T.getCompositeSubField(R[S].subFieldName);if(T!=undefined){O=Q.constructValue(T,R[S]);T.setValue(O,false)}}else{O=Q.constructValue(T,R[S]);O=(O!=undefined?O:"");var X=[FieldType.SINGLE_SELECT,FieldType.EXTERNAL_FIELD,FieldType.POPUP_SINGLE,FieldType.DROPDOWN,FieldType.INLINE_PICK_LIST,FieldType.LIST,FieldType.RADIO,FieldType.INLINE_RADIO,FieldType.CHECK_BOXES,FieldType.SYSTEM_LOOKUP];if(X.indexOf(V)!=-1){I.setSelect2CompValue(O,P,T)}else{T.setValue(O,false)}}}}};this.getFieldController=function(P,T){var R=P;for(var Q=0,O=R.length;Q<O;Q++){var S=R[Q];if(S.ACTUALLABEL==T){return S}}};this.initRow=function(){};this.insertRow=function(R){var P=R.fieldValue;var W=document.createDocumentFragment();var V=Object.keys(P).length;var T=K+V;var O=G.getDOM();if(L.isEmptyRow()){O.getInnerWrapper().empty();O.getModel().setEmptyRow(false)}for(var S=K;S<T;++S){W.appendChild(Q("t::row_"+S))}var U=O.getInnerWrapper();U=U[0];U.appendChild(W);if(!L.isDeleteLinkVisible()){G.hideDeleteLink()}D.resizeInPage();I.triggerFormHeightCalculation();function Q(X){var Z=L.getVoidRow();Z=Z.replace(/t::row_0/g,X);var Y=$(Z).attr("rowNo",X);return Y[0]}I.getView().getField().removeClass("zcPlacehldflow zc-placeholder-overflow");I.createDefaultRow(P)};this.setSelect2CompValue=function(U,R,O){if(R.isIntegrationField()){if(LIB._isNull(U)){U={}}R.setFieldValue(U);O.setDefaultValue()}else{var Q=U;if(Q instanceof Array){Q=[];var S=0;for(var P in U){if(U!=undefined&&R.hasChoice(U[P].id)){Q[S++]=U[P]}}}if(Q!=undefined&&((Q.length>0)||R.hasChoice(Q.id)||((R.isExternalField())&&Q.id))){if(R.isExternalField()&&Q!=""&&Q.id==-1){Q.id=null}R.setDefaultValue(Q)}else{if(!R.isOtherEnabled()){R.setDefaultValue("")}}if(R.isOtherEnabled()){if(Q!=undefined&&Q.id&&!R.hasChoice(Q.id)){R.setDefaultValue({id:Constants.OTHER_OPTION,text:i18n.otheroption});$((O.getField().parent())[0].querySelector('div[elname="othersinput"]')).show();var T=O.getView().getDOM();T.getOtherValueField().val(U.text)}else{if(Q==""){O.clearSelectedValues();$((O.getField().parent())[0].querySelector('div[elname="othersinput"]')).hide()}else{$((O.getField().parent())[0].querySelector('div[elname="othersinput"]')).hide()}}}}};this.destroyController=function(O){for(i=0,l=O.length;i<l;i++){O[i].CONTROLLER.destroy()}};this.initiateController=function(){function Y(h){var d={};for(var e in h){if(h.hasOwnProperty(e)){d[e]=h[e]}}return d}var W=M;var S=[];for(var V=0,T=W.length;V<T;V++){var R=W[V],P=L.getLabelName()+"."+H+"."+R.ACTUALLABEL;R.FIELDLABELNAME=P;R.ROWID=H;if(R.FIELDTYPE==FieldType.NAME||R.FIELDTYPE==FieldType.ADDRESS){var O=R.COMPOSITEFIELDS,b=[];for(U=0,len=O.length;U<len;U++){var a=Y(O[U]);a.FIELDLABELNAME=P+"."+a.ACTUALLABEL;b.push(a)}R.COMPOSITEFIELDS=b}if(R.ISLOOKUP&&!R.EXTMODULE){var c=L.getAvailableRows();var Q=c[0];var X=L.getRow(Q).FIELDS;for(var U=0;U<X.length;U++){if(R.ACTUALLABEL==X[U].ACTUALLABEL){if(X[U].CONTROLLER!=undefined){var Z=X[U].CONTROLLER.getModel();if(!Z.isDynamicLookup()){R.FIELDCHOICES=JSON.stringify(Z.getAllChoices().data);R.ISSATURATED=Z.getAllChoices().isSaturated}}}}}cont=Controller.FieldController.create({model:R,formController:this,data:B[R.ACTUALLABEL]});R.CONTROLLER=cont;S.push(cont)}return S};this.deleteRow=function(U,Q){F--;var T=L.isTopField(U),V=L.deleteFields(U);G.deleteRow(U,T);if(Q){G.deleteRow(N,L.isTopField(N))}if(V==0){G.createVoidRow();if(D.getWorkflowController()!=undefined){var S=this.getClientWorkflows();for(var R=0,P=S.length;R<P;R++){var O=S[R];this.executeWorkflow(O,true)}}}D.resizeInPage()};this.bindRowAction=function(){var O=this;$(O.getView().getAddLink()).click(function(){if(!O.getModel().hasMoreRows()){$.alert({msg:i18n.subformrowlimitreachedmsg});return false}O.getView().getField().removeClass("zcPlacehldflow zc-placeholder-overflow");O.createRow(false);var Q=D.getWorkflowController();if(Q!=undefined){Q.triggerRowAction(O)}D.recalculateFormHeight()});var P=O.getModel().getAvailableRows();for(rowInd in P){O.bindDeleteAction(O,P[rowInd])}};this.bindDeleteAction=function(P,O){$(P.getView().getDeleteLink(O)).click(function(R){var Q=D.getWorkflowController();if(Q!=undefined){Q.triggerDeleteAction(P,O)}P.deleteRow(O);R.preventDefault();D.recalculateFormHeight()})};this.hideAddLink=function(){this.getView().hideAddLink();L.setAddLinkVisiblity(false)};this.showAddLink=function(){this.getView().showAddLink();L.setAddLinkVisiblity(true)};this.isAddLinkVisible=function(){return L.isAddLinkVisible()};this.hideDeleteLink=function(){this.getView().hideDeleteLink();L.setDeleteLinkVisiblity(false);this.adjustWidth()};this.showDeleteLink=function(){this.getView().showDeleteLink();L.setDeleteLinkVisiblity(true);this.adjustWidth()};this.isDeleteLinkVisible=function(){return L.isDeleteLinkVisible()};this.collectData=function(){return D.collectData()};this.addActiveUploads=function(){D.addActiveUploads()};this.removeActiveUploads=function(){D.removeActiveUploads()};var A=[];this.getClientWorkflows=function(){return $.extend(true,[],A)};this.pushClientWorkflow=function(O){A.push(O);return $.extend(true,[],O)};this.executeWorkflow=function(O,Q){if(!(O.task==D.getWorkflowController().CONS.CLEAR||O.task==D.getWorkflowController().CONS.APPEND_VALUE)){if(!Q){O=this.pushClientWorkflow(O)}O=$.extend(true,{},O);var P=L.getAllFields();if(L.getCurrRows()==0){if(O.task==D.getWorkflowController().CONS.HIDE){$((this.getField())[0].querySelector("[name='"+this.getModel().getLabelName()+this.getEmptyRowKey()+O.fieldName+"']")).closest(".form-group").hide();setTimeout(function(){G.adjustWidth(N)},0)}else{if(O.task==D.getWorkflowController().CONS.SHOW){$((this.getField())[0].querySelector("[name='"+this.getModel().getLabelName()+this.getEmptyRowKey()+O.fieldName+"']")).closest(".form-group").show();setTimeout(function(){G.adjustWidth(N)},0)}}}for(key in P){O.rowNo=key;D.getWorkflowController().executeTask(O)}}};this.showSubform=function(){var Q=this.getFormController().getView().getDOM().getFormParentContainer().parentElement;if(this.getFormController().getModel().isPermaOrEmbed()){Q=Q.parentElement}var P=[];var O=0;$(I.getField()).find('[elname="dataRow"]:first').find("label.form-label").each(function(W,V){var U=V.offsetWidth;O+=U;var T=U+"px !important";P.push(T)});$(Q).find('[rowno="t::row_0"]:first').children("[subformname="+L.getActualLabelName()+"]:first").find("li").each(function(U,T){$(T).attr("style","width:"+P[U])});var R=Q.querySelector('[rowno="t::row_0"]');if(R){var S=R.querySelector('[subformname="'+L.getActualLabelName()+'"]');if(S){S.style.width=(O+1)+"px"}}};this.showField=function(){this.getView().showField(L.getClassName());if(L.getComponentType()===FieldType.SUB_FORM_GRID){this.showSubform()}L.setVisible(true);this.adjustWidth()};this.adjustWidth=function(){var O=L.getFirstRow();if(O!=undefined){G.adjustWidth(O)}else{G.adjustWidth(N)}};this.getChildRelation=function(){var P=D.getChildRelation();P.subFormAppName=L.getAppLinkName();P.childSubformField=L.getActualLabelName();P.isNewTypeSubform=L.isNewSubform();if(L.isNewSubform()){P["zc_childSubformlabelname_"+P.zc_lookupCount]=L.getActualLabelName();P.subFormLinkName=L.getFormLinkName()}else{P["zc_childformname_"+P.zc_lookupCount]=L.getRefFormLinkName();var O=L.getRefAppLinkName();if(O!=undefined&&O!=P.subFormAppName){P.subFormRefAppName=O;P.childAppIndex=P.zc_lookupCount}P.subFormLinkName=L.getRefFormLinkName()}return P};this.bindPermissions=function(T){var O=T,R=0,S=Object.keys(O),P=S.length;for(;R<P;++R){var Q=O[S[R]];if(this.isReadOnly()){Q.disableField()}}if(this.isReadOnly()){this.hideAddLink();this.hideDeleteLink()}};this.constructSubformLabel=function(){var Q="";var O=L.getNullRowFields();for(var P in O){if(O[P].FIELDISMANDATORY){Q=Q.concat("<li "+O[P].FIELDSTYLE+' val="'+O[P].ACTUALLABEL+'"><label>'+O[P].FIELDDISPLAYNAME+'</label><span class="fieldMandate">*</span></li>')}else{Q=Q.concat("<li "+O[P].FIELDSTYLE+' val="'+O[P].ACTUALLABEL+'"><label>'+O[P].FIELDDISPLAYNAME+"</label></li>")}}return'<div subformname="'+L.getActualLabelName()+'" class="zc-new-subform-header" style="display: none;"><ul class="zc-subform-header-row clearfix"> <li><label>&nbsp;</label></li>'+Q+"</ul> </div>"};this.init=function(){if(Object.keys(L.getAllFields()).length==0&&Object.keys(L.getNullRowFields()).length===0){return }var O=document.createDocumentFragment();var R=Object.keys(L.getAllFields());var Q=L.getCurrRows(),U=L.getDefaultRow();var V=R.map(function(W){return P(W)});for(var T=Q;T<U;++T){V.push(P("t::row_"+(T+1)))}V.forEach(function(W){O.appendChild(W)});var S=G.getDOM().getInnerWrapper();S=S[0];S.appendChild(O);D.resizeInPage();function P(W){var Y=L.getVoidRow();Y=Y.replace(/t::row_0/g,W);var X=$(Y).attr("rowNo",W);return X[0]}}});createPrototype(SubformController,FieldController.prototype,new BasicValidator());var PhoneNumberController=(function(A,B){FieldController.call(this,A,B);this.init=function(){fieldDOM=this.getView().getDOM();fieldDOM.getField().val(A.getDefaultValue())}});createPrototype(PhoneNumberController,FieldController.prototype,new BasicValidator());var currentExtField;function CRMLookupCallBack(){if(currentExtField!=undefined){currentExtField.callBack();currentExtField=undefined}}function SDPODLookupCallBack(){if(currentExtField!=undefined){currentExtField.callBack();currentExtField=undefined}}var ExternalController=(function(A,B){FieldController.call(this,A,B);this.externalWindow=function(){var C=(document.location.protocol=="https:")?"https://":"http://";this.getView().openExternalWindow(C+A.getExternalURL());currentExtField=this};this.callBack=function(){this.getField().trigger("onuserinput")}});createPrototype(ExternalController,FieldController.prototype,new BasicValidator());var DateTimeController=(function(A,B){FieldController.call(this,A,B);this.initCalender=function(){this.getView().setupCalender(A.getDefaultValue(),A.getTimeInterval(),A.getAllowedDays())}});createPrototype(DateTimeController,FieldController.prototype,new BasicValidator());var TimeController=(function(A,B){FieldController.call(this,A,B);this.initTime=function(){this.getView().setupCalender(A.getDefaultValue(),A.getTimeInterval())}});createPrototype(TimeController,FieldController.prototype,new BasicValidator());var SignatureController=(function(A,B){FieldController.call(this,A,B);this.init=function(){var D=this.getView().getDOM().getSignature(),C=false;if(B.getModel().getAccessType()==3){if(A.getDefaultValue()!==""){$(D).attr("isEdit",true);this.getView().getDOM().getSignatureContainer().attr("isHide",true);this.getView().getDOM().getSignatureTextarea().val("nochange,"+A.getDefaultValue());this.getView().getDOM().getEditEle().append(A.getDefaultValue());this.getView().getDOM().getEditEle().show();this.getView().getDOM().getSignatureContainer().find(".signature-clear span").show()}}}});createPrototype(SignatureController,FieldController.prototype,new BasicValidator());var SectionController=function(A,B){FieldController.call(this,A,B);this.init=function(){}};createPrototype(SectionController,FieldController.prototype,new BasicValidator());var IntegrationController=(function(C,F){FieldController.call(this,C,F);var B=this;var A=this.getView();var E=A.getDOM();var D=C;this.init=function(){A.constructOptionsDOM();A.hideOptionsDOM();B.setDefaultValue();D.setSearchQuery(false);D.setSaturation(false);D.setSearchSaturation(false);D.setEmptySearch(false)};this.preDataController=function(){var H,G;if(D.isSearchQuery()){if(!D.isEmptySearch()){G=D.getSearchCount()?D.getSearchCount():0;H=D.getSearchInputs();if(!D.isSearchSaturated()){B.fetchData(H,G);return false}B.postResponseHandler()}else{A.showOptionsLayout();D.setSearchQuery(false);B.postResponseHandler()}}else{G=D.getRecordCount()?D.getRecordCount():0;displayCount=D.getCurrentDisplayCount()?D.getCurrentDisplayCount():0;A.showSpinner();if(displayCount<G){B.fetchFromCache(displayCount,G);D.setInProgress(false);B.postResponseHandler()}else{if(!D.isSaturated()&&G<=displayCount){B.fetchData(H,G)}else{D.setInProgress(false);A.hideSpinner()}}}};this.fetchData=function(N,L){var K=this.getURL().getRelDataURL();var M={};var H="";var I=false;var J=L;M.searchValues=N?JSON.stringify(N):JSON.stringify(new Array());M.noOfRecsInCache=L;I=L>0?false:true;if(D.isSubformField()){M.subformName=D.getFormModel().getLabelName()}var G=D.isSubformField()?D.getFormModel().getFormModel():D.getFormModel();M.formAccessType=G.getAccessType();if(B.getChildRelation()!=""){M=$.extend(M,B.getChildRelation())}if(G.hasPrivateLink()&&!isNull(G.getPrivateLink())){M.privatelink=G.getPrivateLink()}$.ajax({url:K,method:"GET",beforeSend:function(P,O){if(D.getInProgress()&&!D.isSearchQuery()){P.abort()}D.setInProgress(true)},data:M,success:function(O){if(O.count>0){if(!D.isSearchQuery()){var P=D.getRecordCount()?D.getRecordCount()+O.count:O.count;D.setRecordCount(P);D.addFieldChoices(O.data);D.setSaturation(O.isSaturated);if(D.isActive()){A.constructOptions(E.getOptionsLayout(),O.data[0],false);D.setCurrentDisplayCount(P)}else{return }A.showOptionsLayout()}else{var P=D.getSearchCount()?D.getSearchCount()+O.count:O.count;D.setSearchCount(P);D.addSearchChoices(O.data);D.setSearchSaturation(O.isSaturated);if(D.isActive()){A.constructOptions(E.getSearchLayout(),O.data[0],P<200)}else{return }A.showSearchLayout()}}else{if(O.count==0&&(J==0||J==undefined)){A.showDefaultLayout();if(!D.isSearchQuery()){A.disableSearchBoxes()}E.getMessageContainer().html(i18n.integrationnomatchfound)}}B.postResponseHandler(I)}})};this.fetchFromCache=function(K,J){var N=D.getFieldChoices();var M=K+200<=J?K+200:J;var I=Object.keys(N);var G={};var L;for(var H=K;H<M;H++){L=I[H];G[L]=N[L]}D.setCurrentDisplayCount(M);A.constructOptions(E.getOptionsLayout(),G,false);A.showOptionsLayout()};this.postResponseHandler=function(G){D.setInProgress(false);A.hideSpinner();if(!(D.isSearchQuery()||D.isEmptySearch())){A.searchBoxFocusHanlder()}if(G){var H=E.getHighlightedRow();H.removeClass("combined-lookup-row-highlighted");A.firstRowFocus()}A.calculatePosition()};this.initiateSearchQuery=function(H){var G=B.validateSearchData();if(G!=false){D.setSearchQuery(true);D.setSearchInputs(G);D.setSearchSaturation(false)}B.preDataController()};this.validateSearchInputsAndBindTooltip=function(){var N=A.getSearchValues();var K=E.getSearchTriggerInputElement();var M=K.value;var H;var G=true;if(M.length<2&&M!=""){A.bindTooltip(i18n.minimumcharrequiredsearch,K,true);G=false;H=K}for(var I=0;I<N.length;I++){var J=E.getSearchBoxes()[I];if(K===J){continue}var L=N[I].value;if(L.length<2&&L!=""){A.bindTooltip(i18n.minimumcharrequiredsearch,J,true);G=false;H=H==undefined?J:H}}$(H).focus();return G};this.validateSearchData=function(){var P=A.getSearchValues();var G=D.getColumnHeaders();var I=true;var J;var M,O=[];if(!B.validateSearchInputsAndBindTooltip()){return false}for(var L=0;L<P.length;L++){var H=P[L].value;O.push(H);var K=E.getSearchBoxes()[L];J=J!=undefined?(P[L].value==""&&J):P[L].value=="";var N=G[L];if(N.isSearchable&&N.supportedOperators[0]!=undefined&&!J){var Q;if((Q=D.getStringForOperator(N.supportedOperators[0]))&&H!=""){A.bindTooltip(N.displayName+" "+Q+' "'+H+'"',K,false)}}}M=D.getSearchInputs().map(function(R){return R.value});if(I){A.showSpinner()}else{A.hideSpinner()}D.setEmptySearch(J);if(O.toString()==M.toString()){D.setEmptySearch(true);D.setSearchQuery(true);A.hideSpinner();return false}else{D.clearSearchChoices();D.setSearchCount(0);E.getSearchLayout().empty()}D.setSearchInputs(P);return I?P:I};this.setValueForField=function(G){A.hideOptionsDOM();var H=D.isSearchQuery()?D.getSearchChoice(G.id):D.getFieldChoice(G.id);B.setFieldValue(H);B.reset(false)};this.setFieldValue=function(H){if(LIB._isNull(H)){H={}}var I=D.getDefaultValue()?D.getDefaultValue().id:D.getDefaultValue();var G=H?H.id:H;D.setFieldValue(H);B.setDefaultValue();A.trigger("onuserinput");if(C.isFormulaExist()&&I!=G){this.getView().trigger("triggerformula")}};this.setDefaultValue=function(){if(D.getDefaultValue()){var G=D.getDefaultValue();if(!G.id){this.clearData()}else{this.getField().attr("field-id",G.id);this.getField().val(G.text);if(A.isFloatLabelAlignment()){E.getFieldParentGroup().addClass("zc-label-float")}}}if(this.getField().attr("field-id")){A.showDeselector();A.hidePlaceholder()}else{A.hideDeselector();A.showPlaceholder()}};this.getValue=function(){var G=jQuery.extend({},D.getFieldValue());if(G){G.text=G.actualText;delete G.actualText;return JSON.stringify(G)}};this.removeValue=function(){this.clearData();this.setFieldValue({})};this.clear=function(){this.removeValue()};this.clearData=function(){this.getField().val("");this.getField().removeAttr("field-id");A.showPlaceholder();if(A.isFloatLabelAlignment()){E.getFieldParentGroup().removeClass("zc-label-float")}};this.getChildRelation=function(){var G=F.getChildRelation();G["zc_childlabelname_"+G.zc_lookupCount]=D.getActualLabelName();G.isFromSubForm=D.isSubformField();G.childFieldLabelName=D.getActualLabelName();if(G.isFromSubForm==false){G.isNewTypeSubform=false}return G};this.reset=function(H){E.getSearchOptionsTable().scrollTop(0);D.setSearchQuery(false);D.setSearchInputs([]);D.setCurrentDisplayCount(0);if(H){var J=E.getCurrentLayout().find("tbody");J.empty()}if(!H){var I=E.getSearchBoxes();for(var G=0;G<I.length;G++){I[G].value=""}}}});createPrototype(IntegrationController,FieldController.prototype,new BasicValidator());function WorkflowController(A){this.formController=A;window.tester=A;this.active=false;this.isSetTask=false;this.isSelectTask=false;this.FORMACCESSTYPE={ADD:1,ADD_REPORT:2,EDIT:3,BULK_EDIT:4,ADD_LOOKUP:5};this.WFTYPE={ONLOAD_ADD:1,ONLOAD_EDIT:2,ONUSER_INPUT:3,ONADD_ROW:4,ONDELETE_ROW:5,ONUSER_INPUT_SUBFORM:6,FORMULA:7,BUTTON_CLICK:8};this.CONS={RELOAD:1,CLEAR:9,HIDE:10,SHOW:11,SET_VALUE:12,INSERT_ROW:13,ENABLE:14,DISABLE:15,PRINT_TASK:71,OPEN_URL:280,SELECT:1001,DESELECT:1002,SELECTALL:1003,DESELECTALL:1004,APPEND_VALUE:1005,RESET_LOAD_LOOKUP_TASK:1006,ERROR_TASK:1007,ALERT:1302,SUCCESSMSG:2020};this.getIsSetTask=function(){return this.isSetTask};this.getIsSelectTask=function(){return this.isSelectTask};this.getRequestURI=function(){return"/"+GlobalUrls.getAppUrlFragment(this.formController.getModel().getAppLinkName())+"/workflow/"+this.formController.getModel().getFormLinkName()};this.sendRequest=function(D,C){if(D.actiontype==this.WFTYPE.BUTTON_CLICK){A.disableButtons()}else{if(C!=undefined){A.addPendingTask(C.getLabelName())}}var B=this;$.ajax({url:B.getRequestURI(),method:"POST",beforeSend:function(E){B.active=true;B.showPreloader(D.actiontype,C)},data:D,success:function(E){if(D.actiontype!=B.WFTYPE.BUTTON_CLICK&&C!=undefined){B.formController.removePendingTask(C.getLabelName())}B.active=false;B.hidePreloader(D.actiontype,C);B.handler(E,D);if(D.actiontype==B.WFTYPE.BUTTON_CLICK){A.enableButtons()}else{if(A.getView().getDOM().getAutoSubmitBtn().length&&!A.getPendingTaskFields().length){D={buttonname:A.getView().getDOM().getAutoSubmitBtn().attr("name")};B.trigger(B.WFTYPE.BUTTON_CLICK,D);A.getView().getDOM().getAutoSubmitBtn().removeAttr("autosubmit")}}},error:function(G,E,F){if(D.actiontype==B.WFTYPE.BUTTON_CLICK){A.enableButtons()}}})};this.isActive=function(){return this.active};this.showPreloader=function(E,G){var D=E==this.WFTYPE.BUTTON_CLICK;var B=E==this.WFTYPE.ONLOAD_ADD||E==this.WFTYPE.ONLOAD_EDIT;var F=!(this.formController.getModel().isPerma()||this.formController.getModel().isEmbed()||this.formController.isPage||this.formController.getView().isPopup());var C=E==this.WFTYPE.ONUSER_INPUT||E==this.WFTYPE.FORMULA||E==this.WFTYPE.ONUSER_INPUT_SUBFORM;if(C){G.showLoader();return }if(B){this.formController.lockForm()}if(!F){this.formController.showProgress()}if(D){LIB._startLoading()}};this.hidePreloader=function(E,G){var D=E==this.WFTYPE.BUTTON_CLICK;var B=E==this.WFTYPE.ONLOAD_ADD||E==this.WFTYPE.ONLOAD_EDIT;var F=!(this.formController.getModel().isPerma()||this.formController.getModel().isEmbed()||this.formController.isPage||this.formController.getView().isPopup());var C=E==this.WFTYPE.ONUSER_INPUT||E==this.WFTYPE.FORMULA||E==this.WFTYPE.ONUSER_INPUT_SUBFORM;if(C){G.hideLoader();return }if(B){this.formController.unlockForm()}if(!F){this.formController.hideProgress()}if(D){LIB._stopLoading()}};this.addListener=function(){};this.executeTask=function(F,E){var K=this;var P;if((F.compType==12||F.compType==13||F.compType==29)&&(!F.fieldValue)&&(F.task==this.CONS.SET_VALUE||this.CONS.APPEND_VALUE)){F.fieldValue=""}if(F.subFormName!=null){var R=K.formController.getFieldController(F.subFormName);if(F.rowNo!=undefined){F.fieldName=(F.compType==FieldType.EXTERNAL_LINK_FIELD&&F.fieldName!=undefined&&((F.fieldName).lastIndexOf("_ID")==((F.fieldName).length-3)))?(F.fieldName).substr(0,(F.fieldName).length-3):F.fieldName;P=R.getModel().getSubformField(F.rowNo,F.fieldName);if(P instanceof Array){P=P[0]}}else{if(R){R.executeWorkflow(F)}return }}else{F.fieldName=(F.compType==FieldType.EXTERNAL_LINK_FIELD&&F.fieldName!=undefined&&((F.fieldName).lastIndexOf("_ID")==((F.fieldName).length-3)))?(F.fieldName).substr(0,(F.fieldName).length-3):F.fieldName;P=K.formController.getFieldController(F.fieldName)}if(P==undefined){var I=[this.CONS.CLEAR,this.CONS.HIDE,this.CONS.SHOW,this.CONS.ENABLE,this.CONS.DISABLE,this.CONS.SELECTALL,this.CONS.DESELECTALL,this.CONS.SET_VALUE,this.CONS.SELECT,this.CONS.DESELECT,this.CONS.APPEND_VALUE];if(I.indexOf(F.task)!=-1){return }}if(P!=undefined&&P.getModel().isCompositeField()&&F.subFieldName!=null){P=P.getCompositeSubField(F.subFieldName);if(P==undefined){return }}switch(F.task){case this.CONS.RELOAD:K.formController.resetForm();break;case this.CONS.SUCCESSMSG:$.successMsg(F.successMsg,3000);break;case this.CONS.CLEAR:P.clear();break;case this.CONS.HIDE:P.hideField();if(F.subFormName!=null){var R=K.formController.getFieldController(F.subFormName);setTimeout(function(){R.adjustWidth()},0)}break;case this.CONS.SHOW:P.showField();if(F.subFormName!=null){var R=K.formController.getFieldController(F.subFormName);setTimeout(function(){R.adjustWidth()},0)}break;case this.CONS.ENABLE:P.enableField();break;case this.CONS.DISABLE:P.disableField();break;case this.CONS.SELECTALL:P.selectAll();break;case this.CONS.DESELECTALL:this.isSetTask=true;P.deselectAll();break;case this.CONS.ALERT:F.alertValue=F.alertValue.replace(/\n/g,"<br>").replace(/\\r/g,"");$.alert({msg:F.alertValue});K.formController.handlePopupPositionForMobile();break;case this.CONS.SET_VALUE:this.isSetTask=true;this.isSelectTask=false;var O=this.constructValue(P,F);P.setFieldValue(O!=undefined?O:"",F);break;case this.CONS.SELECT:this.isSetTask=false;this.isSelectTask=true;var H=this.constructValue(P,F);if(P.getModel().isSingleSelect()){H=H[0]}else{if((P.getModel().getComponentType()==FieldType.LIST)||P.getModel().isLookup()){var J=P.getModel().getDefaultValue();if(J!=undefined&&J.length>0&&H.length>0){$.merge(J,H);H=J}}}P.setFieldValue(H);break;case this.CONS.DESELECT:P.deselectValue(this.constructValue(P,F));break;case this.CONS.APPEND_VALUE:P.appendValue(this.constructValue(P,F),E!=this.WFTYPE.FORMULA);break;case this.CONS.INSERT_ROW:P.insertRow(F);break;case this.CONS.OPEN_URL:urlString=F.urlString.trim();var M=urlString.toLowerCase();if(!ZCSecurity.isURLXSSVulnerable(urlString)){if(M.indexOf("#script:")==0){if(!closeScriptHandle(M)){window.open(urlString,"_self")}}else{LIB._openURL(F.urlString,F.windowType,F.windowSpecificArgument)}}break;case this.CONS.PRINT_TASK:var Q=[{HeaderMsg:F.headerMsg,UserMsgs:F.infoValue}];K.formController.infoMsgHandler(Q);break;case this.CONS.ERROR_TASK:var L=0;for(var G=0;G<F.errors.length;G++){var B=F.errors[G];for(var C in B){if(C=="zc_captcha_txt"){K.formController.showCaptchaError(B[C]);K.formController.resetCaptcha();continue}var N=K.formController.getFieldController(C);N.showError(B[C]);if(L==0){N.focus()}}L++}break;case this.CONS.RESET_LOAD_LOOKUP_TASK:P.resetLoadLookup();break;default:var D=F.message;if(D!=""&&D!=undefined){D=D.replace(new RegExp("@@@SQ@@@","g"),"'");if(E==K.WFTYPE.ONLOAD_ADD||E==K.WFTYPE.ONLOAD_EDIT){A.getView().closeForm("")}$.alert({msg:D})}}};this.handler=function(B,D){if(D.actiontype==this.WFTYPE.BUTTON_CLICK&&B.length==0&&this.formController.getButtonController(D.buttonname).getModel().getButtonType()!="button"){this.formController.resetForm()}for(var C=0;C<B.length;C++){this.executeTask(B[C],D.actiontype)}};this.onUserInput=function(F,E,D){var B=this;var C={};if(!LIB._isNull(E)){C.fieldname=E.getModel().getActualLabelName();C.subformfieldname=F.getModel().getActualLabelName();C.rowseqid=D;_wftype=B.WFTYPE.ONUSER_INPUT_SUBFORM}else{C.fieldname=F.getModel().getActualLabelName();_wftype=B.WFTYPE.ONUSER_INPUT}if(F.getModel().isOnChangeExist()){var G=function(I,H,J){$(I.getField()).bind("onuserinput",function(){var K=I.getModel().getComponentType();if(!((K==Fields.NUMBER||K==Fields.PERCENTAGE||K==Fields.CURRENCY)&&(isNaN(I.getValue())))){B.trigger(H,J,I)}})}(F,_wftype,C)}};this.triggerFormulaAction=function(D,C){var B=this;if(D.getModel().isFormulaExist()){var E=function(G,F,H){$(G.getField()).unbind("formulacalc").bind("formulacalc",function(I){B.trigger(F,H,G);I.stopPropagation()})}(D,B.WFTYPE.FORMULA,C)}};this.triggerRowAction=function(D){var B=this;if(D.getModel().hasOnAddRow()){var C={fieldname:D.getModel().getActualLabelName(),rowseqid:"t::row_"+(D.getNextSeqNo()-1)};B.trigger(B.WFTYPE.ONADD_ROW,C)}};this.triggerDeleteAction=function(E,D){var B=this;if(E.getModel().hasOnDeleteRow()){var C={fieldname:E.getModel().getActualLabelName(),rowseqid:D};B.trigger(B.WFTYPE.ONDELETE_ROW,C)}};this.bindOnUserInput=function(H,E,D){var C=this;for(k in H){var G=H[k];if(G.getModel().getComponentType()==99){var I=G.getModel().getAllFields();for(f in I){var B=I[f].FIELDS;var F=[];for(ff in B){if(B[ff].CONTROLLER!=undefined){F.push(B[ff].CONTROLLER)}}C.bindOnUserInput(F,G,f)}}else{C.onUserInput(G,E,D)}}};this.TriggerOnLoad=function(){var B=1;switch(this.formController.getModel().getAccessType()){case this.FORMACCESSTYPE.ADD:B=this.WFTYPE.ONLOAD_ADD;break;case this.FORMACCESSTYPE.EDIT:B=this.WFTYPE.ONLOAD_EDIT;break}this.trigger(B)};this.trigger=function(D,E,B){var C=this.constructFormData(D);C.actiontype=D;C=$.extend(C,E);this.sendRequest(C,B)};this.constructFormData=function(C){var D=[];this.formController.getModel().setTriggeredControllerType("workFlowController");var B=this.formController.collectData(C!=this.WFTYPE.BUTTON_CLICK,(C==this.WFTYPE.FORMULA?Constants.REQUEST_TYPE.FORMULA:Constants.REQUEST_TYPE.WORKFLOW));B.formAccessType=B.recType;for(i in D){delete B[D[i]]}return B};this.constructValue=function(G,C){var J=[FieldType.SINGLE_SELECT,FieldType.EXTERNAL_FIELD,FieldType.POPUP_SINGLE,FieldType.DROPDOWN,FieldType.INLINE_PICK_LIST,FieldType.LIST,FieldType.RADIO,FieldType.INLINE_RADIO,FieldType.CHECK_BOXES,FieldType.SYSTEM_LOOKUP];var E=G.getModel().getComponentType();var I;if(J.indexOf(E)!=-1){if(C.fieldValue instanceof Array){I=[];for(i in C.fieldValue){var K;if(G.getModel().isLookup()){K=(C.combinedValue!=undefined)?C.combinedValue[i]:C.fieldValue[i]}else{K=((!G.getModel().isIntegrationField()&&G.getModel().isTranslatedField())?G.getTranslatedTextFromId(G.getModel().getChoices(""),C.fieldValue[i]):C.fieldValue[i])}if(K!=undefined){I.push({id:C.fieldValue[i],text:K})}}}else{if(G.getModel().getGMAPKEY()==="country"){var L=Constants.COUNTRY_MAP[C.fieldValue.toLowerCase()];if(L===undefined){L=Constants.INVERTED_COUNTRY_MAP[C.fieldValue.toLowerCase()];I={id:L!=undefined?L:C.fieldValue,text:C.fieldValue}}else{I={id:C.fieldValue.toLowerCase(),text:L}}}else{if(E==FieldType.EXTERNAL_FIELD){if(C.compType==FieldType.EXTERNAL_LINK_FIELD){G.getModel().constructId(C.fieldValue)}else{G.getModel().constructText(C.fieldValue)}var D=G.getModel().getConstructedVal();if(D.text!=undefined){D.id=(D.id==undefined||!D.id)?"-1":D.id;I=D}}else{var K;if(G.getModel().isLookup()){K=(C.combinedValue!=undefined)?C.combinedValue:C.fieldValue}else{K=((!G.getModel().isIntegrationField()&&G.getModel().isTranslatedField())?G.getTranslatedTextFromId(G.getModel().getChoices(""),C.fieldValue):C.fieldValue)}if(K!=undefined&&C.fieldValue!=undefined&&C.fieldValue!=""&&K!=""){I={id:C.fieldValue,text:K}}if(G.getModel().isIntegrationField()&&C.FIELDVALUE!=undefined){if(C.FIELDVALUE.actualText!=undefined&&K!=""){I=C.FIELDVALUE}}}}}}else{if(E===FieldType.CURRENCY&&C.fieldValue!=undefined&&C.fieldValue!=""&&G.getModel().getValueFormat()===FormatConstants.DOTCOMMA){I=C.fieldValue.replace(".",",")}else{if(E==FieldType.TIME||E==FieldType.DATE_TIME){var H=G.getModel().is24HrFormat();var F=G.getModel().isShowSecondsEnabled();I=C.fieldValue;if(!F){var B=I.split(":");if(B.length==3){I=B[0]+":"+B[1]+B[2].substr(2,B[2].length)}}}else{I=C.fieldValue}}}return I}}WorkflowController.prototype.execute=function(){var A=this;A.bindOnUserInput(A.formController.getFormFields());if(A.formController.getModel().hasOnLoad()){A.TriggerOnLoad()}};function AutomationController(B,A){A=JSON.parse(A);this.formController=B;this.formRules=A;this.DUMMY_FIELD="_zc_Dummy_NullCritVar";this.DUMMY_FIELD_CONTROLLER=new FieldController(new FieldModel({},this.formController.getModel()),this.formController);this.TASK_TYPE={HIDE_FIELDS:1,DISABLE_FIELDS:2,ENABLE_FIELDS:3,SHOW_FIELDS:4,HIDE_SUBFORM_ADD_ENTRY:9,SHOW_SUBFORM_ADD_ENTRY:10,HIDE_SUBFORM_DELETE_ENTRY:11,SHOW_SUBFORM_DELETE_ENTRY:12,SET_FIELD_VALUE:14};this.mapFields=function(C,I){var H=this.formController.getFieldController(C);if(C.indexOf(".")!==-1){var F=C.split(".")[0];H=this.formController.getFieldController(F)}if(I.indexOf(".")!==-1){var F=I.split(".")[0];var J=I.split(".")[1];af=this.formController.getFieldController(F);af=af.getCompositeSubField(J)}else{af=this.formController.getFieldController(I)}if(af==undefined){af=this.formController.getButtonController(I)}if(C==this.DUMMY_FIELD){H=this.DUMMY_FIELD_CONTROLLER}if(H===undefined||af===undefined){return }if(!H.hasActionField(af)){H.setActionField(af)}for(var E in af.getActionFields()){H.setActionField(af.getActionFields()[E])}for(var D in this.formController.getFormFields()){var G=this.formController.getFieldController(D);if(G.hasActionField(H)){G.setActionField(af)}}};this.setFieldCriteria=function(F,C,E){var D=this.formController.getFieldController(F);if(D==undefined){D=this.formController.getButtonController(F)}if(E===undefined||D===undefined){return false}switch(C){case this.TASK_TYPE.HIDE_FIELDS:D.setCriteria("hide",E);break;case this.TASK_TYPE.DISABLE_FIELDS:D.setCriteria("disable",E);break;case this.TASK_TYPE.ENABLE_FIELDS:D.setCriteria("enable",E);break;case this.TASK_TYPE.SHOW_FIELDS:D.setCriteria("show",E);break;case this.TASK_TYPE.HIDE_SUBFORM_ADD_ENTRY:D.setCriteria("hidesubformaddentry",E);break;case this.TASK_TYPE.SHOW_SUBFORM_ADD_ENTRY:D.setCriteria("showsubformaddentry",E);break;case this.TASK_TYPE.HIDE_SUBFORM_DELETE_ENTRY:D.setCriteria("hidesubformdelentry",E);break;case this.TASK_TYPE.SHOW_SUBFORM_DELETE_ENTRY:D.setCriteria("showsubformdelentry",E);break;case this.TASK_TYPE.SET_FIELD_VALUE:D.setCriteria("setfieldvalue",E);break}};this.evaluateCondition=function(F){var D=this;var E=F.replace(/is null/g,'== ""').replace(/is not null/g,'!= ""').replace(/is today/g,"in this 1 days").replace(/is yesterday/g,"in last 1 days").replace(/is tomorrow/g,"in next 1 days").replace(/ (in) (this|next|last) (week|month|year)/g," $1 $2 1 $3s").replace(/ (in) (this|next|last) (\d+) (days|weeks|months|years)/g,'.$1$2($3, "$4")').replace(/ in (\d+) (days|weeks|months|years) ago/g,'.ago($1, "$2")');var C=jsep(E);_getTreeValue=function(G){var J=G.type;var L;switch(J){case"Literal":if(typeof (G.value)==="number"&&G.raw.length>16){L=G.raw}else{L=G.value}break;case"Identifier":var I=D.formController.getFieldController(G.name);L=(I===undefined||!I.isAccessible(true)||!I.isVisible(true))?"":I.getValue();if(I!==undefined){var K=I.getField();if(K[0].type==="checkbox"){if(L=="zc_checked"){L=true}else{if(L=="zc_unchecked"){L=false}}}}break;case"MemberExpression":if(G.object.name==="zoho"){if(G.property.name==="currentdate"){L=getCurrentDate()}else{if(G.property.name==="currenttime"){L=getCurrentTime()}else{L=D.formController.getModel().getZohoVars()[G.property.name]}}}else{var I=D.formController.getFieldController(G.object.name);if(I!==undefined&&I.getModel().isCompositeField()){var H=I.getCompositeSubField(G.property.name);L=(H===undefined||!H.isAccessible(true)||!I.isVisible(true))?"":H.getValue()}else{L=""}}break}return L!==undefined&&typeof (L)!=="number"?L.toString():L};_evaluateCriteira=function(V){var J=V.operator;var K=V.type;if(K==="LogicalExpression"){switch(J){case"&&":return _evaluateCriteira(V.left)&&_evaluateCriteira(V.right);case"||":return _evaluateCriteira(V.left)||_evaluateCriteira(V.right);default:return false}}else{if(K==="BinaryExpression"){var H=_getTreeValue(V.left);var O=_getTreeValue(V.right);var M=V.left.type!="MemberExpression"?V.left.name:V.left.object.name;var I="",T="",U=false,G=false;var L=D.formController.getFieldController(M).getModel().getComponentType();if(L==FieldType.DATE||L==FieldType.DATE_TIME||L==FieldType.TIME){if(L==FieldType.TIME){H=((H==undefined||H.trim()=="")?H:new moment().format(ZCGlobal.uiDateFormate)+" "+H);O=((O==undefined||O.trim()=="")?O:new moment().format(ZCGlobal.uiDateFormate)+" "+O)}var I=new Date(Date.parse(H.replace(/-/g," "),ZCGlobal.uiDateFormate));var T=new Date(Date.parse(O.replace(/-/g," "),ZCGlobal.uiDateFormate));U=true;if(H==""||O==""){G=true}}if(typeof (O)==="number"){if(!$.isNumeric(H)){return false}if(H==parseInt(H)){H=parseInt(H)}else{H=parseFloat(H)}}switch(J){case"==":if(U){if(!G){return(I-T)===0}else{return(H==""&&O=="")}}return H===O;case"!=":if(U){if(!G){return(I-T)!==0}else{return !(H==""&&O=="")}}return H!==O;case">":if(U&&!G){return I>T}else{if(U){return false}}return H>O;case"<":if(U&&!G){return I<T}else{if(U){return false}}return H<O;case">=":return H>=O;case"<=":return H<=O;default:return false}}else{if(K==="CallExpression"){var P=V.callee.property.name;var N=_getTreeValue(V.callee.object);var S=_getTreeValue(V.arguments[0]);var R=null;if(V.arguments.length==2){R=_getTreeValue(V.arguments[1])}if(N===undefined){return false}switch(P){case"contains":return N.indexOf(S)!==-1;case"startsWith":return N.indexOf(S)===0;case"endsWith":return N.indexOf(S,N.length-S.length)!==-1;case"before":return new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))<new Date(Date.parse(S.replace(/-/g," "),ZCGlobal.uiDateFormate));case"after":return new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))>new Date(Date.parse(S.replace(/-/g," "),ZCGlobal.uiDateFormate));case"inlast":return(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))<new moment().startOf(R))&&(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate)).getTime()>new moment().subtract(S+1,R).endOf(R));case"innext":return(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))>new moment().endOf(R))&&(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))<new moment().add(S+1,R).startOf(R));case"inthis":return(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))>=new moment().startOf(R))&&(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))<=new moment().endOf(R));case"ago":return(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))>=new moment().subtract(S,R).startOf(R))&&(new Date(Date.parse(N.replace(/-/g," "),ZCGlobal.uiDateFormate))<=new moment().subtract(S,R).endOf(R));default:return false}}else{if(K==="UnaryExpression"){return !_evaluateCriteira(V.argument)}else{if(K==="Identifier"){var Q=_getTreeValue(V);if(typeof (Q)==="string"){Q=Q==="zc_checked"||Q==="true"}return Q}else{if(K==="Literal"){return V.value}}}}}}};return _evaluateCriteira(C)};this.event=function(Q){var M=this;var E=Q.getActionFields();for(var P in E){var K=E[P];if(K.getCriteria().hide!==undefined||K.getCriteria().show!==undefined){var H=undefined;var V=undefined;if(K.getCriteria().hide!==undefined){H=M.evaluateCondition(K.getCriteria().hide)}if(K.getCriteria().show!==undefined){V=M.evaluateCondition(K.getCriteria().show)}H=H===undefined?true:H;V=V===undefined?false:V;var Q=!H&&V?true:(H&&!V?false:K.isVisible());if(Q){K.showField()}else{K.hideField()}}if(K.getCriteria().disable!==undefined||K.getCriteria().enable!==undefined){var S,G;if(K.getCriteria().disable!==undefined){S=M.evaluateCondition(K.getCriteria().disable)}if(K.getCriteria().enable!==undefined){G=M.evaluateCondition(K.getCriteria().enable)}S=S===undefined?true:S;G=G===undefined?false:G;var Q=!S&&G?true:(S&&!G?false:K.isAccessible());if(Q){K.enableField()}else{K.disableField()}}if(K.getCriteria().hidesubformaddentry!==undefined||K.getCriteria().showsubformaddentry!==undefined){var L,D;if(K.getCriteria().hidesubformaddentry!==undefined){L=M.evaluateCondition(K.getCriteria().hidesubformaddentry)}if(K.getCriteria().showsubformaddentry!==undefined){D=M.evaluateCondition(K.getCriteria().showsubformaddentry)}if(L===undefined&&D!=undefined){if(D){K.showAddLink()}else{K.hideAddLink()}}else{L=L===undefined?true:L;D=D===undefined?false:D;var Q=L&&!D?true:(!L&&D?false:(!L&&!D?false:K.isAddLinkVisible()));if(Q){K.hideAddLink()}else{K.showAddLink()}}}if(K.getCriteria().hidesubformdelentry!==undefined||K.getCriteria().showsubformdelentry!==undefined){var C,I;if(K.getCriteria().hidesubformdelentry!==undefined){I=M.evaluateCondition(K.getCriteria().hidesubformdelentry)}if(K.getCriteria().showsubformdelentry!==undefined){C=M.evaluateCondition(K.getCriteria().showsubformdelentry)}if(I===undefined&&C!=undefined){if(C){K.showDeleteLink()}else{K.hideDeleteLink()}}else{I=I===undefined?true:I;C=C===undefined?false:C;var Q=I&&!C?true:(!I&&C?false:(!I&&!C?false:K.isDeleteLinkVisible()));if(Q){K.hideDeleteLink()}else{K.showDeleteLink()}}}if(K.getCriteria().setfieldvalue.criteria.length!==0){var U=K.getCriteria().setfieldvalue.criteria;var F=U.length;var R=true,N=false;var T=0,O=-1;for(var P=0;P<F;P++){if(U[P]==="true"){T++;O=P;continue}var J=U[P];if(M.evaluateCondition(J)){if(!K.getCriteria().setfieldvalue.set){K.getCriteria().setfieldvalue.prevalue=K.getValue()}else{if(K.getCriteria().setfieldvalue.set&&R===false){K.setValue(K.getCriteria().setfieldvalue.prevalue);K.getCriteria().setfieldvalue.set=false;break}if(K.getValue()!==K.getCriteria().setfieldvalue.value[K.getCriteria().setfieldvalue.correctCrit].value){K.getCriteria().setfieldvalue.prevalue=K.getValue()}}K.setValue(K.getCriteria().setfieldvalue.value[P].value);K.getCriteria().setfieldvalue.set=true;K.getCriteria().setfieldvalue.correctCrit=P;R=false}}if(!K.getCriteria().setfieldvalue.set&&T===1){K.setValue(K.getCriteria().setfieldvalue.value[O].value)}if(R&&K.getCriteria().setfieldvalue.set){if(K.getValue()===K.getCriteria().setfieldvalue.value[K.getCriteria().setfieldvalue.correctCrit].value){K.setValue(K.getCriteria().setfieldvalue.prevalue)}K.getCriteria().setfieldvalue.set=false;K.getCriteria().setfieldvalue.correctCrit=-1}}}};this.setFieldValue=function(I,D,J){var F=null;if(I.indexOf(".")!==-1){var L=I.split(".")[0];var E=I.split(".")[1];F=this.formController.getFieldController(L);F=F.getCompositeSubField(E);F.setCriteria("setfieldvalue",J)}else{F=this.formController.getFieldController(I)}if(F===undefined){return }var G=F.getCriteria().setfieldvalue.criteria;if(F.getCriteria().setfieldvalue.value===undefined){F.getCriteria().setfieldvalue.value=[]}for(var H=0;H<G.length;H++){if(G[H]===J){var C={};var K=ZCGlobal.uiDateFormate.replace("E","ddd");if(D.indexOf("${zoho.currenttime}")!=-1){D=moment().locale("en-US").format(K+" HH:mm:ss")}else{if(D.indexOf("${zoho.currentdate}")!=-1){D=moment().locale("en-US").format(K)}else{if(D.indexOf("${zoho.")!=-1){D=D.replace("${zoho.","").replace("}","");D=B.getModel().getZohoVars()[D]}}}C.value=this.constructValue(D,F);F.getCriteria().setfieldvalue.value.push(C)}}};this.constructValue=function(D,G){var I;var C=G.getModel().getComponentType();if(G.getModel().getGMAPKEY()==="prefix"){return{id:D,text:D}}else{if(G.getModel().getGMAPKEY()==="country"){var K=Constants.COUNTRY_MAP[D.toLowerCase()];if(K===undefined){K=Constants.INVERTED_COUNTRY_MAP[D.toLowerCase()];I={id:K!=undefined?K:D,text:D}}else{I={id:D.toLowerCase(),text:K}}}else{if(G.getModel().getComponentType()===FieldType.CURRENCY&&D!=undefined&&D!=""&&G.getModel().getValueFormat()===FormatConstants.DOTCOMMA){I=D.replace(".",",")}else{if(C===FieldType.TIME||C===FieldType.DATE_TIME&&D!=undefined&&D!=""){var H="",F=D;if(C===FieldType.DATE_TIME){H=D.split(":")[0].slice(0,-2);F=D.replace(H,"")}var J=(F.toLowerCase().indexOf("am")==-1&&F.toLowerCase().indexOf("pm")==-1);var E=F.split(":").length==3;F=new moment(F,getTimeFormat(E,J),true);if(F.isValid()){F=F.format(getTimeFormat(G.getModel().isShowSecondsEnabled(),G.getModel().is24HrFormat()));I=H+F}else{I=D}}else{I=D}}}}return I}}AutomationController.prototype.execute=function(){var I=this;var G=I.formRules.isNewWfEnabled;if(G=="false"||G==undefined){for(r in I.formRules.rules){var J=I.formRules.rules[r];try{J.condition=decodeURIComponent(J.condition);for(t in J.tasks){var A=J.tasks[t];for(tf in A.taskConfig.FIELDS){var D=A.taskConfig.FIELDS[tf];if(J.conditionFields.length===0){J.conditionFields[0]=I.DUMMY_FIELD}for(cf in J.conditionFields){I.mapFields(J.conditionFields[cf],D)}I.setFieldCriteria(D,A.taskType,J.condition)}if(A.taskType===this.TASK_TYPE.SET_FIELD_VALUE){var E=JSON.parse(JSON.stringify(A.taskConfig));for(field in E.VALUES){I.setFieldValue(field,E.VALUES[field],J.condition)}}}}catch(H){var F=window.console;F.log(H)}}}else{for(r in I.formRules.rules){var J=I.formRules.rules[r];try{for(g in J.groups){var K=J.groups[g];K.condition=decodeURIComponent(K.condition);for(t in K.tasks){var A=K.tasks[t];for(tf in A.taskConfig.FIELDS){var D=A.taskConfig.FIELDS[tf];if(K.conditionFields.length===0){K.conditionFields[0]=I.DUMMY_FIELD}for(cf in K.conditionFields){I.mapFields(K.conditionFields[cf],D)}I.setFieldCriteria(D,A.taskType,K.condition)}if(A.taskType===this.TASK_TYPE.SET_FIELD_VALUE){var E=JSON.parse(JSON.stringify(A.taskConfig));for(field in E.VALUES){I.setFieldValue(field,E.VALUES[field],K.condition)}}}}}catch(H){var F=window.console;F.log(H)}}}if(I.DUMMY_FIELD_CONTROLLER.hasActionFields()){I.event(I.DUMMY_FIELD_CONTROLLER)}for(k in this.formController.getFormFields()){var C=this.formController.getFieldController(k);if(C.hasActionFields()){I.event(C);var B=function(N){var M=function(){I.event(N)};var L=C.getModel().getComponentType();if(L==FieldType.DATE||L==FieldType.DATE_TIME){if(!$(N.getField()).hasClass("automationReg")){$(N.getField()).addClass("automationReg");$(N.getField()).change(M).keyup(M)}}else{$(N.getField()).change(M).keyup(M)}}(C)}}};function AutomationOperation(){var B=[];var A={hide:undefined,show:undefined,enable:undefined,disable:undefined,hidesubformaddentry:undefined,showsubformaddentry:undefined,hidesubformdelentry:undefined,showsubformdelentry:undefined,setfieldvalue:{criteria:[],set:false,prevalue:undefined,value:[],correctCrit:-1}};this.getActionFields=function(){return B};this.setActionField=function(C){for(k in B){if(C.getLabelName()==B[k].getLabelName()){return }}B.push(C)};this.hasActionFields=function(){return B.length>0};this.hasActionField=function(D){for(var C in B){if(D.getLabelName()==B[C].getLabelName()){return true}}return false};this.getCriteria=function(){return A};this.setCriteria=function(C,D){if(C=="setfieldvalue"){A[C].criteria.push(D);return }A[C]=(A[C]==undefined)?D:(A[C]+"||"+D)}}var FormModel=(function(E,P,J){ModelFactory.call(this,E,ObjectType.FORM);var R=P,M=J;if(J!==undefined&&J["#"+E.FORMLINKNAME]!==undefined){$.extend(true,E,M["#"+E.FORMLINKNAME])}this.getFormId=function(){return this.getMeta().FORMID};this.getFormLinkName=function(){return this.getMeta().FORMLINKNAME};this.getAppLinkName=function(){return E.APPLINKNAME};this.getActualAppLinkName=function(){return E.ACTUALAPPLINKNAME};this.getFormDisplayName=function(){return this.getMeta().FORMDISPLAYNAME};this.getFormFieldData=function(T){return R[T]};this.getFormFieldMeta=function(T){var U=this.getMeta().FORMLAYOUT[T];if(M!==undefined&&M[T]!=undefined){$.extend(true,U,M[T])}return U};this.getDynamicMeta=function(T){if(M!==undefined){return M[T]}};this.getFormFields=function(){return this.getMeta().FORMLAYOUT};this.getFirstColumnFields=function(){return K(this.getFormFields(),1)};this.getSecondColumnFields=function(){return K(this.getFormFields(),2)};this.getFieldsByColumnNo=function(T){return K(this.getFormFields(),T)};this.getField=function(T){return this.getMeta().FORMLAYOUT[T]};this.getFieldModel=function(T){return Model.FieldModel.create(this.getField(T),this)};this.hasDependencyField=function(){return this.hasRichtextField()};this.hasRichtextField=function(){return Q(this.getFormFields(),FieldType.RICH_TEXT_AREA)};function B(U){for(var V=0,T=U.length;V<T;++V){if(U[V].FIELDTYPE!=FieldType.PLAIN_TEXT){return U[V].FIELDLABELNAME}}return U[0].FIELDLABELNAME}this.getFirstFieldName=function(){var W=this.getFirstColumnFields(),U=[];for(var V=0,X=Object.keys(W),T=X.length;V<T;++V){if(!W[X[V]].FIELDISHIDDEN){U.push(W[X[V]])}}U.sort(function(c,Z){var Y=c.SEQUENCE_NUMBER,d=Z.SEQUENCE_NUMBER;return((Y<d)?-1:((Y>d)?1:0))});return(U.length>0)?(U[0].FIELDTYPE!=FieldType.PLAIN_TEXT?U[0].FIELDLABELNAME:B(U)):""};this.getSortedKeys=function(){var W=this.getFormFields(),X=[];for(var U=0,V=Object.keys(W),T=V.length;U<T;++U){X.push(V[U])}X.sort(function(c,Z){var Y=W[c],h=W[Z];var d=Y.SEQUENCE_NUMBER,e=h.SEQUENCE_NUMBER;return((d<e)?-1:((d>e)?1:0))});return X};this.getAccessType=function(){return E.FORMACCESSTYPE};this.getRandStr=function(){return E.RANDSTR};this.getAppLinkName=function(){return E.APPLINKNAME};this.getFormAlign=function(){return E.FORMALIGN};this.getPKValue=function(){return R.PKVALUE};this.hasOnLoad=function(){return E.HASONLOADEXIST};this.getOnLoadActions=function(){return E.ONLOADACTION};this.getFormStyle=function(){return E.FORMSTYLE};this.getRulesScript=function(){return E.RULESCRIPT};var F=undefined;this.getZohoVars=function(){if(F==undefined){if(this.isPermaOrEmbed()&&!this.isPublic()){LIB._initGlobals()}F=$.extend(true,{},E.ZOHO_VARS);F.adminuser=ZCGlobal.scopeName;F.loginuser=ZCGlobal.loginName;F.loginuserid=ZCGlobal.loginEmail}return F};this.getButtons=function(){return E.FORMBUTTON.FORMBUTTONS};this.getFormType=function(){return E.FORMBUTTON.FORMTYPE};this.isAutoWidth=function(){return(E.FORMAUTOWIDTH!=undefined)?E.FORMAUTOWIDTH:false};this.isPublic=function(){return E.ISPUBLIC};this.hasPrivateLink=function(){return(this.isPublic()||!LIB._isNull(E.PRIVATELINK))};this.getPrivateLink=function(){return E.PRIVATELINK};this.isPaymentCallback=function(){return E.ISPAYMENTCALLBACK};this.getPmtTransactionId=function(){return E.PMTTRANSACTIONID};this.getPmtReturnType=function(){return E.PMTRETURNTYPE};this.getRecordLinkId=function(){return R.RECLINKID};this.getRecordLinkIdFromMeta=function(){return E.RECLINKID};this.getSuccessMsg=function(){return E.SUCCESSMSG};this.getNextURL=function(){return E.NEXTURL};this.getURLType=function(){return E.ZC_URL_TYPE};this.openFormIn=function(){return E.OPENIN};this.isCustomFormLabelWidth=function(){return(E.FORMLABELWIDTHTYPE=="custom")};this.getLabelWidth=function(){return E.FORMLABELWIDTH};this.getLabelWidthUnit=function(){return(E.FORMLABELWIDTHUNIT==1)?"%":"px"};this.getViewLinkName=function(){return E.VIEWLINKNAME};this.showOnlyViewFields=function(){return E.EDITONLYVISIBLE};this.getFromParams=function(){return E.FORMPARAMS};var C;this.getParamFieldLabels=function(){if(typeof (C)==="undefined"&&typeof (this.getFromParams())!=="undefined"){C=this.getFromParams().split("&").map(function(T){return T.split("=")[0]})}return C};var O=0;this.incrementActiveUploads=function(){O++};this.decrementActiveUploads=function(){if(O!=0){O--}};this.getNoOfActiveUploads=function(){return O};var G=0;this.incrementActiveAddressOps=function(){G++};this.decrementActiveAddressOps=function(){G--};this.getNoOfActiveAddressOps=function(){return G};this.hasCaptcha=function(){return E.ISCAPTCHAENABLED};function K(X,V){var Y={};for(var U=0,W=Object.keys(X),T=W.length;U<T;++U){if(X[W[U]].FIELDCOLUMN==V){Y[W[U]]=X[W[U]]}}return Y}this.getMaxCol=function(){var X=0;var W=this.getFormFields();for(var U=0,V=Object.keys(W),T=V.length;U<T;++U){if(X<W[V[U]].FIELDCOLUMN){X=W[V[U]].FIELDCOLUMN}}return X};function Q(X,U){for(var V=0,W=Object.keys(X),T=W.length;V<T;++V){if(X[W[V]].FIELDCOMPTYPE==U){return true}}return false}this.isPerma=function(){return E.ISPERMA};this.isEmbed=function(){return E.ISEMBED};this.isPermaOrEmbed=function(){return E.ISEMBED||E.ISPERMA};this.focusFirstField=function(){return E.FIRSTFIELDFOCUS};this.isGeoLocationMandatory=function(){return E.GEOLOCATION!=undefined?E.GEOLOCATION:false};var N=null;this.setTriggeredControllerType=function(T){N=T};this.getTriggeredControllerType=function(){return N};this.isGeoFenceEnabled=function(){return E.GEO_FENCE!=undefined};this.getGeoFenceObj=function(){return E.GEO_FENCE};var L=[];this.addPendingTask=function(T){L.push(T)};this.removePendingTask=function(T){var U=L.indexOf(T);L.splice(U,1)};this.getPendingTaskFields=function(){return L};this.is24HrFormat=function(){return E.IS24_HOUR_FORMAT};var I=[];var H=[];var D=[];var S=[];var A="";this.addImageFieldWithOnLoadShow=function(){if(Q(this.getFormFields(),FieldType.IMAGE)){var Y=this.getFormFields(),V=0;var U=Object.keys(Y).sort(function(c,Z){return Y[c].SEQUENCE_NUMBER-Y[Z].SEQUENCE_NUMBER});for(var W=0,X=U,T=X.length;W<T;++W){if(Y[X[W]].FIELDCOMPTYPE==FieldType.IMAGE&&(Y[X[W]].IMAGETYPE==Constants.CAMERA||Y[X[W]].IMAGETYPE==Constants.LINKANDCAMERA||Y[X[W]].IMAGETYPE==Constants.CAMERAANDLOCAL||Y[X[W]].IMAGETYPE==Constants.IMAGEALLOPTION)){if(Y[X[W]].CAMERAPROP.ISSHOWONLOAD){I[V]=(Y[X[W]].FIELDLABELNAME);V++}}}}};this.getImageFieldWithOnLoadShow=function(){return I};this.removeImageFieldWithOnLoadShow=function(T){A=T;var U=I.indexOf(T);I.splice(U,1)};this.addImageFieldWithSubmitAfterScan=function(){if(Q(this.getFormFields(),FieldType.IMAGE)){var Y=this.getFormFields();var V=Object.keys(Y).sort(function(c,Z){return Y[c].SEQUENCE_NUMBER-Y[Z].SEQUENCE_NUMBER});var U=0;for(var W=0,X=V,T=X.length;W<T;++W){if(Y[X[W]].FIELDCOMPTYPE==FieldType.IMAGE&&(Y[X[W]].IMAGETYPE==Constants.CAMERA||Y[X[W]].IMAGETYPE==Constants.LINKANDCAMERA||Y[X[W]].IMAGETYPE==Constants.CAMERAANDLOCAL||Y[X[W]].IMAGETYPE==Constants.IMAGEALLOPTION)){if(Y[X[W]].CAMERAPROP.ISSUBMITAFTERSCAN){H[U]=(Y[X[W]].FIELDLABELNAME);U++}}}}};this.getImageFieldWithSubmitAfterScan=function(){return H};this.removeImageFieldWithSubmitAfterScan=function(T){var U=H.indexOf(T);H.splice(U,1)};this.getOpenedPopup=function(){return A}});FormModel.prototype=Object.create(ModelFactory.prototype);FormModel.prototype.constructor=FormModel;var FormButtonModel=(function(A){ModelFactory.call(this,A,ObjectType.FORMBUTTON);this.getButtonID=function(){return A.BUTTONID};this.getButtonName=function(){return A.BUTTONLABEL_NAME};this.getButtonType=function(){return A.BUTTON_TYPE};this.getButtonEvent=function(){return A.BUTTONEVENT};this.getButtonID=function(){return A.BUTTON_ID}});FormButtonModel.prototype=Object.create(ModelFactory.prototype);FormButtonModel.prototype.constructor=FormButtonModel;var FieldModel=(function(F,A,C){var E,D,B;E=F;D=A;B=C;this.getData=function(){return B};this.getComponentType=function(){return E.FIELDCOMPTYPE};this.getLabelName=function(){return E.FIELDLABELNAME};this.getActualLabelName=function(){return E.ACTUALLABEL};this.getDisplayName=function(){return E.FIELDDISPLAYNAME};this.isMandatory=function(){return E.FIELDISMANDATORY};this.getClassName=function(){return E.FIELDCLASSNAME};this.getSequenceNo=function(){return E.SEQUENCE_NUMBER};this.getFormComponentId=function(){return E.FORMCOMPID};this.isSmallField=function(){return(!E.FIELDSIZECLASSNAME&&E.FIELDWIDTH<200)||(E.FIELDSIZECLASSNAME&&E.FIELDSIZECLASSNAME.indexOf("smallSizeLive")==0)};this.readOnly=E.READONLY;this.isReadOnly=function(G){if(G){return this.readOnly}return E.READONLY};this.setReadOnly=function(G){this.readOnly=G};this.visible=E.VISIBLE;this.isVisible=function(G){if(G){return this.visible}return E.VISIBLE};this.setVisible=function(G){this.visible=G};this.isOnChangeExist=function(){return(E.ONCHANGEEXIST=="true"||E.ONCHANGEEXIST==true)};this.isZiaInput=function(){return E.ISZIAINPUT};this.getDependentZiaFields=function(){return E.DEPENDENTZIAFIELDS};this.isPredictionInput=function(){return E.ISPREDICTIONINPUT};this.getDependentPredictionFields=function(){return E.DEPENDENTPREFIELDS};this.getZiaType=function(){return E.ZIATYPE};this.getZiaDependentFields=function(){return E.ZIADEPFIELDS};this.isZiaOnUserInputExist=function(){return E.HASZIAINONUSERINPUT};this.isFormulaExist=function(){return(E.ISFORMULAEXIST=="true")};this.isFormulaField=function(){return(this.getComponentType()==FieldType.SCRIPT)};this.isSubformField=function(){return(E.ISSUBFORM=="true")};this.getRowID=function(){return E.ROWID};this.getDefaultValue=function(){return B!==undefined?B.FIELDVALUE:""};this.getFormModel=function(){return D};this.getParentFormModel=function(){return(E.ISSUBFORM=="true")?D.getFormModel():D};this.isLookup=function(){return false};this.getTitle=function(){return E.FIELDDESC};this.getDescType=function(){return E.FIELDDESCTYPE};this.isFromReport=function(){return E.ISFROMREPORT};this.getFieldType=function(){return E.FIELDTYPE};this.getTotalRecordsCount=function(){return E.TOTALRECORDS};this.fieldDecimalLength=function(){return E.FIELDDECIMALLENGTH};this.isCompositeField=function(){return E.FIELDCOMPTYPE==FieldType.ADDRESS||E.FIELDCOMPTYPE==FieldType.NAME};this.getGroupParentField=function(){return E.GROUPPARENTFIELD};this.isCompositeSubField=function(){return E.GROUPPARENTFIELD!=undefined?true:false};this.isAddressSubField=function(){return E.GROUPPARENTFIELD!=undefined&&E.GROUPPARENTFIELDTYPE==FieldType.ADDRESS};this.getGMAPKEY=function(){return E.GMAPKEY};this.isCoordinateField=function(){return E.GMAPKEY=="latitude"||E.GMAPKEY=="longitude"};this.isName_PrefixField=function(){return E.GMAPKEY=="prefix"};this.isAddress_CountryField=function(){return E.GMAPKEY=="country"};this.getHeight=function(){return E.FIELDHIEGTH};this.getPlainTextVal=function(){return E.PLAINTEXT}});var ZiaTextModel=(function(C,A,B){FieldModel.call(this,C,A,B);this.isSelectField=function(){return C.ISSELECTFIELD};this.getValueFormat=function(){return C.VALUEFORMAT};this.getPlaceHolderFormat=function(){return C.PLACEHOLDERFORMAT};this.getMaxDigits=function(){return C.FIELDMAXDIGITS};this.getCurrencySymbol=function(){return C.CURRENCYSYMBOL};this.setFieldValue=function(D){B.FIELDVALUE=D};this.getFieldValue=function(){return B.FIELDVALUE}});var ZiaMultiLineModel=(function(C,A,B){FieldModel.call(this,C,A,B);this.setFieldValue=function(D){B.FIELDVALUE=D};this.getFieldValue=function(){return B.FIELDVALUE}});var CurrencyModel=(function(D,B,C){FieldModel.call(this,D,B,C);var A=false;this.setValidationError=function(E){A=E};this.containsValidationError=function(){return A};this.getValueFormat=function(){return D.VALUEFORMAT};this.getPlaceHolderFormat=function(){return D.PLACEHOLDERFORMAT};this.getMaxDigits=function(){return D.FIELDMAXDIGITS}});var DateTimeModel=(function(E,C,D){FieldModel.call(this,E,C,D);var A=E.ISSUBFORM=="true"?C.getFormModel().is24HrFormat():C.is24HrFormat();var F=E.WORKHOURSTART,B=E.WORKHOUREND,H=[];if(F!=undefined&&B!=undefined){var G={};G.start=F;G.end=B;G.startInSeconds=parseInt(F)*3600;G.endInSeconds=parseInt(B)*3600;H.push(G)}this.getDateFormat=function(){return E.dateFormat};this.getAllowedDays=function(){return(E.WORKWEEK!=undefined)?E.WORKWEEK:"0,1,2,3,4,5,6"};this.getPickerLanguage=function(){return E.LANGUAGE};this.getAllowedTimeLimitInSeconds=function(){return H};this.getTimeInterval=function(){return E.TIMEINTERVAL};this.is24HrFormat=function(){return A};this.getTimeFormat=function(){return getTimeFormat(E.SHOWSECONDS,A)};this.isShowSecondsEnabled=function(){return E.SHOWSECONDS}});createPrototype(DateTimeModel,FieldModel.prototype);var TimeModel=(function(J,I,B){FieldModel.call(this,J,I,B);var K=J.ISSUBFORM=="true"?I.getFormModel().is24HrFormat():I.is24HrFormat();var D=[];if(J.DURATIONRANGE!=undefined){var F=JSON.parse(J.DURATIONRANGE);var A,G,C={};for(var E=0,H=F.length;E<H;E++){A=F[E].from,G=F[E].to;C.start=A;C.end=G;C.startInSeconds=parseInt(A)*3600;C.endInSeconds=parseInt(G)*3600;D.push(C)}}this.getTimeInterval=function(){return J.TIMEINTERVAL};this.getTimeFormat=function(){return getTimeFormat(J.SHOWSECONDS,K)};this.is24HrFormat=function(){return K};this.isShowSecondsEnabled=function(){return J.SHOWSECONDS};this.getAllowedTimeLimitInSeconds=function(){return D}});createPrototype(TimeModel,FieldModel.prototype);var SignatureModel=(function(C,A,B){FieldModel.call(this,C,A,B)});createPrototype(SignatureModel,FieldModel.prototype);var CompositeModel=(function(C,A,B){FieldModel.call(this,C,A,B);this.getDefaultValue=function(){for(ind=0,len=C.COMPOSITEFIELDS.length;ind<len;ind++){var D=C.COMPOSITEFIELDS[ind];if(D.FIELDVALUE!=undefined&&D.FIELDVALUE!=""){return"composite"}}return""};this.getRecID=function(){return C.recID};this.getSubFieldLabelName=function(D){return C.COMPOSITEFIELDS[D].ACTUALLABEL};this.getActualLabelNameFromMapKey=function(G){var F=this.getFullCompositeFields();for(var E in F){var D=F[E];if(D.GMAPKEY==G){return D.ACTUALLABEL}}return null}});createPrototype(CompositeModel,FieldModel.prototype);var NameModel=(function(C,A,B){CompositeModel.call(this,C,A,B);var E={};for(ind=0,len=C.COMPOSITEFIELDS.length;ind<len;ind++){var D=C.COMPOSITEFIELDS[ind].ACTUALLABEL;E[D]=C.COMPOSITEFIELDS[ind];E[D].defaultData=B[D]}this.getCompositeFields=function(){return E};this.setCompositeField=function(F,G){E[F]=G};this.getFullCompositeFields=function(){return E}});createPrototype(NameModel,CompositeModel.prototype);var AddressModel=(function(C,A,B){CompositeModel.call(this,C,A,B);var H={};var E={};var F;for(ind=0,len=C.COMPOSITEFIELDS.length;ind<len;ind++){var D=C.COMPOSITEFIELDS[ind].ACTUALLABEL;var G=C.COMPOSITEFIELDS[ind].GMAPKEY;if(!(G=="latitude"||G=="longitude")){H[D]=C.COMPOSITEFIELDS[ind];H[D].defaultData=B[D]}else{E[D]=C.COMPOSITEFIELDS[ind];E[D].defaultData=B[D]}}this.getCompositeFields=function(){return H};this.setCompositeField=function(I,J){H[I]=J};this.getCoordinateFields=function(){return E};this.setCoordinateField=function(I,J){E[I]=J};this.getFullCompositeFields=function(){if(isNull(F)){F=$.extend(true,{},H,E)}return F};this.isCaptureGeoCoordinates=function(){return C.CAPTURE_GEO_COORDINATES};this.isAdjustLocation=function(){return C.ADJUST_LOCATION}});createPrototype(AddressModel,CompositeModel.prototype);var SubformModel=(function(K,T,C){FieldModel.call(this,K,T,C);var F={},O,Q,H=true,B=false,A=false;if(K.SUBFORMFIELDS!=undefined){var G=K.SUBFORMFIELDS[0],D=S(G);if(G.SUBFORMROWNO==0){O=D}Q=C.SUBFORM_RECORDS[0];for(var N=1,P=C.SUBFORM_RECORDS.length;N<P;++N){var U=$.extend(true,[],O);var J=C.SUBFORM_RECORDS[N];for(var M=0,L=U.length;M<L;++M){field=D[M];field.FIELDLABELNAME=K.FIELDLABELNAME+"."+J.IDFIELD+"."+field.ACTUALLABEL}I(U,J.IDFIELD);F[J.IDFIELD]={FIELDS:U,STATUS:J.RECSTATUS,ROWNO:J.SUBFORMROWNO,ROWKEY:J.IDFIELD,ID:J.ROWID,DATA:J}}}this.getNullRowFields=function(){var V=$.extend(true,[],O);I(V,"t::row_0");return V};this.getNullRowData=function(){return $.extend(true,[],Q)};this.getFormLinkName=function(){return T.getFormLinkName()};this.getAppLinkName=function(){return T.getAppLinkName()};this.getRefFormLinkName=function(){return K.REFFORMLINKNAME};this.getRefAppLinkName=function(){return K.REFAPPLINKNAME};this.getRefProdAppName=function(){return K.REFPRODUCTIONAPPNAME};this.isNewSubform=function(){return K.ISNEWTYPESUBFORM=="true"};this.getDefaultRow=function(){return K.SUBFORMDEFROWS};this.getMaxRows=function(){return K.SUBFORMMAXROW};this.getCurrRows=function(){return Object.keys(F).length};this.getVoidRow=function(){return K.SUBFORMNULLROW};this.getSubformType=function(){return K.SUBFORMTYPE};this.getRefFormDispName=function(){return K.REFFORMDISPNAME};this.isEmptyRow=function(){return B};this.setEmptyRow=function(V){B=V};this.hasMoreRows=function(){return((this.getMaxRows()==-1)||(this.getCurrRows()<this.getMaxRows()))};this.addNewFields=function(Y,X,W,V){F[Y]={FIELDS:X,STATUS:"added",ROWNO:W,ROWKEY:Y,DATA:V}};this.getFields=function(V){return F[V].FIELDS};this.getFirstFieldName=function(){var V=this.getNullRowFields().sort(function(Y,X){var W=Y.SEQUENCE_NUMBER,Z=X.SEQUENCE_NUMBER;return((W<Z)?-1:((W>Z)?1:0))});return(V.length>0)?V[0].ACTUALLABEL:""};this.getRow=function(V){return F[V]};this.renameRow=function(W,X,V){if(W!=X){F[W]=F[X]}};this.getSortedRow=function(){var V=[];for(key in F){V.push(F[key])}return V.sort(function(X,W){if(X.ROWNO>W.ROWNO){return 1}else{if(X.ROWNO<W.ROWNO){return -1}}return 0})};this.getFirstRow=function(){var V=Object.keys(F);return(V.length>0)?V[0]:undefined};this.getSubformField=function(W,V){if(W==undefined){var X=[];for(r in F){X.push(this.getSubformField(r,V))}return X}if(F[W]!=undefined){var Y=F[W].FIELDS;for(N=0,L=Y.length;N<L;N++){if(Y[N].ACTUALLABEL==V){return Y[N].CONTROLLER}}}};this.getControllers=function(V){var W=[],X=F[V].FIELDS;for(N=0,L=X.length;N<L;N++){W.push(X[N].CONTROLLER)}return W};this.getAllFields=function(){return F};this.isTopField=function(V){return(Object.keys(F)[0]==V)};this.deleteFields=function(V){delete F[V];return Object.keys(F).length};this.getAvailableRows=function(){return Object.keys(F)};function S(V){return V.SUBFORMROW}var R=true,E=true;this.isAddLinkVisible=function(){return R};this.setAddLinkVisiblity=function(V){R=V};this.isDeleteLinkVisible=function(){return E};this.setDeleteLinkVisiblity=function(V){E=V};this.hasOnAddRow=function(){return K.SUBFORMHASADDROW};this.hasOnDeleteRow=function(){return K.SUBFORMHASDELETEROW};this.clearRows=function(){F={}};function I(Y,Z){for(var X=0,V=Y.length;X<V;++X){var W=T.getDynamicMeta(K.FIELDLABELNAME+"."+Z+"."+Y[X].ACTUALLABEL);if(W!==undefined){$.extend(true,Y[X],W)}}}this.getAccessType=function(){return T.getAccessType()};this.getRandStr=function(){return T.getRandStr()};this.setCentreAddLinkStatus=function(V){A=V};this.hideCentreAddLink=function(){return A}});createPrototype(SubformModel,FieldModel.prototype);var ImageModel=(function(C,A,B){FieldModel.call(this,C,A,B);var D={1:"new",2:"same"};this.getImageType=function(){return C.IMAGETYPE};this.getImageSRC=function(){return B.imgSRC};this.getImgBrowse=function(){return B.imgBrowse};this.isAltReq=function(){return C.ISALTREQ};this.isLinkReq=function(){return C.ISLINKNAMEREQ};this.isTitleReq=function(){return C.ISTITLEREQ};this.isLocalImgSRC=function(){return B.isLocalImgSRC};this.getImageTarget=function(){return D[C.IMAGETARGET]};this.setImageTarget=function(E){if(E!=undefined){C.IMAGETARGET=E}};this.getImageSelectedType=function(){return B.zcImgType};this.setDefaultValue=function(E){C.FIELDVALUE=E};this.getCameraProperties=function(){return C.CAMERAPROP}});createPrototype(ImageModel,FieldModel.prototype);var FileUploadModel=(function(C,A,B){FieldModel.call(this,C,A,B);this.isOneFileUpload=function(){return C.ISONEFILEUPLOAD};this.hasBrowse=function(){return C.ISBROWSE};this.getCloudService=function(){return C.CLOUDSERVICE};this.isPickerRestricted=function(){return C.ISPICKERRESTRICTED}});createPrototype(FileUploadModel,FieldModel.prototype);var AudioModel=(function(C,A,B){FieldModel.call(this,C,A,B)});createPrototype(AudioModel,FieldModel.prototype);var VideoModel=(function(C,A,B){FieldModel.call(this,C,A,B)});createPrototype(VideoModel,FieldModel.prototype);var RichTextModel=(function(E,B,D){FieldModel.call(this,E,B,D);var A=this;var G=ZE_Init.defaultFontFamily;var F="";var C=false;this.hasDefaultFontFamily=function(I){for(var H=0;H<=I.length;H++){if(I[H]!=undefined){if(H==0){F=I[H].ff}if(I[H].htm=="DejaVuSans"){return true}}}return false};this.getToolbarConfig=function(){var I=E.RTETTOOLSJSON;ZE_Init.needplaintext=false;var K="ltr";if(ZCGlobal.appDirectionMeta.isRTL){K="rtl"}var L={};L.link="zc-rte-radio";var J=false;if(I.length==0){J=true}if(E.RTETFONTFAMILYJSON.length!=0){C=true;if(!A.hasDefaultFontFamily(E.RTETFONTFAMILYJSON)){G=F}}var H={};if(C){H={editorheight:E.FIELDHIEGTH,toolbar:I,fontsize:E.RTETFONTJSON,avoidMoreOption:true,customClass:L,textDirection:K,enableGrammarly:true,toolbarConstructionNotRequired:J,fontfamilyList:E.RTETFONTFAMILYJSON,defaultfontfamily:G}}else{H={editorheight:E.FIELDHIEGTH,toolbar:I,fontsize:E.RTETFONTJSON,avoidMoreOption:true,customClass:L,textDirection:K,enableGrammarly:true,toolbarConstructionNotRequired:J}}H.allowAttrsInsertHTML=["target"];return H}});createPrototype(RichTextModel,FieldModel.prototype);var SelectModel=(function(J,H,A){FieldModel.call(this,J,H,A);var I={},K=false,E=true,F=J.ISLOOKUP?true:false;var D={};var G={};var C={};this.hasActiveRequest=false;this.isAddedToParent=false;this.getAllChoices=function(){return G.data!=undefined?G:I[""]};this.constructId=function(L){C.id=L};this.constructText=function(L){C.text=L};this.getConstructedVal=function(){return C};function B(L){if(I[L]==undefined){I[L]={data:[],isSaturated:false,currPage:1}}}this.isLookup=function(){return J.ISLOOKUP};this.isDynamicLookup=function(){return J.IS_DYNAMIC_LOOKUP};this.isLiveVariableCriteriaLookup=function(){return J.IS_LIVE_VAR_CRITERIA_LOOKUP};this.isIntegrationField=function(){return J.ISINTEGRATIONFIELD};this.isExternalField=function(){return((this.getComponentType()==FieldType.POPUP_SINGLE||this.getComponentType()==FieldType.EXTERNAL_FIELD)&&!J.IsIntegrationField)};this.isFormLookup=function(){return !this.isExternalField()&&this.getComponentType()!=FieldType.SYSTEM_LOOKUP&&J.ISLOOKUP};this.getChoiceCount=function(){var L;if(Array.isArray(J.FIELDCHOICES)){L=J.FIELDCHOICES}else{L=JSON.parse(J.FIELDCHOICES)}return L!=undefined?L.length:-1};this.getChoiceColumn=function(){return J.CHOICECOLUMN};this.getDisplayField=function(){return J.EXTDISPLAYFIELD};this.getServiceType=function(){return J.EXTSERVICETYPE};this.getModuleType=function(){return J.EXTMODULE};this.isSearchEnabled=function(){return J.ISSEARCHFIELD=="true"};this.isSelectField=function(){return J.ISSELECTFIELD};this.isRequestCompleted=function(){return E};this.isValuesAlreadyPopulated=function(){return K};this.isOtherEnabled=function(){return J.ISOTHERENABLED};this.isSingleSelect=function(){if(this.getComponentType()==FieldType.SYSTEM_LOOKUP){return this.getSystemDisplayType()==100?true:false}return !(this.getComponentType()==FieldType.CHECK_BOXES||this.getComponentType()==FieldType.LIST)};this.setValuesPopulated=function(){K=true};this.sendingReq=function(){E=false};this.reqCompleted=function(){E=true};this.getChoices=function(L){B(L);return I[L].data};this.getAuxFieldChoices=function(){return D};this.isCached=function(L){return(I[L]!=undefined)};this.isPredefinedChoices=function(N){var O=this.getChoices("");for(var M in O){var L=O[M];if(L.id==N){return true}}return false};this.hasChoice=function(N){if(this.isLookup()){return true}var O=this.getChoices("");for(var M in O){var L=O[M];L.id=this.sanitizeChoices(L.id);if(L.id==N){return true}}return false};this.getCacheTerm=function(O){var P=Object.keys(I);for(var N=1,L=O.length-1;N<=L;N++){var M=O.substring(0,N);if(P.indexOf(M)!=-1&&I[M].isSaturated){return M}}return O};this.clearChoices=function(L){if(G.data==undefined&&!this.isDynamicLookup()&&this.isLookup()&&this.isSubformField()){G=I[""]}I={};I[""]={data:[],isSaturated:(L!==undefined?L:true),currPage:1}};this.isSaturated=function(L){B(L);return I[L].isSaturated};this.resetLoadLookup=function(){I[""].isSaturated=false};this.getCurrentPage=function(L){B(L);return I[L].currPage};this.Markup=function(L){return L.replace(/&amp;/g,"&").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&nbsp;/g," ")};this.sanitizeChoices=function(P){var O=new ZSEC.HTMLPurifier({ALLOWED_STYLE:"ALL",STYLE_VALIDATION:false,FORCE_BODY:true});var M=this.getComponentType()==FieldType.RADIO||this.getComponentType()==FieldType.INLINE_RADIO||this.getComponentType()==FieldType.CHECK_BOXES||this.getComponentType()==FieldType.EXTERNAL_FIELD;if(M){if(jQuery.type(P)!="string"){if(Array.isArray(P)){for(var N in P){if(P[N].id instanceof Object){var Q=P[N].id;for(var L in Q){Q[L]=O.sanitize(Q[L]==undefined?"":Q[L])}P[N].id=Q}else{P[N].id=O.sanitize(P[N].id==undefined?"":P[N].id)}P[N].text=O.sanitize(P[N].text==undefined?"":P[N].text)}}else{if(typeof P=="object"&&"id" in P&&"text" in P){P.id=O.sanitize(P.id==undefined?"":P.id);P.text=O.sanitize(P.text==undefined?"":P.text)}}}else{P=O.sanitize(P)}}return P};this.checkForDuplicates=function(N){if(I[""]!=undefined){var L=I[""].data.map(function(O){return O.id});for(var M=0;M<N.length;M++){if(L.indexOf(N[M].id)!=-1){N.splice(M,1);M--}}}return N};this.addChoices=function(M,O,L,P){var N=L.data;if(this.isIntegrationField()){N=L.data[0];D=$.extend(D,L.data[1])}if(this.isDynamicLookup()&&M==""){N=this.checkForDuplicates(N)}if(P){L.data=this.sanitizeChoices(N)}B(M);I[M].data=I[M].data.concat(N);I[M].isSaturated=L.isSaturated;I[M].currPage=O};this.addChoicesWithOutRedendency=function(O,Q,M){M.data=this.sanitizeChoices(M.data);B(O);for(var N in M.data){var L=false;for(var P in I[O].data){if(I[O].data[P].id==M.data[N].id){L=true;break}}if(!L){this.addChoice(O,M.data[N],Q)}}};this.addChoice=function(L,N,M){B(L);I[L].data=I[L].data.concat(N);if(M!=undefined){I[L].currPage=M}this.isAddedToParent=true};this.appendChoices=function(M,L){var N=I[""];I={};I[""]=N;this.addChoices("",N.currPage,{data:M,isSaturated:N.isSaturated},true);if(L){this.addChoices("zckey_appendedValues",N.currPage,{data:M,isSaturated:N.isSaturated},true)}return I};this.hasAddToParent=function(){return J.HASLOOKUPADD};this.getAddToParentText=function(){return J.LOOKUPADDTEXT};this.getRefFormLinkName=function(){return J.REFFORMLINKNAME};this.getRefAppLinkName=function(){return J.REFAPPLINKNAME};this.getRefProdAppName=function(){return J.REFPRODUCTIONAPPNAME};this.getRefFieldLabel=function(){return J.REFFORMCOMP};this.isLookupAddRestricted=function(){return J.RESTRICTLOOKUPADD};this.getSystemDisplayType=function(){var L=J.SYSTEMDISPLAYTYPE!=undefined?J.SYSTEMDISPLAYTYPE:100;return L};if(!this.isExternalField()&&!this.isIntegrationField()){if(this.getGMAPKEY()==="country"){this.addChoices("",1,{data:Constants.COUNTRY_DATA,isSaturated:J.ISSATURATED},false)}else{if(Array.isArray(J.FIELDCHOICES)){this.addChoices("",1,{data:J.FIELDCHOICES,isSaturated:J.ISSATURATED},false)}else{this.addChoices("",1,{data:JSON.parse(J.FIELDCHOICES),isSaturated:J.ISSATURATED},false)}}}this.isLookupFirstFetchNeeded=function(){return F};this.lookupFirstFetchNeeded=function(){F=true};this.lookupFirstFetchCompleted=function(){F=false};this.isTranslatedField=function(){return(J.ISTRANSLATEDFIELD===undefined?false:J.ISTRANSLATEDFIELD)}});createPrototype(SelectModel,FieldModel.prototype);var URLModel=(function(C,A,B){FieldModel.call(this,C,A,B);var D={1:"new",2:"same"};this.isLinkNameReq=function(){return C.ISLINKNAMEREQ};this.isTitleReq=function(){return C.ISTITLEREQ};this.getURLTarget=function(){return D[C.urlTarget]};this.setURLTarget=function(E){if(E!=undefined){C.urlTarget=E}}});createPrototype(URLModel,FieldModel.prototype);var SingleSelectModel=(function(C,A,B){SelectModel.call(this,C,A,B);this.getDefaultValue=function(){if(B.FIELDVALUE!=""&&B.FIELDVALUE!=undefined){return this.sanitizeChoices([B.FIELDVALUE])[0]}};this.setDefaultValue=function(D){B.FIELDVALUE=D};this.getIntegrationFieldValue=function(){if(B.FIELDVALUE!=""&&B.FIELDVALUE!=undefined){var D={};D.id=B.FIELDVALUE.id;D.text=$.isEmptyObject(this.getAuxFieldChoices())?B.FIELDVALUE.actualText:this.getAuxFieldChoices()[D.id];return D}};this.getExternalFieldID=function(){return C.EXTIDLABEL};this.getOthersOption=function(){return C.OTHERSOPTION}});createPrototype(SingleSelectModel,SelectModel.prototype);var DropdownModel=(function(C,A,B){SingleSelectModel.call(this,C,A,B);this.getIntegRecCount=function(){return C.integRecCount};this.setIntegRecCount=function(D){C.integRecCount=D}});createPrototype(DropdownModel,SingleSelectModel.prototype);var RadioModel=(function(C,A,B){SingleSelectModel.call(this,C,A,B)});createPrototype(RadioModel,SingleSelectModel.prototype);var MultipleSelectModel=(function(C,A,B){SelectModel.call(this,C,A,B);this.getDefaultValue=function(){var F=[];if(B.FIELDVALUE!=""&&B.FIELDVALUE!=undefined){for(i=0;i<B.FIELDVALUE.length;i++){var G=B.FIELDVALUE[i];var E=false;for(var D=0;D<F.length;D++){if(F[D].id==G.id){B.FIELDVALUE.splice(i--,1);E=true;break}}if(!E){F.push(G)}}return this.sanitizeChoices(F)}return F};this.setDefaultValue=function(D){B.FIELDVALUE=D}});createPrototype(MultipleSelectModel,SelectModel.prototype);var MultiSelectModel=(function(C,A,B){MultipleSelectModel.call(this,C,A,B)});createPrototype(MultiSelectModel,MultipleSelectModel.prototype);var CheckBoxModel=(function(C,A,B){MultipleSelectModel.call(this,C,A,B)});createPrototype(CheckBoxModel,MultipleSelectModel.prototype);var PhoneNumberModel=(function(D,B,C){FieldModel.call(this,D,B,C);var A=false;this.getDefaultCountryCode=function(){return D.DEFAULTCOUNTRY};this.getCountryList=function(){return D.ALLOWEDCOUNTRIES};this.isDisabledField=function(){return A};this.setDisable=function(E){A=E}});createPrototype(PhoneNumberModel,FieldModel.prototype);var ExternalModel=(function(C,A,B){FieldModel.call(this,C,A,B);this.getExternalURL=function(){return C.EXTERNALURL}});createPrototype(ExternalModel,FieldModel.prototype);var IntegrationModel=(function(M,I,C){FieldModel.call(this,M,I,C);var J={};var G={};var D={};var K=[];var N,O;var H=false;var E=0;var L=0;var P=0;var F=false;var A=false;var B=false;this.getStringForOperator=function(Q){switch(Q){case"1":return"equals";case"2":return"starts with";case"3":return"like";case"4":return"in"}return };this.isIntegrationField=function(){return M.ISINTEGRATIONFIELD};this.setFieldValue=function(Q){C.FIELDVALUE=Q};this.getFieldValue=function(){return C.FIELDVALUE};this.getRecordCount=function(){return this.recordCount};this.setRecordCount=function(Q){this.recordCount=Q};this.getSearchCount=function(){return this.searchCount};this.setSearchCount=function(Q){this.searchCount=Q};this.getColumnHeaders=function(){return M.DISPLAYFIELDS};this.getFieldChoice=function(Q){return J[Q]};this.getSearchChoice=function(Q){return G[Q]};this.getFieldChoices=function(){return J};this.getSearchChoices=function(){return G};this.clearSearchChoices=function(){this.searchFieldChoices={}};this.addFieldChoices=function(Q){J=this.getFieldChoices?$.extend(this.getFieldChoices(),Q[0]):$.extend([],Q[0])};this.addSearchChoices=function(Q){G=this.getSearchChoices?$.extend(this.getSearchChoices(),Q[0]):$.extend([],Q[0])};this.setSaturation=function(Q){this.saturation=Q};this.isSaturated=function(){return this.saturation};this.setSearchSaturation=function(Q){this.searchSaturation=Q};this.isSearchSaturated=function(){return this.searchSaturation};this.setEmptySearch=function(Q){this.emptySearch=Q};this.isEmptySearch=function(){return this.emptySearch};this.isSearchQuery=function(){return O};this.setSearchQuery=function(Q){O=Q};this.setSearchInputs=function(Q){K=Q};this.getSearchInputs=function(){return K};this.setInProgress=function(Q){this.inProgress=Q};this.getInProgress=function(){return this.inProgress};this.getCurrentDisplayCount=function(){return this.currentDisplayCount};this.setCurrentDisplayCount=function(Q){this.currentDisplayCount=Q};this.isActive=function(){return this.activeField};this.setActive=function(Q){this.activeField=Q}});createPrototype(IntegrationModel,FieldModel.prototype);var FormDOM=(function(B){var A=this;this.formContainer=document.getElementById(B.getFormLinkName()+"_"+B.getRandStr());if(A.formContainer){this.formContainerParent=A.formContainer.parentElement;this.formOverlay=A.formContainerParent.querySelector("#form-overlay");this.formPreloader=A.formContainerParent.querySelector("#form-overlay-progress");this.formDOMElement=A.formContainer.querySelector('form[name="'+B.getFormLinkName()+'"]');this.formOuterWrapper=A.formDOMElement.querySelector(".formContainer");this.formButtons={submit:A.formDOMElement.querySelector("input[name=submit]"),reset:A.formDOMElement.querySelector("input[name=reset]"),update:A.formDOMElement.querySelector("input[name=update]"),cancel:A.formDOMElement.querySelector("input[name=cancel]")};this.formInfoLink=A.formDOMElement.querySelector("#form-info-link");this.formErrorMsg=A.formDOMElement.querySelector("#form-error-msg")}this.getFormContainer=function(){if(A.formContainer){return A.formContainer}return document.getElementById(B.getFormLinkName()+"_"+B.getRandStr())};this.getFormParentContainer=function(){if(A.formContainerParent){return A.formContainerParent}return A.formContainer.parentElement};this.getFormDOM=function(){if(A.formDOMElement){return A.formDOMElement}return A.formContainer.querySelector('form[name="'+B.getFormLinkName()+'"]')};this.getPreloader=function(){if(A.formPreloader){return A.formPreloader}return A.formContainerParent.querySelector("#form-overlay-progress")};this.getFormOverlay=function(){if(A.formOverlay){return A.formOverlay}return A.formContainerParent.querySelector("#form-overlay")};this.getInfoLink=function(){if(A.formInfoLink){return A.formInfoLink}return A.formDOMElement.querySelector("#form-info-link")};this.getErrorMsgCont=function(){if(A.formErrorMsg){return A.formErrorMsg}return A.formDOMElement.querySelector("#form-error-msg")};this.getButton=function(C){return $(A.formButtons[C]||A.formDOMElement.querySelector('input[name="'+C+'"]'))};this.getAutoSubmitBtn=function(){var C=$(A.formDOMElement).find('input[type="submit"],[type="reset"],[type="button"]');return $(C).filter("[autosubmit=true]")};this.getCaptchaLabel=function(){return $(A.formDOMElement.querySelector("div[name='zc-captcha']")).parent()[0].querySelector("span.zc-label-text")};this.getCaptchaInput=function(){return $(A.formDOMElement.querySelector("input[elname=zc-captcha-input]"))};this.getCaptchaDigest=function(){return $(A.formDOMElement.querySelector("input[elname=zc-captcha-digest]"))};this.getCaptchaImg=function(){return $(A.formDOMElement.querySelector("img[elname=zc-captcha]"))};this.getResetCaptchIcon=function(){return $(A.formDOMElement.querySelector("#refreshCaptcha"))};this.getBulkEditInput=function(){return $(A.formDOMElement.querySelector("input[name=bulkeditFields]"))};this.getGeoOverlay=function(){return $(A.formContainerParent.querySelector("#geo-overlay"))};this.isPopup=function(){return $(A.formDOMElement).parents(".popupbox").length>0};this.isFullScreenPopup=function(){return $(A.formDOMElement).parents(".fullscreen").length>0}});FormDOM.prototype=Object.create(DOMFactory.prototype);FormDOM.prototype.constructor=FormDOM;var FieldDOM=(function(D,C){DOMFactory.call(this,D);var B=C;var A=this;this.fieldDOMElement=null;this.fieldParent=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}var F=D.isSubformField()?D.getFormModel().getFormModel():D.getFormModel();var E=$(C.getFormDOM());var G=E[0].querySelector('input[name="'+D.getLabelName()+'"]');if(G!=null){A.fieldDOMElement=G}else{A.fieldDOMElement=E[0].querySelector('select[name="'+D.getLabelName()+'"]')}return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())};this.getFieldParent=function(){if(A.fieldParent){return A.fieldParent}A.fieldParent=this.getField().closest(".form-field");return A.fieldParent};this.getFieldParentGroup=function(){return this.getFieldParent().parent(".form-group")};this.getDropDownWrapper=function(){return $(this.getField()).prev("div")};this.getParentFormDOM=function(){return C};this.getSectionRow=function(){return this.getField().closest("[elname=formRow]")}});createPrototype(FieldDOM,DOMFactory.prototype);var CurrencyDOM=(function(D,C){FieldDOM.call(this,D,C);var B=C;var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}A.fieldDOMElement=C.getFormDOM().querySelector('input[name="'+D.getLabelName()+'"]');return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())}});createPrototype(FieldDOM,DOMFactory.prototype);var DropdownDOM=(function(B,A){FieldDOM.call(this,B,A);this.getSearchBoxContainer=function(){return $("."+B.getActualLabelName()+"-switch-search .select2-search")};this.getOtherValueContainer=function(){return $((this.getField().closest(".form-field")).find('div[elname="othersinput"]'))};this.getOtherValueField=function(){var C=(this.getOtherValueContainer())[0];if(C){return $(C.querySelector("input"))}return this.getOtherValueContainer().find("input")}});createPrototype(DropdownDOM,FieldDOM.prototype);var DateTimeDOM=(function(B,A){FieldDOM.call(this,B,A);this.getCalIcon=function(){return $(A.getFormDOM().querySelector('span[id="dateButtonEl_'+B.getLabelName()+'"]'))}});createPrototype(DateTimeDOM,FieldDOM.prototype);var TimeDOM=(function(B,A){FieldDOM.call(this,B,A);this.getCalIcon=function(){return $(A.getFormDOM().querySelector('span[id="timeButtonEl_'+B.getLabelName()+'"]'))}});createPrototype(TimeDOM,FieldDOM.prototype);var ImageDOM=(function(C,B){FieldDOM.call(this,C,B);var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}A.fieldDOMElement=B.getFormDOM().querySelector('div[name="'+C.getLabelName()+'"]');return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())};this.getImageIcons=function(){return this.getField()[0].querySelector(".zc-image-icons")};this.getFieldParentDiv=function(){return this.getField().parent()[0].querySelector(".zc-uploadComponents")};this.getFileInput=function(){return $(this.getFieldDOM().querySelector("input[type=file]")).parent()};this.getFileInputEl=function(){return $(this.getFieldDOM().querySelector("input[type=file]"))};this.getFileValue=function(){return $(this.getFieldDOM().querySelector('input[name="'+C.getLabelName()+'-LOCAL"]'))};this.getSourceCompDiv=function(){return this.getSourceComp().parent()};this.getSourceComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+C.getLabelName()+'.source"]'))};this.getImgOptionsCont=function(){return $(this.getFieldDOM().querySelectorAll(".imageOpts"))};this.getAltComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+C.getLabelName()+'.alt"]'))};this.getLinkComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+C.getLabelName()+'.link"]'))};this.getTitleComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+C.getLabelName()+'.title"]'))};this.hiddenDiv=function(){if(this.getFieldParent()[0].querySelector("div[popuptype='openCameraPopup']")==null){return undefined}return this.getFieldParent()[0].querySelector("div[popuptype='openCameraPopup']")}});createPrototype(ImageDOM,FieldDOM.prototype);var URLDOM=(function(C,B){FieldDOM.call(this,C,B);var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}A.fieldDOMElement=B.getFormDOM().querySelector('div[name="'+C.getLabelName()+'"]');return A.fieldDOMElement};this.getTextField=function(){return $(this.getFieldDOM().querySelector("input[type=text]"))};this.getField=function(){return $(this.getFieldDOM())};this.getURLComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+C.getLabelName()+'.url"]'))};this.getUrlOptions=function(){return $(this.getFieldDOM().querySelectorAll(".urlOpts"))};this.getLinkComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+C.getLabelName()+'.link"]'))};this.getTitleComp=function(){return $(this.getFieldDOM().querySelector('input[name="'+C.getLabelName()+'.title"]'))}});createPrototype(URLDOM,FieldDOM.prototype);var FileUploadDOM=(function(C,B){FieldDOM.call(this,C,B);var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}A.fieldDOMElement=B.getFormDOM().querySelector('input[name="'+C.getLabelName()+'"]');return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())};this.getUploadElement=function(){return this.getFileInput()};this.getImageIcons=function(){return this.getField().parent()[0].querySelector(".zc-image-icons")};this.getFieldParentDiv=function(){return this.getField().parent()[0].querySelector(".zc-uploadComponents")};this.getFileInput=function(){var D=(this.getField().parent())[0];if(D){return $(D.querySelector("input[type=file]"))}return this.getField().parent().querySelector("input[type=file]")}});createPrototype(FileUploadDOM,FieldDOM.prototype);var AudioDOM=(function(C,B){FieldDOM.call(this,C,B);var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}A.fieldDOMElement=B.getFormDOM().querySelector('input[name="'+C.getLabelName()+'"]');return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())};this.getUploadElement=function(){return this.getFileInput()};this.getImageIcons=function(){return this.getField().parent()[0].querySelector(".zc-image-icons")};this.getFieldParentDiv=function(){return this.getField().parent()[0].querySelector(".zc-uploadComponents")};this.getFileInput=function(){var D=(this.getField().parent())[0];if(D){return $(D.querySelector("input[type=file]"))}return this.getField().parent().find("input[type=file]")};this.hiddenDiv=function(){return undefined}});createPrototype(AudioDOM,FieldDOM.prototype);var VideoDOM=(function(C,B){FieldDOM.call(this,C,B);var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}A.fieldDOMElement=B.getFormDOM().querySelector('input[name="'+C.getLabelName()+'"]');return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())};this.getUploadElement=function(){return this.getFileInput()};this.getImageIcons=function(){return this.getField().parent()[0].querySelector(".zc-image-icons")};this.getFieldParentDiv=function(){return this.getField().parent()[0].querySelector(".zc-uploadComponents")};this.getFileInput=function(){var D=(this.getField().parent())[0];if(D){return $(D.querySelector("input[type=file]"))}return this.getField().parent().find("input[type=file]")};this.hiddenDiv=function(){return this.getFieldParentDiv().querySelector("div[popuptype='openVideoPopup']")}});createPrototype(VideoDOM,FieldDOM.prototype);var TextAreaDOM=(function(D,C){FieldDOM.call(this,D,C);var A=this;this.fieldDOMElement=null;var B=D.isSubformField()?D.getFormModel().getFormModel():D.getFormModel();this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}if($(C.getFormDOM()).hasClass("zc-right-panel")||$(C.getFormDOM()).hasClass("popupConentContainer")){A.fieldDOMElement=C.getFormDOM().querySelector('textarea[name="'+D.getLabelName()+'"]')}else{A.fieldDOMElement=document.querySelector("div[id='"+B.getFormLinkName()+"_"+B.getRandStr()+"'] form[name='"+B.getFormLinkName()+"'] textarea[name='"+D.getLabelName()+"']")}return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())}});createPrototype(TextAreaDOM,FieldDOM.prototype);var RichTextDOM=(function(B,A){TextAreaDOM.call(this,B,A);this.getIFrameBody=function(){return $(A.getFormDOM().querySelector('div[name="'+B.getLabelName()+'"] iframe.ze_area')).contents().find("body.ze_body")};this.getRTDiv=function(){return $(this.getField()).siblings('div[name="'+B.getLabelName()+'"]')}});createPrototype(RichTextDOM,TextAreaDOM.prototype);var ExternalDOM=(function(B,A){FieldDOM.call(this,B,A);this.getActionLink=function(){return $((this.getField().parent())[0].querySelector("a[elname=showModule]"))};this.getClearLink=function(){return $((this.getField().parent())[0].querySelector("a[elname=clearModule]"))}});createPrototype(ExternalDOM,FieldDOM.prototype);var RadioDOM=(function(C,B){DropdownDOM.call(this,C,B);var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}var D=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();if(C.isSearchEnabled()||C.isSubformField()){if($(B.getFormDOM()).hasClass("popupConentContainer")){A.fieldDOMElement=B.getFormDOM().querySelector('input[name="'+C.getLabelName()+'"]')}else{A.fieldDOMElement=document.querySelector("div[id='"+D.getFormLinkName()+"_"+D.getRandStr()+"'] form[name='"+D.getFormLinkName()+"'] input[name='"+C.getLabelName()+"']")}}else{if($(B.getFormDOM()).hasClass("popupConentContainer")){A.fieldDOMElement=B.getFormDOM().querySelector('div[name="parentOf-'+C.getLabelName()+'"]')}else{A.fieldDOMElement=document.querySelector("div[id='"+D.getFormLinkName()+"_"+D.getRandStr()+"'] form[name='"+D.getFormLinkName()+"'] div[name='parentOf-"+C.getLabelName()+"']")}}return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())};this.getOptionsDiv=function(){return $(B.getFormDOM().querySelector('div[name="parentOf-'+C.getLabelName()+'"]'))};this.getOtherTemplate=function(){var D=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();return'<div class="choice-table-cell"><span><input id="'+D.getRandStr()+"_othersVal"+C.getFormComponentId()+'" elname="othersVal'+C.getFormComponentId()+'" class="customRadio zc_radio" name="'+C.getLabelName()+'" type="radio" value="-otherVal-" ><label  for="'+D.getRandStr()+"_othersVal"+C.getFormComponentId()+'" elname="othersVal'+C.getFormComponentId()+'"></label><label for="'+D.getRandStr()+"_othersVal"+C.getFormComponentId()+'" elname="othersVal'+C.getFormComponentId()+'" >'+C.getOthersOption()+"</label> </span></div>"};this.getOptionTemplate=function(){var D=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();return'<div class="choice-table-cell"><span><input id="'+D.getRandStr()+"_radioEl_zc-"+C.getLabelName()+'_${INDEX}" class="customRadio" elname="radioEl_zc-'+C.getLabelName()+'_${INDEX}" class="customRadio" name="'+C.getLabelName()+'"  type="radio" value="${CHOICE.ID}"><label for="'+D.getRandStr()+"_radioEl_zc-"+C.getLabelName()+'_${INDEX}" elname="radioEl_zc-'+C.getLabelName()+'_${INDEX}" ></label><label for="'+D.getRandStr()+"_radioEl_zc-"+C.getLabelName()+'_${INDEX}" elname="radioEl_zc-'+C.getLabelName()+'_${INDEX}" >${CHOICE.TEXT}</label> </span></div>'}});createPrototype(RadioDOM,DropdownDOM.prototype);var CheckboxDOM=(function(C,B){DropdownDOM.call(this,C,B);var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}var D=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();if(C.isSearchEnabled()||C.isSubformField()){if($(B.getFormDOM()).hasClass("popupConentContainer")){A.fieldDOMElement=B.getFormDOM().querySelector('input[name="'+C.getLabelName()+'"]')}else{A.fieldDOMElement=document.querySelector("div[id='"+D.getFormLinkName()+"_"+D.getRandStr()+"'] form[name='"+D.getFormLinkName()+"'] input[name='"+C.getLabelName()+"']")}}else{if($(B.getFormDOM()).hasClass("popupConentContainer")){A.fieldDOMElement=B.getFormDOM().querySelector('div[name="parentOf-'+C.getLabelName()+'"]')}else{A.fieldDOMElement=document.querySelector("div[id='"+D.getFormLinkName()+"_"+D.getRandStr()+"'] form[name='"+D.getFormLinkName()+"'] div[name='parentOf-"+C.getLabelName()+"']")}}return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())};this.getOptionsDiv=function(){return $(B.getFormDOM().querySelector('div[name="parentOf-'+C.getLabelName()+'"]'))};this.getOptionTemplate=function(){var D=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();return'<div class="choice-table-cell"><label><span><input id="'+D.getRandStr()+"_checkboxesEl_zc-"+C.getLabelName()+'_${INDEX}" elname="checkboxesEl_zc-'+C.getLabelName()+'_${INDEX}"  class="customCheckbox" name="'+C.getLabelName()+'" type="checkbox"  value="${CHOICE.ID}"><label for="'+D.getRandStr()+"_checkboxesEl_zc-"+C.getLabelName()+'_${INDEX}" elname="checkboxesEl_zc-'+C.getLabelName()+'_${INDEX}"  ></label><label for="'+D.getRandStr()+"_checkboxesEl_zc-"+C.getLabelName()+'_${INDEX}" elname="checkboxesEl_zc-'+C.getLabelName()+'_${INDEX}"  >${CHOICE.TEXT}</label></span></label></div>'}});createPrototype(CheckboxDOM,DropdownDOM.prototype);var SubformDOM=(function(C,B){FieldDOM.call(this,C,B);var D;var A=this;this.formDOMElement=B.formDOMElement;this.fieldDOMElement=null;this.getFormDOM=function(){return(D!=undefined)?D[0]:this.getField()[0]};this.getForm=function(){return(D!=undefined)?D:this.getField()};this.setRow=function(E){D=E};this.getRow=function(F){var E=(this.getInnerWrapper())[0];if(E){return $(E.querySelector('div[elName=dataRow][rowNo="'+F+'"]'))}return this.getInnerWrapper().find('div[elName=dataRow][rowNo="'+F+'"]')};this.getDeleteLink=function(F){var E=(this.getRow(F))[0];if(E){return $(E.querySelector('a[elname="zc-hideFormFieldEl"]'))}return this.getRow(F).find('a[elname="zc-hideFormFieldEl"]')};this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}var F=C.isSubformField()?C.getFormModel().getFormModel():C.getFormModel();var E=$(B.getFormDOM());if(E.hasClass("popupConentContainer")){A.fieldDOMElement=E[0].querySelector('input[name="'+C.getLabelName()+'"]')}else{A.fieldDOMElement=document.querySelector("div[id='"+F.getFormLinkName()+"_"+F.getRandStr()+"'] form[name='"+F.getFormLinkName()+"'] div[name='"+C.getLabelName()+"']")}return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())};this.getAddNewLink=function(){var E=(this.getField().parent())[0];if(E){return $(E.querySelectorAll("span.add_value_link > a"))}return this.getField().parent().find("span.add_value_link > a")};this.getBottomAddNewLink=function(){return this.getField().siblings("#"+C.getLabelName()+"_addNewLine")};this.getDeleteLinks=function(){var E=(this.getField().parent())[0];if(E){return $(E.querySelectorAll('a[elname="zc-hideFormFieldEl"]'))}return this.getField().parent().find('a[elname="zc-hideFormFieldEl"]')};this.getPlaceHolder=function(){return $(this.getFieldDOM().querySelector("#subformplaceholder"))};this.getInnerWrapper=function(){return $(this.getFieldDOM().querySelectorAll(".subform-inner-wrapper"))};this.getScrollWrapper=function(){return $(this.getFieldDOM().querySelectorAll(".subform-scroll-wrapper"))};this.getWrappingRow=function(){return this.getFieldParentGroup().closest('[elname="formRow"]')}});createPrototype(SubformDOM,FieldDOM.prototype);var CompositeDOM=(function(C,B){FieldDOM.call(this,C,B);var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}A.fieldDOMElement=B.getFormDOM().querySelector('div[name="'+C.getLabelName()+'"]');return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())};this.getChildField=function(D){return $(this.getFieldDOM().querySelector("input[name='"+D+"'] , select[name='"+D+"']"))};this.getDropdown=function(D){return $(this.getFieldDOM().querySelector("select[name='"+D+"']"))};this.getAllChildFields=function(){return $(this.getFieldDOM().querySelectorAll("span[class*=-wrapper]"))}});createPrototype(CompositeDOM,FieldDOM.prototype);var AddressDOM=(function(B,A){CompositeDOM.call(this,B,A);this.getPrimaryOuterEl=function(){return $(this.getFieldDOM().querySelectorAll(".ADDRESS_LINE_1-wrapper"))};this.getPostalCodeEl=function(){return $(this.getFieldDOM().querySelectorAll(".POSTAL_CODE-wrapper"))};this.getPrimarySelectFld=function(){return $(this.getPrimaryOuterEl()[0].querySelectorAll("input.form-control"))};this.getPrimaryInput=function(){return $(this.getFieldDOM().querySelector("input[type=text]"))};this.getCountrySelect=function(){return $(this.getFieldDOM().querySelector("input.country-sel"))};this.getDropDownWrapper=function(){return $(this.getCountrySelect()).prev("div")};this.getInputFields=function(){return $(this.getFieldDOM().querySelectorAll("input[type=text]"))};this.getAdjustLocationIcon=function(){return $(this.getFieldDOM().querySelectorAll(".zc-adjustLocationIcon"))};this.getLocationContainer=function(){return $(this.getFieldDOM().querySelectorAll(".zc-location-container"))};this.getAdjustLocationWrapper=function(){return $(this.getFieldDOM().querySelectorAll(".zc-adjust_location-wrap"))};this.getLocationPlaceHolder=function(){return $(this.getFieldDOM().querySelectorAll(".zc-location-placeholder"))};this.getCoordinateInputs=function(){return $(this.getFieldDOM().querySelectorAll(".zc-adjust-latitude, .zc-adjust-longitude"))}});createPrototype(CompositeDOM,FieldDOM.prototype);var NameDOM=(function(B,A){CompositeDOM.call(this,B,A);this.getPrefixSelect=function(){return $(this.getFieldDOM().querySelector("select.prefix-sel"))};this.getPrimaryInput=function(){return $(this.getFieldDOM().querySelector("input[type=text]"))};this.getInputFields=function(){return $(this.getFieldDOM().querySelectorAll("input[type=text]"))};this.getDropDownWrapper=function(){return $(this.getPrefixSelect()).prev("div")}});createPrototype(NameDOM,CompositeDOM.prototype);var PhoneNumberDOM=(function(B,A){FieldDOM.call(this,B,A);this.getAllPhoneFields=function(){return $(A.getFormDOM().querySelectorAll(".form-phone-field input[type='tel']"))};this.getFlagContainer=function(){var C=(this.getFieldParent())[0];if(C){return $((this.getFieldParent())[0].querySelectorAll(".flag-container"))}return this.getFieldParent().find(".flag-container")}});createPrototype(PhoneNumberDOM,FieldDOM.prototype);var SignatureDOM=(function(C,B){FieldDOM.call(this,C,B);var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}A.fieldDOMElement=B.getFormDOM().querySelector('div[name="'+C.getLabelName()+'"]');return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())};this.getSignatureContainer=function(){return $(this.getFieldDOM().querySelector("div[elName=signatureEle]"))};this.getSignatureTextarea=function(){return $(this.getFieldDOM()).find('textarea[name="'+C.getLabelName()+'"]')};this.getSignature=function(){return $(this.getFieldDOM().querySelector("div[eleName=signature]"))};this.getClearEle=function(){return $(this.getFieldDOM().querySelector("a[eleName=signatureClear]"))};this.getToggleChangeEle=function(){return $(this.getFieldDOM().querySelector("a[eleName=zc-togglesignature]"))};this.getToggleRestoreEle=function(){return $(this.getFieldDOM().querySelector("a[eleName=zc-togglesignature-restore]"))};this.getEditEle=function(){return $(this.getFieldDOM().querySelector("div[elName=editEle-signature]"))}});createPrototype(SignatureDOM,FieldDOM.prototype);var PlainTextDom=(function(C,B){FieldDOM.call(this,C,B);var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}A.fieldDOMElement=B.getFormDOM().querySelector('div[name="'+C.getLabelName()+'"]');return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())}});createPrototype(PlainTextDom,FieldDOM.prototype);var SectionDom=(function(C,B){FieldDOM.call(this,C,B);var A=this;this.fieldDOMElement=null;this.getFieldDOM=function(){if(A.fieldDOMElement){return A.fieldDOMElement}A.fieldDOMElement=B.getFormDOM().querySelector('div[name="'+C.getLabelName()+'"]');return A.fieldDOMElement};this.getField=function(){return $(this.getFieldDOM())}});createPrototype(SectionDom,FieldDOM.prototype);var DecisionBoxDOM=(function(C,B){FieldDOM.call(this,C,B);var A=this;this.fieldParent=null;this.getFieldParent=function(){if(A.fieldParent){return A.fieldParent}A.fieldParent=this.getField().closest(".decision-box-field");return A.fieldParent}});createPrototype(DecisionBoxDOM,FieldDOM.prototype);var IntegrationDOM=(function(B,A){FieldDOM.call(this,B,A);this.getOptionsDOM=function(){return $("body").find("#zc-combined-lookup-popup")};this.getScrollMask=function(){return $("body").find(".zc-scroll-mask")};this.getInputField=function(){return this.getField()};this.getOptionsTable=function(){return this.getOptionsDOM().find("#combinedlookupoptionstable")};this.getSearchOptionsTable=function(){return this.getOptionsDOM().find(".zc-combined-lookup-search-table")};this.getSearchHeader=function(){return this.getOptionsDOM().find("#combinedlookupsearchtable")};this.getSearchTableHeader=function(){return this.getOptionsDOM().find("thead")};this.getSearchLayout=function(){return this.getOptionsTable().find("tbody[layoutType=search]")};this.getOptionsLayout=function(){return this.getOptionsTable().find('tbody[layoutType="options"]')};this.getDefaultLayout=function(){return this.getOptionsTable().find("tbody[layoutType=default]")};this.getMessageContainer=function(){return this.getDefaultLayout().find("#combinedlookupmessagecontainer")};this.getCurrentLayout=function(){return this.getOptionsTable().find("tbody:visible:first")};this.getHighlightedRow=function(){return this.getCurrentLayout().find(".combined-lookup-row-highlighted")};this.getSearchSpinner=function(){return this.getOptionsDOM().find(".zc-combined-lookup-spinner")};this.getValueDeselectButton=function(){return this.getField().parent().find(".zc-integration-close")};this.getDropArrow=function(){return this.getField().parent().find(".zc-integration-drop-arrow")};this.getSearchBoxes=function(){return this.getSearchTableHeader().find("input")};this.setSearchTriggerInputElement=function(C){this.searchInputEle=C};this.getSearchTriggerInputElement=function(){return this.searchInputEle}});createPrototype(IntegrationDOM,FieldDOM.prototype);var FormView=(function(B,C){ViewFactory.call(this,B);var A=this;this.bindSubmit=function(D){$(B.getFormDOM()).on("submit",function(E){E.preventDefault();if(D==1){C.submitForm()}})};this.getFormContainer=function(){return $(B.formOuterWrapper)};this.bindScrollEvents=function(){$(B.getFormContainer()).on("scroll",function(D){$(document).trigger("scrollChange",D)})};this.fixFormHeader=function(){this.adjustFormHeight()};this.adjustFormHeight=function(){$(B.getFormDOM().querySelector(".zc-form-scroll-wrapper")).css("max-height",this.getScrollHeight()+"px")};this.getScrollHeight=function(){var D=this.findElementHeigth("form-header"),E=this.findElementHeigth("zc-form-footer"),F=($("#zc-component").height()-D-E),G=this.getFormContainerPadding();return(F-G)};this.getFormContainerPadding=function(){var D=this.getFormContainer();return D.outerHeight()-D.height()};this.getFormContainerLeftRightPadding=function(){var D=B.formOuterWrapper;var E=window.getComputedStyle(D,null);return parseInt(E.paddingLeft,10)+parseInt(E.paddingRight,10)};this.findFormContainerHeight=function(){return $(B.getFormDOM()).closest(".form-outer-wrapper")[0].getBoundingClientRect().height};this.findElementHeigth=function(D){return B.getFormDOM().querySelector("."+D).getBoundingClientRect().height};this.findFieldLabelWidth=function(D){return B.getFormDOM().querySelector("."+D).getBoundingClientRect().width};this.plainTextWidth=function(D){return B.getFormDOM().querySelector("div[name='"+D.substring(3)+"']").getBoundingClientRect().width};this.findCaptchaLabelWidth=function(){var D=C.getModel();var E=$(B.getFormDOM().querySelector("div[name='zc-captcha']")).parent();return(D.hasCaptcha())?E[0].querySelector(".form-label").getBoundingClientRect().width:0};this.findFieldInputWidthEveryColumn=function(D){var E=B.getFormDOM().querySelector(".column-block ."+D+"-group > .form-field");if(E!=null){return E.getBoundingClientRect().width}return 0};this.decisionBoxLabelWidth=function(D){labelWidth=$(B.getFormDOM().querySelector("."+D+" .decision-box-label")).css("width");labelWidth=labelWidth.substring(0,labelWidth.length-2);return Number(labelWidth)};this.decisionBoxInputWidth=function(D){D=D.substring(3,D.length);inputWidth=$(B.getFormDOM().querySelector("input[name='"+D+"']")).css("width");inputWidth=inputWidth.substring(0,inputWidth.length-2);return Number(inputWidth)};this.disableButton=function(D){this.getButton(D).attr("disabled","disabled")};this.enableButton=function(D){this.getButton(D).removeAttr("disabled")};this.getContainerWidth=function(){return B.getFormDOM().getBoundingClientRect().width};this.getContainerHeight=function(){return B.getFormDOM().getBoundingClientRect().height};this.showFormInfo=function(D){B.getInfoLink().style.display=null;$(B.getInfoLink()).find("a").click(function(){C.showInfo(D)})};this.hideFormInfo=function(){B.getInfoLink().style.display="none"};this.showFormErrorInfo=function(D){B.getErrorMsgCont().style.display=null;B.getErrorMsgCont().innerHTML=D};this.hideFormErrorInfo=function(){B.getErrorMsgCont().style.display="none"};this.addStyleToForm=function(J,F){this.removeStyleFromForm();var H=B.getFormDOM().querySelector("#"+J);var G=H.sheet;var E=F.split("\n");for(var D in E){var I=E[D];if(!isNull(I)){G.insertRule(I,D)}}return H};this.removeStyleFromForm=function(){if(!$("#zppagesLive")[0]){$(document.querySelectorAll(".page_content_wrapper")).removeClass("zc-page-content-wrapper")}if($(document.querySelectorAll(".page_content_wrapper")).find(".zc-htmlpage-old-table").length==0){$(document.querySelectorAll(".page_content_wrapper")).removeClass("zc-view-embed-single-report")}};this.getButton=function(D){return B.getButton(D)};this.bindCaptchaFocus=function(){var E=B.getCaptchaInput();var D=E.closest(".form-field").parent(".form-group");$(E).focus(function(){$(D).addClass("zc-focus");if(!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}).blur(function(){if($(D).hasClass("zc-focus")){$(D).removeClass("zc-focus")}if(LIB._isNull($(E).val())&&$(D).hasClass("zc-label-float")){$(D).removeClass("zc-label-float")}})};this.getResetCaptchIcon=function(){return B.getResetCaptchIcon()};this.resetCaptcha=function(G){var E=B.getCaptchaImg();var H='<span id="loadingImg" class="zc-capcha-loading"><i class="fa fa-circle-o-notch fa-spin"></i></span>';E.after(H);E.siblings("#refreshCaptcha").hide();E.addClass("zc-captcha-img-loading");E.attr("src","");if(E.length>0){B.getCaptchaInput().val("");var D=C.getModel();var G=G+"?time="+new Date().getTime()+"&formid="+D.getFormId();if(D.hasPrivateLink()){G=G+"&privatelink="+D.getPrivateLink();if(D.getViewLinkName()!=undefined&&D.getAccessType()==2){G=G+"&viewLinkName="+D.getViewLinkName()+"&formAccessType=2"}}var F=B.getCaptchaDigest();$.ajax({url:G,method:"GET",progress:function(){E.attr("src","")},success:function(I){capUrl=I;cdigest=capUrl.slice(capUrl.indexOf("cdigest="),(capUrl.indexOf("&")));cdigest=cdigest.split("cdigest=")[1];G=I;if(D.hasPrivateLink()){G=G+"&privatelink="+D.getPrivateLink();if(D.getViewLinkName()!=undefined&&D.getAccessType()==2){G=G+"&viewLinkName="+D.getViewLinkName()+"&formAccessType=2"}}F.val(cdigest);E.attr("src",I);E.siblings('span[id="loadingImg"]').remove();E.siblings("#refreshCaptcha").show();E.removeClass("zc-captcha-img-loading")}})}};this.showCaptchaError=function(D){var E=$('<div class="fieldErrorMsg zc-dem-box-sizing">'+D+"</div>");var F=B.getCaptchaInput();F.parent().append(E).addClass("validationError");if(C.getModel().getFormAlign()==FormAlign.INPLACE){F.blur()}};this.clearCaptchaError=function(){B.getCaptchaInput().parent().removeClass("validationError");$((B.getCaptchaInput().parent())[0].querySelector(".fieldErrorMsg")).remove()};this.getCaptchaVal=function(){return B.getCaptchaInput().val()};this.getCaptchaDigest=function(){return B.getCaptchaDigest().val()};this.showOverlay=function(){return B.getFormOverlay().style.display=null};this.hideOverlay=function(){return B.getFormOverlay().style.display="none"};this.showProgress=function(){return B.getPreloader().style.display=null};this.hideProgress=function(){return B.getPreloader().style.display="none"};this.bindBulkEditInput=function(E){var D=B.getBulkEditInput();_config={placeholder:"- "+i18n.bulkeditselcolumn+" -",data:E,multiple:true,escapeMarkup:function(F){return F}};D.select2(_config).on("change",function(G){var F=(G.added)?G.added:G.removed;C.showhideField(F.id,(G.added!=undefined))});D.parent().find(".select2-input").attr("name","zc-sel2-inp-bulkedit");D.parent().find(".select2-input").attr("autocomplete","new-zc-sel2-inp-bulkedit");D.parent().find(".select2-focusser.select2-offscreen").attr("name","zc-sel2-foc-bulkedit");D.parent().find(".select2-focusser.select2-offscreen").attr("autocomplete","new-zc-sel2-foc-bulkedit")};this.getBulkEditSelFields=function(){var F=B.getBulkEditInput().select2("data"),G=[];for(var E=0,D=F.length;E<D;E++){G.push(F[E].id)}return G};this.closeForm=function(D){$(B.getFormContainer()).html(D)};this.applyStyles=function(F){for(var D in F){var I=F[D];var G=B.getFormDOM();var E=/^([A-Fa-f0-9]{6})$/;if((D.indexOf("zc_")==0)&&E.test(I)){I="#"+I}switch(D){case"zc_Header":H(".form-header","display",I=="true"?"block":"none");break;case"zc_SuccMsg":break;case"zc_NextUrl":break;case"zc_OpenUrlIn":break;case"zc_BgClr":H(".formContainer","background-color",I);break;case"zc_BdrClr":H(".form-table","border","1px solid "+I);break;case"zc_HdrClr":H(".form-header","background-color",I);break;case"zc_HdrHeight":$(G.querySelector(".form-header")).css("height",I+"px");break;case"zc_HdrFont":H(".form-title","font-family",I);break;case"zc_HdrFontSize":$(G.querySelector(".form-title")).css("font-size",I+"px");break;case"zc_HdrFontClr":H(".form-title","color",I);break;case"zc_FtrClr":H(".form-action-container","background-color",I);break;case"zc_FtrHeight":$(G.querySelector(".form-action-container")).css("height",I+"px");break;case"zc_BtnBgClr":H(".zc-live-primary-btn, .zc-live-secondary-btn","background-color",I);break;case"zc_BtnClr":H(".zc-live-primary-btn, .zc-live-secondary-btn","color",I);break;case"zc_BtnMovrClr":$(G.querySelectorAll(".zc-live-primary-btn")).attr("onmouseover","this.className='zc-formbutton-hover';this.style.color='"+I+"'");break;case"zc_BtnFont":H(".zc-live-primary-btn, .zc-live-secondary-btn","font-family",I);break;case"zc_BtnFontSize":H(".zc-live-primary-btn, .zc-live-secondary-btn","font-size",I+"px");break;case"zc_LblClr":H(".form-label","background-color",I);break;case"zc_LblWidth":$(G.querySelectorAll(".form-label")).css("width",I+"px");break;case"zc_LblFontClr":H(".form-label","color",I);break;case"zc_LblFont":H(".zc-label-text","font-family",I);break;case"zc_LblFontSize":H(".form-label","font-size",I+"px");break;case"zc_InpClr":H(".form-group input, .form-group select, .form-group textarea, .form-control","background-color",I);break;case"zc_InpWidth":$(G.querySelectorAll(".form-group input, .form-group select, .form-group textarea, .form-control")).css("width",I+"px");break;case"zc_InpFieldFontClr":H(".form-group input, .form-group select, .form-group textarea, .form-control","color",I);break;case"zc_InpFieldFont":H(".form-group input, .form-group select, .form-group textarea, .form-control","font-family",I);break;case"zc_InpFieldFontSize":H(".form-group input, .form-group select, .form-group textarea, .form-control, .form-group .choice-table-row, .form-group .select2-chosen","font-size",I+"px");break;case"zc_freezePublishPreview":$("#zc-component div").css("pointer-events","none");break}}function H(L,K,J){var M=G.querySelectorAll(L);if(L==".form-table"){G.style.setProperty(K,J,"important")}else{if(M!=undefined){M.forEach(function(N){N.style.setProperty(K,J,"important")})}}}};this.isPopup=function(){return $(B.getFormContainer()).parent().hasClass("popupConentContainer")||$(B.getFormContainer()).parent().parent().hasClass("popupConentContainer")};this.getGeoOverlay=function(){return B.getGeoOverlay()};this.hidePreloader=function(){return B.getPreloader().classList.add("hide")};this.showPreloader=function(){return B.getPreloader().classList.remove("hide")}});FormView.prototype=Object.create(ViewFactory.prototype);var FieldView=(function(D,C,B){ViewFactory.call(this,D);var A=this;this.bindChange=function(){var F=C.getModel();var E=F.getComponentType();if(E==FieldType.NUMBER||E==FieldType.PERCENTAGE){D.getField().on("change blur",function(){if($((D.getFieldParent()).find(".fieldErrorMsg")).html()==i18n.mandatoryMsg){return }C.validate()});D.getField().on("input",function(){C.validate();var H=D.getField().val();if(isNull(H.replace(/^[+\-.]/,""))){C.clearError()}if(!isNull(H.replace(/^[+\-.]/,""))&&!isNumber(H)||(/\s+$/).test(H)){var I=H.replace(/[^\d\.\+-]/g,"");D.getField().val(I)}})}else{if(F.getComponentType()==FieldType.RICH_TEXT_AREA){var G=C.getView().zeObj.doc!=undefined?$(C.getView().zeObj.doc.body):D.getIFrameBody();G.on("blur",function(){C.validate()})}else{if(C.getModel().getComponentType()!=FieldType.SUB_FORM_GRID&&C.getModel().getComponentType()!=FieldType.CURRENCY){D.getField().on("change",function(){C.validate()})}}}if(F.isAddressSubField()){D.getField().on("change",function(){var J=C.getParentField();var I=J.getModel();if(I.isCaptureGeoCoordinates()){J.geocodeAddress(true)}else{var H=J.getView();H.updateZMAPLocation("","",true)}})}else{if(F.getComponentType()==FieldType.SIGNATURE){D.getField().on("change",function(){if(!A.isResized()){$(this).trigger("onuserinput")}})}else{if(!(F.isZiaInput()&&F.isZiaOnUserInputExist())&&!F.isCompositeField()&&E!=FieldType.DATE&&E!=FieldType.IMAGE&&E!=FieldType.DATE_TIME&&E!=FieldType.TIME&&E!=FieldType.CURRENCY){D.getField().on("change",function(){$(this).trigger("onuserinput")})}}}};this.bindFieldHelpText=function(){var J=D.getFieldParentGroup().parent().width();var E;var G=C.getModel();var F=G.getComponentType();if(!A.isTopAlignment()&&!A.isFloatLabelAlignment()){var I=D.getFieldParentGroup().find(".form-label").outerWidth();E=J-I}else{E=J}var H=$('<div class="zc-help-txt" style="white-space:pre-line;width:'+(E-20)+'px"></div>');H.text(G.getTitle());D.getFieldParent().append(H)};this.adjustLabelWidth=function(J,Q){var O=C.getModel();if(A.isFloatLabelAlignment()){if(O.isCompositeSubField()){var N=D.getField();var M=$($(N).parent()[0].querySelector(".zc-subfield-label")).addClass("adjustInplaceWidth");$(M).css("max-width",($(N).width()-5)+"px")}else{if(!O.isSubformField()){var E=$(D.getFieldParentGroup()[0].querySelector(".form-label").querySelector("span"));if(E!=undefined&&E!=null){$(E).addClass("adjustInplaceWidth");var F=D.getFieldParent();if(F!=undefined){var G=$(F).width();var P=$(F).height();if(!Q){switch(J){case FieldType.EMAIL_ADDRESS:case FieldType.PERCENTAGE:case FieldType.CURRENCY:G-=$(F[0].querySelector(".zc-prepend-icon")).width();break;case FieldType.DATE:case FieldType.DATE_TIME:G-=$(F[0].querySelector(".calcIcon")).width();break;case FieldType.INLINE_PICK_LIST:case FieldType.DROPDOWN:case FieldType.RADIO:case FieldType.SYSTEM_LOOKUP:G-=20;break;case FieldType.PHONE_NUMBER:var K=($(F[0].querySelector(".flag-container")).width());var H=parseInt($(E).parent().css("margin-left"));G-=!isNaN(H)?Math.max(H,K):K;break;case FieldType.IMAGE:case FieldType.FILE_UPLOAD:case FieldType.AUDIO:case FieldType.VIDEO:if(O.getDefaultValue()==""||O.getDefaultValue==undefined){var L=$(D.getImageIcons().querySelector(".calcIcon:last-child")).width();var O=C.getModel();if(J==FieldType.IMAGE){G=A.calculateWidthForRestore(O.getImageType(),G,L+1)}else{if(J==FieldType.FILE_UPLOAD){var I=O.getCloudService();if(I==""||I.indexOf("mycomputer")==-1){G=G-L}else{G=G-(2*L)}}else{G=G-(2*L)}}}break;case FieldType.CHECK_BOXES:if(D.getField().data("select2")==undefined){return }break}}$(E).css({"max-width":(G-20)+"px"});$(E).parent().css({"max-width":(G-20)+"px"})}}}}}};this.showHelpText=function(){if(C.getModel().getComponentType()==FieldType.DECISIONBOX){$(D.getFieldParent().parent()[0].querySelector(".zc-help-txt")).show()}else{$(D.getFieldParent()[0].querySelector(".zc-help-txt")).show()}};this.hideHelpText=function(){if(C.getModel().getComponentType()==FieldType.DECISIONBOX){$(D.getFieldParent().parent()[0].querySelector(".zc-help-txt")).hide()}else{$(D.getFieldParent()[0].querySelector(".zc-help-txt")).hide()}};this.bindFieldDescription=function(){var H=C.getModel();var G={tooltip:H.getTitle(),position:ZCGlobal.appDirectionMeta.tooltipPosition};if(H.isSubformField()){var E=$(B.getDOM().getFormDOM()).parent()[0].querySelector("."+H.getClassName()+"-group");if(E!=null&&E!=undefined){G.tooltipelem=E.querySelector(".zc-label-text");$(G.tooltipelem).tooltipPositionCalc(G);$(D.getField()).parent().tooltipPositionCalc(G)}}else{var F=H.getComponentType();if(F==FieldType.NAME){G.containsSubfield=true;G.extraHeight=($(D.getField()).height()-$(D.getField()).find("#firstname").height())}else{if(F==FieldType.ADDRESS){G.containsSubfield=true;G.extraHeight=($(D.getPrimaryOuterEl()).height()-$(D.getPrimaryInput()).height())}}$(D.getField()).parent().tooltipPositionCalc(G)}};this.isFloatLabelAlignment=function(){fieldModel=D.getModel();var E=fieldModel.isSubformField()?fieldModel.getFormModel().getFormModel():fieldModel.getFormModel();return E.getFormAlign()==FormAlign.INPLACE?true:false};this.isTopAlignment=function(){fieldModel=D.getModel();var E=fieldModel.isSubformField()?fieldModel.getFormModel().getFormModel():fieldModel.getFormModel();return E.getFormAlign()==FormAlign.TOP?true:false};this.bindFocus=function(){var G=D.getField();var E=D.getFieldParentGroup();var F=D.getModel().getComponentType();if(!(F==FieldType.DECISIONBOX||F==FieldType.SUB_FORM_GRID)){if(!LIB._isNull($(G).val())&&!$(E).hasClass("zc-label-float")){$(E).addClass("zc-label-float")}$(G).on("focus",function(){$(E).addClass("zc-focus");if(!$(E).hasClass("zc-label-float")){$(E).addClass("zc-label-float")}if(F!=FieldType.PHONE_NUMBER){A.adjustLabelWidth(C.getModel().getComponentType(),true)}}).on("blur",function(){if($(E).hasClass("zc-focus")){$(E).removeClass("zc-focus")}if(C.getModel().isCompositeSubField()){if(!LIB._isNull($(G).val())){$(G).parent().addClass("zc-label-float")}}else{if(LIB._isNull($(G).val())&&$(E).hasClass("zc-label-float")){$(E).removeClass("zc-label-float");if(F!=FieldType.PHONE_NUMBER){A.adjustLabelWidth(C.getModel().getComponentType(),false)}}else{if(!$(E).hasClass("zc-label-float")){$(E).addClass("zc-label-float")}}}})}};this.bindFormula=function(){var H=C;var I=H.getModel().isSubformField()?H.getFormController().getFormController():H.getFormController();var F=I.getWorkflowController();if(F==undefined){F=new WorkflowController(I)}var E=false;var G=function(K){if(H instanceof SubformController&&$(K.target).attr("elname")!="subformdiv"){return }if(!E){var J={};if(H.getModel().isSubformField()){J.fieldname=H.getFormController().getModel().getActualLabelName();J.subformfieldname=H.getModel().getActualLabelName();J.rowseqid=H.getModel().getRowID()}else{J.fieldname=H.getModel().getActualLabelName()}F.triggerFormulaAction(H,J);E=true}$(this).trigger("formulacalc")};D.getField().change(G).on("triggerformula",G)};this.bindZia=function(){var I=C;var H=I.getFormController();var K=I.getModel().isSubformField()?H.getModel().getFormModel():H.getModel();var G=I.getModel().getComponentType();var J=function(P){if(I.getModel().isSubformField()){return H.getModel().getSubformField(I.getModel().getRowID(),P)}else{return H.getFieldController(P)}};if(K.getAccessType()==FormControllerType.BULKEDITFORM){return }var M=function(S){var Q=I.getModel().isZiaOnUserInputExist();if(Q){var P=F(Q);var R=function(){D.getField().trigger("onuserinput")};Promise.all(P).then(R,R)}else{F()}};if(G!=FieldType.IMAGE){D.getField().change(M)}D.getField().on("triggerzia",M);var F=function(R){var P=[];var U=I.getModel().getDependentZiaFields();for(var Q=0;Q<U.length;Q++){var T=J(U[Q]);var S=L(T);if(S!=undefined){if(R){P.push(new Promise(function(W,V){E(S,I,W,V)}))}else{E(S,I)}}}return P};var L=function(R){var Q={};var P=N(R);if(P==undefined||P.length==0){R.setFieldValue("");return }Q.dependentFieldValues=JSON.stringify(P);Q.ziaLabelName=R.getModel().getActualLabelName();if(R.getModel().isSubformField()){Q.subform=R.getFormController().getModel().getActualLabelName()}Q[ZCGlobal.csrfTokenName]=ZCGlobal.csrfToken;if(K.hasPrivateLink()&&!isNull(K.getPrivateLink())){Q.privatelink=K.getPrivateLink()}return Q};var N=function(V){var Q=V.getModel().getZiaDependentFields();var R=[];for(var T=0;T<Q.length;T++){var U=J(Q[T]);var S=U.getModel().getActualLabelName();if(U instanceof ImageController){var P=JSON.parse(U.getValue());if(isNull(P["zcsource-"+S])){return }}else{if(U.getValue()===""){return }}R.push({depField:S,value:U.getValue()})}return R};var O=function(S,Q){var R=J(S.labelName);var P=S.value;if(P===undefined||P===""){R.getView().showInfo("-NA-")}else{R.setFieldValue(P)}if(Q!=undefined){Q()}};var E=function(R,Q,T,S){var P=Q.getView();$.ajax({url:C.getURL().getZiaCalcURL(),method:"POST",beforeSend:function(U){P.active=true;Q.showLoader()},data:R,success:function(U){P.active=false;Q.hideLoader();O(U,T)},error:function(W,U,V){P.active=false;Q.hideLoader();if(S!=undefined){S()}}})}};this.bindFormulaForFileType=function(H){var F=H;var I=F.getModel().isSubformField()?F.getFormController().getFormController():F.getFormController();var E=I.getWorkflowController();if(E==undefined){E=new WorkflowController(I)}initFormula=false;if(F.getModel().isFormulaExist()){if(!initFormula){var G={};if(F.getModel().isSubformField()){G.fieldname=F.getFormController().getModel().getActualLabelName();G.subformfieldname=F.getModel().getActualLabelName();G.rowseqid=F.getModel().getRowID()}else{G.fieldname=F.getModel().getActualLabelName()}E.triggerFormulaAction(F,G);initFormula=true}D.getField().trigger("formulacalc")}};this.trigger=function(E){D.getField().trigger(E)};this.fieldEvents=function(){};this.destroy=function(){};this.getValue=function(){return $(D.getField()).val()};this.setValue=function(E){if($(D.getField()).data("select2")!=undefined){$(D.getField()).select2("data",E)}else{$(D.getField()).val(E)}if(this.isFloatLabelAlignment()){D.getField().trigger("blur")}};this.getField=function(){return D.getField()};this.getFieldContainer=function(){return this.getField().closest(".form-group")};this.focus=function(){this.getField().focus()};this.hasError=false;this.showError=function(F){var E=C.getModel().isSubformField();if(!this.hasError){var H=D.getField().outerWidth()+"px";var G="";if(E){G=$('<div class="fieldErrorMsg zc-dem-box-sizing" style = "min-width:'+H+";width:"+H+'">'+F+"</div>")}else{G=$('<div class="fieldErrorMsg zc-dem-box-sizing">'+F+"</div>")}if(C.getModel().getComponentType()==FieldType.DECISIONBOX){D.getFieldParent().parent().append(G);D.getFieldParent().addClass("validationError")}else{D.getFieldParent().append(G).addClass("validationError");D.getFieldParent().addClass("select2Err")}this.hasError=true}};this.clearError=function(){if(this.hasError){D.getFieldParent().removeClass("validationError");if(C.getModel().getComponentType()==FieldType.DECISIONBOX){$((D.getFieldParent().parent()).find(".fieldErrorMsg")).remove()}else{$((D.getFieldParent()).find(".fieldErrorMsg")).remove()}this.hasError=false}};this.showLoader=function(){if(this.getDOM().getFieldParent().find(".cogLoader").length==0){this.getDOM().getFieldParent().append('<i class="cogLoader fa fa-spinner fa-spin"></i>')}};this.hideLoader=function(){$(this.getDOM().getFieldParent().find(".cogLoader")).remove()};this.hideField=function(){if(this.getDOM().getModel().isCompositeSubField()){this.getField().parent().hide()}else{this.getFieldContainer().hide()}if(isMobileBrowser()&&!this.getDOM().getModel().isSubformField()&&this.getDOM().getModel().getFormModel().getFormAlign()==FormAlign.TOP){if(!this.hasVisibleFields(D.getSectionRow())){if(!D.getSectionRow().hasClass("zc-section-hidden-field")){D.getSectionRow().addClass("zc-section-hidden-field")}}}};this.showField=function(){if(this.getDOM().getModel().isCompositeSubField()){this.getField().parent().show()}else{this.getFieldContainer().show()}if(isMobileBrowser()&&!this.getDOM().getModel().isSubformField()&&this.getDOM().getModel().getFormModel().getFormAlign()==FormAlign.TOP){D.getSectionRow().removeClass("zc-section-hidden-field")}};this.disableField=function(){var E=C.getModel();if(E.getComponentType()==FieldType.PHONE_NUMBER){E.setDisable(true)}this.getField().attr("disabled",true);this.getField().attr("readonly",true)};this.enableField=function(){var E=C.getModel();if(E.getComponentType()==FieldType.PHONE_NUMBER){E.setDisable(false)}this.getField().attr("disabled",false);this.getField().attr("readonly",false)};this.showInPage=function(){$(this.getFieldContainer()).removeClass("field-screen")};this.hideInPage=function(){$(this.getFieldContainer()).addClass("field-screen")};this.bindFieldHoverEvent=function(E){$(E).on("mouseenter",function(){$(E).parent().addClass("zc-field-hover")}).on("mouseleave",function(){$(E).parent().removeClass("zc-field-hover")})};this.inPlaceLayoutHover=function(F,E,H,I,G){if(!H){if(E){$(F).addClass("zc-focus");if(!$(F).hasClass("zc-label-float")){$(F).addClass("zc-label-float")}}else{if($(F).hasClass("zc-focus")){$(F).removeClass("zc-focus")}if(LIB._isNull(I)&&!G){if($(F).hasClass("zc-label-float")){$(F).removeClass("zc-label-float")}}else{if(!$(F).hasClass("zc-label-float")){$(F).addClass("zc-label-float")}}}}};this.bindFieldFocusEvent=function(H,E,G){var F=D.getFieldParentGroup();$(H).on("focus",function(){if(!$(F).hasClass("zc-focus")){$(F).addClass("zc-focus")}$(E).parent().addClass("zc-field-focus");var I="";if(G){I=$(D.getFileValue()).val()}else{I=$(D.getField()).val()}if(I==""||I==undefined){$($(D.getImageIcons()).children("span").eq(1)).trigger("mouseover")}$($(D.getImageIcons()).children("span").eq(1)).addClass("zc-icon-focus")});$(H).on("blur",function(){$(E).parent().removeClass("zc-field-focus");var I="";if(G){I=$(D.getFileValue()).val()}else{I=$(D.getField()).val()}if(I==""||I==undefined){$($(D.getImageIcons()).children("span").eq(1)).trigger("mouseleave")}$($(D.getImageIcons()).children("span").eq(1)).removeClass("zc-icon-focus");$(F).removeClass("zc-focus")})};this.hasVisibleFields=function(F){var G=$(F).find(".form-group").children();for(var E=0;E<G.length;E++){if($(G[E]).is(":visible")){return true}}return false}});createPrototype(FieldView,ViewFactory.prototype);var CurrencyView=(function(H,E,B){FieldView.call(this,H,E,B);var A=this;var C=H.getModel();var D=C.getValueFormat();var G=FormatSeparators[D][0];var F=FormatSeparators[D][1];if(A.isFloatLabelAlignment()&&!C.isSubformField()){H.getField().removeAttr("placeholder")}H.getField().on("input",function(){var I=H.getField().val();E.clearError();if(!isNull(I.replace(/^[+\-]/,""))&&$.trim(I)!=""&&isNaN(I.replace(/,|\.|'|\s/g,""))){E.showError((i18n.validNumberMsg));var J=I.replace(/[^\d,\.'\s\+-]/g,"");H.getField().val(J)}});H.getField().on("change",function(){if(A.getFormattedVal(H.getField().val())){$(this).trigger("onuserinput")}});H.getField().on("blur",function(){if($((H.getFieldParent()).find(".fieldErrorMsg")).html()==i18n.mandatoryMsg){return }A.getFormattedVal(H.getField().val())});this.getFormattedVal=function(I){if(A.validateFormat(I)){var J=A.formatNumber(I);H.getField().val(J);if(J.replace(/[^\w]/g,"").length>C.getMaxDigits()){C.setValidationError(true);E.showError((i18n.maxdigitreached).replace("{0}",C.getDisplayName()).replace("{1}",C.getMaxDigits()));return false}C.setValidationError(false);return true}else{C.setValidationError(true);return false}};this.validateFormat=function(K){E.clearError();if(K!=null&&$.trim(K)!=""){if(isNaN(K.replace(/,|\.|'|\s/g,""))){E.showError((i18n.validNumberMsg));return false}var J=F;if(D!==FormatConstants.DEFAULTFORMAT&&D!==FormatConstants.DOTCOMMA&&A.getRegexForFormat(FormatConstants.DEFAULTFORMAT).test(K)){J="."}else{if(!A.getRegexForFormat(D).test(K)){E.showError((i18n.validNumericFormat).replace("{0}",'"'+C.getPlaceHolderFormat()+'"'));return false}}var I=K.indexOf(J);if(I!=-1&&I!==K.lastIndexOf(J)){E.showError((i18n.validNumericFormat).replace("{0}",'"'+C.getPlaceHolderFormat()+'"'));return false}else{if(I!=-1&&K.substr(I+1).length>C.fieldDecimalLength()){E.showError((i18n.roundDecimalMsg).replace("{0}",C.getDisplayName()).replace("{1}",C.fieldDecimalLength()));return false}}}return true};this.getRegexForFormat=function(I){switch(I){case FormatConstants.DEFAULTFORMAT:return/^(\+|-)?[0-9]*(\.?[0-9]+)*$/;case FormatConstants.COMMADOTENGLISH:case FormatConstants.COMMADOTINDIA:return/^(\+|-)?[0-9]*(,?[0-9]+)*(\.?[0-9]+)*$/;case FormatConstants.SPACECOMMA:return/^(\+|-)?[0-9]*(\s?[0-9]+)*(,?[0-9]+)*$/;case FormatConstants.DOTCOMMA:return/^(\+|-)?[0-9]*(\.?[0-9]+)*(,?[0-9]+)*$/;case FormatConstants.QUOTEDOT:return/^(\+|-)?[0-9]*('?[0-9]+)*(\.?[0-9]+)*$/}};this.formatNumber=function(P){var L=F;if(D!==FormatConstants.DEFAULTFORMAT&&D!==FormatConstants.DOTCOMMA&&A.getRegexForFormat(FormatConstants.DEFAULTFORMAT).test(P)){L="."}var N=P.split(L);if(D===FormatConstants.DEFAULTFORMAT||P.indexOf(L)===0){return P}var O=false;if(N[0].charAt(0)==="+"||N[0].charAt(0)==="-"){N[0]=N[0].substr(1);O=true}if(N[0].indexOf(G)!==-1){N[0]=N[0].replace(new RegExp("\\"+G,"g"),"")}var I=[];I.push(N[0].length<=3?N[0]:G+N[0].substr(N[0].length-3));N[0]=N[0].split("").reverse().join("");var M=0;var J=(D===FormatConstants.COMMADOTINDIA?2:3);for(var K=3;K<N[0].length;K++){I.push(N[0][K]);if(++M===J&&K+1<N[0].length){I.push(G);M=0}}if(O){I.push(P.charAt(0))}return(N.length===1?I.reverse().join(""):I.reverse().join("")+F+N[1])};this.setValue=function(I){if(A.validateFormat(I)){H.getField().val(A.formatNumber(I));C.setValidationError(false)}else{H.getField().val(I);C.setValidationError(true)}if(this.isFloatLabelAlignment()){H.getField().trigger("blur")}}});createPrototype(CurrencyView,ViewFactory.prototype);var CommonDateTimeView=(function(G,D,B){FieldView.call(this,G,D,B);var C=G.getModel();var E="";var A=this;var F=C.getComponentType();var H;if(F==FieldType.TIME){H=".zc-timefield-placeholder"}else{H=".zc-datefield-placeholder"}this.setValue=function(K){$(G.getField()).val(K);A.setPlaceholder(K);if(A.validateFormat()){E=K}if(this.isFloatLabelAlignment()){var J=C.isSubformField();var I=G.getFieldParentGroup();A.inPlaceLayoutHover(I,false,J,K,false)}};this.focus=function(){};this.fieldEvents=function(){var Q;var I=G.getFieldParent()[0];if(F==FieldType.TIME){Q=".timeIcon";D.initTime()}else{Q=".calcIcon";D.initCalender()}A.setPlaceholder(C.getDefaultValue());if(C.getDefaultValue().length===0&&C.isSmallField()&&I.querySelector(Q)){var M=I.offsetWidth;var K=I.querySelector(H);var O=I.querySelector(Q).offsetWidth;K.style.maxWidth=(M-O-10)+"px"}var N=D;var L=N.getModel().isSubformField()?N.getFormController().getFormController():N.getFormController();var J=L.getWorkflowController();if(J==undefined){J=new WorkflowController(L)}var R=N.getModel().isSubformField()?G.getModel().getFormModel().getFormModel().getRulesScript():G.getModel().getFormModel().getRulesScript();var P=false;$(G.getField()).on("blur",function(T){var U=G.getField().val();A.setPlaceholder(U);if(E!=U){if(!(A.validateFormat())){return false}G.getField().trigger("onuserinput");if(!P){var S={};if(N.getModel().isSubformField()){S.fieldname=N.getFormController().getModel().getActualLabelName();S.subformfieldname=N.getModel().getActualLabelName();S.rowseqid=N.getModel().getRowID()}else{S.fieldname=N.getModel().getActualLabelName()}J.triggerFormulaAction(N,S);P=true}E=U;if(R!=undefined){G.getField().trigger("change")}}})};this.setupCalender=function(M,J,L){var I=this;var K=false;M=(M=="null"||M==null)?"":M;G.getField().val(M);var N=I.getFormat(true);G.getCalIcon().on("click",function(){if(!K){M=G.getField().val();I.setupCalendarPromise(M,J,L,N);K=true;$(G.getCalIcon()).trigger("click")}});G.getField().on("focus",function(){if(!K){M=G.getField().val();I.setupCalendarPromise(M,J,L,N);K=true;$(G.getCalIcon()).trigger("click")}})};this.setupCalendarPromise=function(M,J,K,N){var I;if(F!=FieldType.TIME){I=C.getPickerLanguage();if(I=="zh"){I=I+"_CN"}if(N==undefined){N=ZCGlobal.uiDateFormate}}var L={format:N,keepInvalid:true,value:M,useCurrent:true,allowedDays:K,timeInterval:J,zcLocale:I,onShowCallback:function(){A.setPlaceholder("removePlaceHolder")},onHideCallback:function(){if(ZCGlobal.isMobileLayout){$(".zc-mobile-back-button").show();var O=$(G.getField().parent()).find(".zc-dem-date-picker-clear-icon");if(!LIB._isNull(G.getField().val())){$(O).show()}G.getField().blur()}},defaultValueCallbk:function(){D.setValue("")}};if(ZCGlobal.isMobileLayout){L.ignoreReadonly=true;L.focusOnShow=false;L.showClose=true;L.icons={close:"fa fa-close"};L.locatePickerCallBack=function(){$(".zc-mobile-back-button").hide()};L.showClearValue=true;L.clearIconCallbk=function(P){var O="<span class='zc-dem-date-picker-clear-icon "+P+"'><i class='fa fa-close'></i></span>";if(!$(G.getField().parent()).find(".zc-dem-date-picker-clear-icon").length){$(G.getField().parent()).append(O)}};L.clearCallback=function(){G.getField().val("")};L.toolbarPlacement="top"}$(G.getField().parent()).dtPicker(L)};this.setPlaceholder=function(K){var J=G.getFieldParent()[0];var I=J.querySelector(H);if(K!=""){I.innerHTML=""}else{if(!A.isFloatLabelAlignment()||C.isSubformField()){I.innerHTML=A.getFormat()}}};this.validateFormat=function(){var S=G.getField().val();var R=A.getFormat(true);D.clearError();if(S!=""){moment.locale("en-US");var M=moment(S,R,true);if(!M.isValid()){var N;if(F==FieldType.TIME){N=(i18n.validTimeFormat).replace("{0}",C.getTimeFormat())}else{N=i18n.validDateFormat}D.showError(N);return false}if(F==FieldType.DATE_TIME||F==FieldType.DATE){var T=C.getAllowedDays().split(",");if(T.length!=7){if(!T.includes(M.day().toString())){D.showError(i18n.validWorkDay);return false}}}if(F==FieldType.DATE_TIME||F==FieldType.TIME){var P=C.getAllowedTimeLimitInSeconds();if(!isNull(P)){var Q=M.hour()*3600+M.minute()*60+M.second();for(var K=0,O=P.length;K<O;K++){var J=P[K];if(Q<J.startInSeconds||Q>J.endInSeconds){var I=J.start,L=J.end;if(!C.is24HrFormat()){I=moment(I,"HH:mm",true).format("hh:mm A");L=moment(L,"HH:mm",true).format("hh:mm A")}this.showError(i18n.validWorkHour+"("+I+" - "+L+")");return false}}}}}return true};this.getFormat=function(I){var J;if(F==FieldType.DATE||F==FieldType.DATE_TIME){J=C.getDateFormat();if(I){J=J.toUpperCase().replace("E","ddd")}}if(F==FieldType.DATE){return J}else{if(F==FieldType.DATE_TIME){return J+" "+C.getTimeFormat()}else{if(F==FieldType.TIME){return C.getTimeFormat()}}}}});createPrototype(CommonDateTimeView,ViewFactory.prototype);var DateTimeView=(function(C,B,A){CommonDateTimeView.call(this,C,B,A)});createPrototype(DateTimeView,FieldView.prototype);var TimeView=(function(C,B,A){CommonDateTimeView.call(this,C,B,A)});createPrototype(TimeView,FieldView.prototype);var DecisionBoxView=(function(C,B,A){FieldView.call(this,C,B,A);this.getValue=function(){return C.getField().is(":checked")?"zc_checked":"zc_unchecked"};this.setValue=function(D){var D=D=="true"?true:false;C.getField().prop("checked",D)};this.bindFieldHelpText=function(){var E=$(C.getFieldParentGroup()).width()-4;var D=$('<div class="zc-help-txt" style="white-space:pre-line;width:'+E+'px"></div>');D.text(fieldModel.getTitle());C.getFieldParent().parent().append(D)};this.bindFieldDescription=function(){var E={tooltip:C.getModel().getTitle(),position:ZCGlobal.appDirectionMeta.tooltipPosition};if(fieldModel.isSubformField()){var D=$(A.getDOM().getFormDOM()).parent()[0].querySelector("."+fieldModel.getClassName()+"-group");if(D!=null&&D!=undefined){E.tooltipelem=$(D.querySelector(".decision-box-label")).children("span");$(E.tooltipelem).tooltipPositionCalc(E);$(C.getField()).parent().tooltipPositionCalc(E)}}else{E.isDecisionBox=true;E.checkBoxWidth=$(C.getFieldParent()).width();E.tooltipelem=$(C.getFieldParent()).parent()[0].querySelector(".decision-box-label");$(C.getField()).parent().tooltipPositionCalc(E)}}});createPrototype(DecisionBoxView,FieldView.prototype);var ImageView=(function(A,G,F){FieldView.call(this,A,G,F);var L=2,H=this,E=false;var B=H.isFloatLabelAlignment();var J=A.getModel();var I=J.isSubformField();var D=J.isLocalImgSRC()||LIB._isNull((J.getImageSRC()!=undefined?J.getImageSRC().trim():J.getImageSRC()));var C=A.getFieldParentGroup();var K=false;this.getSelectedType=function(){return L};this.setSelectedType=function(M){H.selectedType=M};this.focus=function(){if(J.getImageType()==2||(J.getImageType()>=3&&D)){$(A.getFileInputEl()).focus()}else{$(A.getSourceComp()).focus()}};this.fieldEvents=function(){G.regImageEvent();var M=this;$(A.getFileInputEl()).on("change",function(){M.toggleOptions(this)});$(A.getSourceComp()).on("change",function(){M.toggleOptions(this);$(this).trigger("onuserinput");G.getView().bindFormulaForFileType(G)});var P=A.getFileInputEl().attr("dimension");var N=P>1?true:false;var O=J.getImageType();if(J.getDefaultValue()!=""&&J.getDefaultValue()!=undefined){if(B&&!I){if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}$(A.getImageIcons()).hide();if(J.getImageSelectedType()==1||O==1){M.toggleOptions(A.getSourceComp());L=1;$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();$(A.getFieldDOM().querySelector(".zc-image-link")).show();if(O!=1){$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).show()}}else{if(J.getImageSelectedType()==2){K=true;L=2;A.getSourceComp().val("");$(A.getImageIcons().querySelector(".calcIcon")).append(i18n.restoreMsg);M.setRestoreWidth();$(A.getFieldDOM().querySelector(".zc-image-link")).hide();$(A.getFieldDOM().querySelector(".zc-file-upload")).show();$(A.getFieldParentDiv()).addClass("zc-bottomColr")}else{L=3;$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();$(A.getFieldDOM().querySelector(".zc-image-link")).show();$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).show();A.getSourceComp().attr("readonly",true);A.getImgOptionsCont().show(400);A.getImgOptionsCont().removeClass("hide");$(A.getFieldParentDiv()).addClass("zc-bottomColr")}}}if(!K){$($(A.getImageIcons()).children("span").eq(1)).removeAttr("tabindex")}M.bindFieldHoverEvent(A.getFieldDOM().querySelector(".zc-file-upload"));M.bindFieldHoverEvent(A.getFieldDOM().querySelector(".zc-image-link"));M.bindFieldFocusEvent(A.getFileInputEl(),A.getFieldDOM().querySelector(".zc-file-upload"),true);if(O==Constants.LINK||O==Constants.LINKANDCAMERA){L=1}if(B&&!I){M.hoverMsgChange(L,"")}else{if(L==2){if(isMobileBrowser()&&(O==Constants.CAMERAANDLOCAL||O==Constants.CAMERA||O==Constants.IMAGEALLOPTION)){M.hoverMsgChange(L,i18n.cameraHoverMsg)}else{M.hoverMsgChange(L,i18n.selectImageMsg)}}else{if(L==1){if(!isMobileBrowser()){M.hoverMsgChange(L,"https://")}}}}$(A.getImageIcons().querySelectorAll(".calcIcon")).on("mouseenter mouseleave",function(Q){if(Q.type=="mouseenter"){M.adjustLabelWidth(G.getModel().getComponentType(),true);M.placeHolderMsgRelatedChanges($(this),true,O);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().addClass("zc-restore-hover")}if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().addClass("zc-image-upload-hover")}if($(this).find("i").hasClass("ui-2-link-69")){$(this).parent().parent().addClass("zc-image-link-hover")}if($(this).find("i").hasClass("media-1-camera-20")){$(this).parent().parent().addClass("zc-image-camera-hover")}}else{if(Q.type=="mouseleave"){M.adjustLabelWidth(G.getModel().getComponentType(),false);M.placeHolderMsgRelatedChanges($(this),false,O);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().removeClass("zc-restore-hover")}if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().removeClass("zc-image-upload-hover")}if($(this).find("i").hasClass("ui-2-link-69")){$(this).parent().parent().removeClass("zc-image-link-hover")}if($(this).find("i").hasClass("media-1-camera-20")){$(this).parent().parent().removeClass("zc-image-camera-hover")}}}});if(O==Constants.LINKANDLOCAL||O==Constants.LINKANDCAMERA||O==Constants.IMAGEALLOPTION||L==3){$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).on("click",function(R,Q){A.getSourceComp().val("");$(this).trigger("onuserinput");G.getView().bindFormulaForFileType(G);$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).hide();if(O==Constants.LINKANDCAMERA){M.toggleOptions(A.getSourceComp(),Q);L=1}else{L=3;A.getSourceCompDiv().hide();$(A.getFieldDOM().querySelector(".zc-file-upload")).show();M.hoverMsgChange(L,i18n.selectImageMsg);M.toggleOptions(A.getFileInputEl(),Q);M.setRestoreWidth()}$(A.getImageIcons()).show()});if(B&&!I){$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).on("mouseover",function(){M.inPlaceLabelHover(true);if(!isMobileBrowser()){$(A.getSourceComp()).attr("placeholder","https://")}}).on("mouseout",function(){M.inPlaceLabelHover(false);$(A.getSourceComp()).attr("placeholder","")})}$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".form-control")).on("focus",function(){$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).show();$(A.getImageIcons()).hide()})}if(O==Constants.LINK){$(A.getImageIcons()).hide();$(A.getSourceComp()).css({"padding-right":"0px"})}if(O==Constants.CAMERA||O==Constants.LINKANDCAMERA){$(A.getFileInputEl()).on("click",function(Q){L=2;Q.preventDefault();G.getImageObj().openCamera(A,"fileinput")})}if(O==Constants.CAMERAANDLOCAL){$(A.getImageIcons()).addClass("linkCameraIcon")}$(A.getImageIcons()).css("z-index",A.getFieldDOM().style.zIndex+1+"");$(A.getImageIcons().querySelectorAll(".calcIcon")).on("click focus blur keyup",function(Q){if(Q.type=="focus"){$(this).addClass("zc-icon-focus");$(A.getFieldDOM().querySelector(".zc-file-upload")).parent().addClass("zc-field-focus");M.placeHolderMsgRelatedChanges($(this),true,O);return }else{if(Q.type=="blur"){$(this).removeClass("zc-icon-focus");$(A.getFieldDOM().querySelector(".zc-file-upload")).parent().removeClass("zc-field-focus");M.placeHolderMsgRelatedChanges($(this),false,O);return }else{if(Q.type=="keyup"&&Q.which!=13){return }}}if($(this).find("i").hasClass("arrows-2-square-upload")){L=2;$(A.getFileInputEl()).trigger("click");$(A.getFieldDOM().querySelector(".zc-file-upload")).show();A.getSourceCompDiv().hide();M.toggleOptions(A.getFileInputEl())}if($(this).find("i").hasClass("ui-2-link-69")){L=1;$(A.getImageIcons()).hide();$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html("");A.getSourceCompDiv().fadeIn();$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).show();$(A.getSourceComp()).trigger("focus");M.toggleOptions(A.getSourceComp())}if($(this).find("i").hasClass("media-1-camera-20")){G.getImageObj().openCamera(A,"fileinput")}if($(this).find("i").hasClass("arrows-4-undo-29")){$($(A.getField())[0].querySelector(".arrows-4-undo-29.file-restore")).trigger("click");G.clearError();$(A.getImageIcons()).hide();$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html("");if(J.getImageSelectedType()==1){L=1;A.getSourceComp().removeAttr("tabindex");$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();$(A.getFieldDOM().querySelector(".zc-image-link")).show();A.getSourceComp().focus()}else{L=2;A.getFileInputEl().removeAttr("tabindex");$(A.getFieldDOM().querySelector(".zc-image-link")).hide();$(A.getFieldDOM().querySelector(".zc-file-upload")).show();if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}A.getFileInputEl().focus()}}});$(A.hiddenDiv()).on("click",function(Q){$(this).parent()[0].querySelector(".cameraIcon").trigger("click")})};this.imagePopup=function(){if(A.hiddenDiv()!=undefined){$(A.hiddenDiv()).parent()[0].querySelector(".cameraIcon").trigger("click")}};this.placeHolderMsgRelatedChanges=function(N,M,O){if(M){H.inPlaceLabelHover(true);if(O==Constants.LINKANDCAMERA){$(A.getSourceComp()).attr("placeholder","")}if(K&&!$(N).find("i").hasClass("arrows-4-undo-29")){$(A.getImageIcons().querySelector(".calcIcon")).hide()}if($(N).find("i").hasClass("arrows-2-square-upload")){H.hoverMsgChange(L,i18n.localuploadHoverMsg);if(K){H.hoverMsgChange(3,i18n.localuploadHoverMsg)}}if($(N).find("i").hasClass("ui-2-link-69")){H.hoverMsgChange(L,i18n.linkHoverMsg);if(K){H.hoverMsgChange(3,i18n.linkHoverMsg)}}if($(N).find("i").hasClass("media-1-camera-20")){H.hoverMsgChange(L,i18n.cameraHoverMsg);if(K){H.hoverMsgChange(3,i18n.cameraHoverMsg)}}}else{if(L==2||L==3){if(isMobileBrowser()&&(O==Constants.CAMERAANDLOCAL||O==Constants.CAMERA||O==Constants.IMAGEALLOPTION)){H.hoverMsgChange(L,i18n.cameraHoverMsg)}else{H.hoverMsgChange(L,i18n.selectImageMsg)}}else{H.hoverMsgChange(L,"https://")}if(O==Constants.LINKANDCAMERA&&!isMobileBrowser()){$(A.getSourceComp()).attr("placeholder","https://")}if(B&&!I){H.inPlaceLabelHover(false)}if(K){$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block");H.inPlaceLabelHover(true);H.hoverMsgChange(3,"")}}};this.hoverMsgChange=function(N,M){if(J.getDefaultValue()==undefined||J.getDefaultValue()==""){if(N==2||N==3){$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html(M)}else{$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html("");$(A.getSourceComp()).attr("placeholder",M)}}else{if(N==3){$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html(M)}}};this.setRestoreWidth=function(){if(K){var P=J.getImageType();var N=$($(A.getField())[0].querySelector(".filename")).width();var O=$(A.getImageIcons().querySelector(".calcIcon:last-child")).width();var M=H.calculateWidthForRestore(P,N,O+1)-2;$(A.getImageIcons().querySelector(".calcIcon")).width(M);$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block")}};this.calculateWidthForRestore=function(O,M,N){switch(O){case Constants.LOCAL:case Constants.CAMERA:M-=N;break;case Constants.LINKANDLOCAL:case Constants.CAMERAANDLOCAL:M-=(2*N);break;case Constants.LINKANDCAMERA:M-=((2*N)+2);break;case Constants.IMAGEALLOPTION:M-=(3*N);break}return M};this.toggleOptions=function(N,M){var O=($(N).attr("type")!="file")?$(N).val():A.getFileValue().val();if(O!=undefined&&O!=""){A.getImgOptionsCont().show(400);A.getImgOptionsCont().removeClass("hide")}else{if(!isNull(M)){A.getImgOptionsCont().hide()}else{A.getImgOptionsCont().hide(400)}}};upload=$('<a class="zc-link-switch hide"><i class="fa fa-upload"></i></a>');link=$('<a class="zc-link-switch hide"><i class="fa fa-link"></i></a>');this.showLink=function(){A.getSourceCompDiv().fadeIn();$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();L=1;if(H.isFloatLabelAlignment()){$(A.getSourceComp()).attr("placeholder","");H.bindFocus()}};this.createTab=function(N){var M=this;A.getField().addClass("zc-toggle-switch");A.getSourceCompDiv().append(upload);upload.on("click",function(){$(A.getFieldDOM().querySelector(".zc-file-upload")).fadeIn();A.getSourceCompDiv().hide();M.toggleOptions(A.getFileInputEl());L=2});link.on("click",function(){A.getSourceCompDiv().fadeIn();$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();L=1;if(M.isFloatLabelAlignment()){$(A.getSourceComp()).attr("placeholder","");M.bindFocus()}})};this.destroy=function(){$(A.getFileInput()).upload("destroy")};this.createUpload=function(N){var M=this;N.beforeSend=function(){G.showLoader();G.getFormController().addActiveUploads()};N.success=function(U,V,Y){$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html("");G.hideLoader();G.getFormController().removeActiveUploads();L=2;if(J.getImageType()==Constants.LINKANDCAMERA){A.getSourceCompDiv().hide();$(A.getFieldDOM().querySelector(".zc-file-upload")).show();M.toggleOptions(A.getFileInputEl())}var T=[];for(var Z in U){var Q=U[Z];for(var W=0,S=Q.length;W<S;W++){var R=Q[W];if(R.status=="error"){T.push("<b>"+R.docName+"</b>")}}}G.clearError();if(T.length>0){var X=(T.length>1)?"The following files are too larget to upload":"The following file is too large to upload";X+="<br/>"+T.join("<br/>");N.error()}else{A.getFileInputEl().removeAttr("tabindex");if(B&&!I){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}A.getFileValue().val(JSON.stringify(U));$(A.getFileInputEl()).trigger("focus");E=true;if(!(J.isZiaInput()&&J.isZiaOnUserInputExist())){G.getView().trigger("onuserinput")}if(J.isZiaInput()){$(G.getField()).trigger("triggerzia")}G.getView().bindFormulaForFileType(G)}};N.showOpts=function(){A.getImgOptionsCont().show(400)};N.ondelete=function(Q){$(A.getFieldDOM().querySelector(".zc-file-upload")).trigger("mouseleave");A.getFileValue().val("");A.getImgOptionsCont().hide(400);if(!N.isDefaultValuePreseent){$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html(i18n.selectImageMsg)}if($(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).removeClass("zc-bottomColr")}if(J.getImageType()==Constants.LINKANDCAMERA){L=1;$(A.getFieldDOM().querySelector(".zc-file-upload")).hide();A.getSourceCompDiv().show();M.toggleOptions(A.getSourceCompDiv())}else{M.setRestoreWidth()}$(A.getImageIcons()).show();if(B&&!I){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}if(K){A.getFileInputEl().attr("tabindex","-1");A.getSourceComp().attr("tabindex","-1")}else{A.getFileInputEl().focus()}E=false;$(G.getField()).trigger("triggerzia");G.getView().trigger("onuserinput");G.getView().bindFormulaForFileType(G)};N.onrestore=function(Q){A.getFileValue().val(Q);A.getImgOptionsCont().show(400);E=false};N.error=function(V){var S;try{S=JSON.parse(V.responseText)[0][0].errorMsg}catch(R){try{var U=new DOMParser().parseFromString(V.responseText,"text/html");var T=JSON.parse(U.getElementsByName("errorMeta")[0].value).errorCode;S=T=="VIRUS_DETECTED"?i18n.virusdetected:T=="FILE_SIZE_MORE_THAN_ALLOWED_SIZE"?i18n.imagesizelimit:i18n.fileuploaderror}catch(Q){S=i18n.fileuploaderror}}G.hideLoader();G.getFormController().removeActiveUploads();$(A.getImageIcons()).show();$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html(i18n.selectImageMsg);G.showError(S);LIB._stopLoading();clearTimeout(G.getFormController().submitTimeout)};$(A.getFileInput()).upload(N);if(!isNull(N.defaultVal)){var O=N.defaultVal;var P=(O!=undefined&&O!="")?O.substring(O.lastIndexOf("/")+1):"";A.getFileValue().val(P)}};this.getSourceVal=function(M){if(M){return A.getFileValue().val()}else{return A.getSourceComp().val()}};this.setSourceVal=function(M){if(J.getImageType()==Constants.LINK||J.getImageType()==Constants.LINKANDLOCAL||J.getImageType()==Constants.LINKANDCAMERA||J.getImageType()==Constants.IMAGEALLOPTION){$(A.getImageIcons()).hide();$($(A.getField())[0].querySelector(".zc-image-hover-msg")).html("");if(J.getImageType()!=Constants.LINK){$(A.getFieldDOM().querySelector(".zc-image-link").querySelector(".filename")).show()}if(M!=undefined&&M!=""){A.getImgOptionsCont().show(400);A.getImgOptionsCont().removeClass("hide");L=1;A.getSourceCompDiv().fadeIn();$(A.getFieldDOM().querySelector(".zc-file-upload")).hide()}}return A.getSourceComp().val(M)};this.setFileVal=function(M){A.getFileValue().val(M)};this.getLinkVal=function(){return A.getLinkComp().val()};this.setLinkVal=function(M){return A.getLinkComp().val(M)};this.getTitleVal=function(){return A.getTitleComp().val()};this.setTitleVal=function(M){return A.getTitleComp().val(M)};this.getAltVal=function(){return this.getTitleVal()};this.setAltVal=function(M){return this.setTitleVal(M)};this.addToStore=function(){return E};this.reset=function(){$(A.getFieldDOM().querySelectorAll("input[type=text]")).val("")};this.bindFocus=function(){var M;if(L==2||L==3){M=A.getFileInputEl()}else{M=A.getSourceComp()}if(!I){if(!LIB._isNull($(M).val())&&!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}$(A.getFileInputEl()).on("mouseover",function(){H.inPlaceLabelHover(true);H.hoverMsgChange(2,i18n.selectImageMsg);H.adjustLabelWidth(G.getModel().getComponentType(),true)}).on("mouseout",function(){H.inPlaceLabelHover(false);H.hoverMsgChange(2,"");H.adjustLabelWidth(G.getModel().getComponentType(),false)});$(A.getSourceComp()).on("mouseover",function(){H.inPlaceLabelHover(true);if(!isMobileBrowser()){$(A.getSourceComp()).attr("placeholder","https://")}H.adjustLabelWidth(G.getModel().getComponentType(),true)}).on("mouseout",function(){H.inPlaceLabelHover(false);$(A.getSourceComp()).attr("placeholder","");H.adjustLabelWidth(G.getModel().getComponentType(),true)})}};this.inPlaceLabelHover=function(M){if(L==2||L==3){fileinputel=A.getFileInputEl()}else{fileinputel=A.getSourceComp()}if(!M){H.hoverMsgChange(L,"")}H.inPlaceLayoutHover(C,M,I,$(fileinputel).val(),K)};this.disableField=function(){A.getFileInputEl().attr("disabled",true);A.getSourceComp().attr("disabled",true);A.getLinkComp().attr("disabled",true);A.getTitleComp().attr("disabled",true);A.getAltComp().attr("disabled",true);if(isEdgeBrowser()){A.getFileInputEl().attr("readonly",true);A.getSourceComp().attr("readonly",true);A.getLinkComp().attr("readonly",true);A.getTitleComp().attr("readonly",true);A.getAltComp().attr("readonly",true)}$(A.getImageIcons().querySelectorAll(".calcIcon")).addClass("zc-eventDisable");A.getFileInput().parent().addClass("zc-disabled");A.getFileInput().parent().parent().addClass("zc-hideicon");A.getSourceComp().parent().addClass("zc-hideicon")};this.enableField=function(){A.getFileInputEl().attr("disabled",false);A.getSourceComp().attr("disabled",false);A.getLinkComp().attr("disabled",false);A.getTitleComp().attr("disabled",false);A.getAltComp().attr("disabled",false);if(isEdgeBrowser()){A.getFileInputEl().attr("readonly",false);A.getSourceComp().attr("readonly",false);A.getLinkComp().attr("readonly",false);A.getTitleComp().attr("readonly",false);A.getAltComp().attr("readonly",false)}$(A.getImageIcons().querySelectorAll(".calcIcon")).removeClass("zc-eventDisable");A.getFileInput().parent().removeClass("zc-disabled");A.getFileInput().parent().parent().removeClass("zc-hideicon");A.getSourceComp().parent().removeClass("zc-hideicon")};this.bindFieldDescription=function(){var N={tooltip:A.getModel().getTitle(),position:ZCGlobal.appDirectionMeta.tooltipPosition};if(J.isSubformField()){var M=$(F.getDOM().getFormDOM()).parent()[0].querySelector("."+J.getClassName()+"-group");if(M!=null&&M!=undefined){N.tooltipelem=M.querySelector(".zc-label-text");$(N.tooltipelem).tooltipPositionCalc(N);$(A.getField()).tooltipPositionCalc(N)}}else{$(A.getField()).tooltipPositionCalc(N)}};this.clearValue=function(){J.setDefaultValue("");if(J.getImageType()==Constants.LINK){$(A.getSourceComp()).val("");H.toggleOptions(A.getSourceComp(),1)}else{$((this.getFieldContainer())[0].querySelectorAll(".filename i")).trigger("click")}this.setLinkVal("");this.setTitleVal("");this.setAltVal("")}});createPrototype(ImageView,FieldView.prototype);var URLView=(function(C,B,A){FieldView.call(this,C,B,A);this.fieldEvents=function(){if(this.isFloatLabelAlignment()){$(C.getURLComp()).attr("placeholder","")}var D=this;$(C.getURLComp()).on("change",function(){D.toggleOptions(this)});D.toggleOptions(C.getURLComp())};this.toggleOptions=function(E){var D=C.getUrlOptions()[0];if(D){if($(E).val()!=undefined&&$(E).val()!=""){D.style.display=null;D.classList.remove("hide")}else{D.style.display="none"}}};this.bindFocus=function(){var E=C.getTextField();var D=C.getFieldParentGroup();if(!LIB._isNull($(E).val())&&!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}$(E).on("focus",function(){$(D).addClass("zc-focus");if(!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}).on("blur",function(){if($(D).hasClass("zc-focus")){$(D).removeClass("zc-focus")}if(LIB._isNull($(E).val())&&$(D).hasClass("zc-label-float")){$(D).removeClass("zc-label-float")}else{if(!LIB._isNull($(E).val())&&!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}})};this.focus=function(){C.getTextField().focus()};this.getURLVal=function(){return C.getURLComp().val()};this.setURLVal=function(D){C.getURLComp().val(D);if(this.isFloatLabelAlignment()){C.getTextField().trigger("blur")}return };this.getLinkVal=function(){return C.getLinkComp().val()};this.setLinkVal=function(D){return C.getLinkComp().val(D)};this.getTitleVal=function(){return C.getTitleComp().val()};this.setTitleVal=function(D){return C.getTitleComp().val(D)};this.reset=function(){C.getTextField().val("")};this.disableField=function(){C.getField().attr("disabled",true);C.getURLComp().attr("disabled",true);C.getLinkComp().attr("disabled",true);C.getTitleComp().attr("disabled",true);if(isEdgeBrowser()){C.getField().attr("readonly",true);C.getURLComp().attr("readonly",true);C.getLinkComp().attr("readonly",true);C.getTitleComp().attr("readonly",true)}};this.enableField=function(){C.getField().attr("disabled",false);C.getURLComp().attr("disabled",false);C.getLinkComp().attr("disabled",false);C.getTitleComp().attr("disabled",false);if(isEdgeBrowser()){C.getField().attr("readonly",false);C.getURLComp().attr("readonly",false);C.getLinkComp().attr("readonly",false);C.getTitleComp().attr("readonly",false)}};this.bindFieldDescription=function(){var F=B.getModel();var E={tooltip:F.getTitle(),position:ZCGlobal.appDirectionMeta.tooltipPosition};if(F.isSubformField()){var D=$(A.getDOM().getFormDOM()).parent()[0].querySelector("."+F.getClassName()+"-group");if(D!=null&&D!=undefined){E.tooltipelem=D.querySelector(".zc-label-text");$(E.tooltipelem).tooltipPositionCalc(E);$(C.getField()).tooltipPositionCalc(E)}}else{$(C.getField()).tooltipPositionCalc(E)}}});createPrototype(URLView,FieldView.prototype);var FileUploadView=(function(A,F,E){FieldView.call(this,A,F,E);var D=false,G=this;var B=G.isFloatLabelAlignment();var I=A.getModel();var C=A.getFieldParentGroup();var H=I.isSubformField();var J=false;this.focus=function(){$(A.getUploadElement()).trigger("focus")};this.fieldEvents=function(){F.regFileUploadEvent();var K=I.getCloudService();if(I.isPickerRestricted()&&K!=""&&K.indexOf("mycomputer")==-1){G.disableField()}if(I.getDefaultValue()!=""&&I.getDefaultValue()!=undefined){if(B&&!H){if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}J=true;var L=I.isOneFileUpload();$(A.getImageIcons().querySelector(".calcIcon")).append(i18n.restoreMsg);G.setRestoreWidth();$(A.getImageIcons()).hide();$(A.getFieldParentDiv()).addClass("zc-bottomColr")}else{$($(A.getImageIcons()).children("span").eq(1)).removeAttr("tabindex")}G.bindFieldHoverEvent(A.getFieldParentDiv().querySelector(".zc-file-upload"));G.bindFieldFocusEvent(A.getFileInput(),A.getFieldParentDiv().querySelector(".zc-file-upload"),false);if(!B||H){G.hoverMesg(i18n.selectfileMsg)}$(A.getImageIcons().querySelectorAll(".calcIcon")).on("mouseenter mouseleave",function(M){if(M.type=="mouseenter"){G.adjustLabelWidth(F.getModel().getComponentType(),true);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().addClass("zc-restore-hover")}G.placeHolderMsgRelatedChanges($(this),true);if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().addClass("zc-image-upload-hover")}if($(this).find("i").hasClass("arrows-1-cloud-upload-96")){$(this).parent().parent().addClass("zc-image-cloud-hover")}}else{if(M.type=="mouseleave"){G.adjustLabelWidth(F.getModel().getComponentType(),false);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().removeClass("zc-restore-hover")}G.placeHolderMsgRelatedChanges($(this),false);if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().removeClass("zc-image-upload-hover")}if($(this).find("i").hasClass("arrows-1-cloud-upload-96")){$(this).parent().parent().removeClass("zc-image-cloud-hover")}}}});$(A.getImageIcons()).css("z-index",A.getFieldDOM().style.zIndex+1+"");$(A.getImageIcons().querySelectorAll(".calcIcon")).on("click keyup focus blur",function(M){if(M.type=="focus"){$(this).addClass("zc-icon-focus");$(A.getFieldParentDiv()).addClass("zc-field-focus");G.placeHolderMsgRelatedChanges($(this),true);return }else{if(M.type=="blur"){$(this).removeClass("zc-icon-focus");$(A.getFieldParentDiv()).removeClass("zc-field-focus");G.placeHolderMsgRelatedChanges($(this),false);return }else{if(M.type=="keyup"&&M.which!=13){return }}}if(M.type=="keyup"&&M.which==13&&$(this).find("i").hasClass("arrows-1-cloud-upload-96")){$(this).trigger("click");return }if($(this).find("i").hasClass("arrows-2-square-upload")){$(A.getFileInput()).trigger("click")}if($(this).find("i").hasClass("arrows-4-undo-29")){A.getFileInput().removeAttr("tabindex");$($(A.getField()).parent()[0].querySelector(".arrows-4-undo-29.file-restore")).trigger("click");F.clearError();$(A.getImageIcons()).hide();if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}A.getFileInput().focus()}})};this.placeHolderMsgRelatedChanges=function(L,K){if(K){G.inPlaceLayoutHover(C,true,H,"",J);if(J&&!$(L).find("i").hasClass("arrows-4-undo-29")){$(A.getImageIcons().querySelector(".calcIcon")).hide()}if($(L).find("i").hasClass("arrows-2-square-upload")){G.hoverMesg(i18n.localuploadHoverMsg);if(J){G.hoverMesg(i18n.localuploadHoverMsg,true)}}if($(L).find("i").hasClass("arrows-1-cloud-upload-96")){G.hoverMesg(i18n.cloudUploadHoverMsg);if(J){G.hoverMesg(i18n.cloudUploadHoverMsg,true)}}}else{G.hoverMesg(i18n.selectfileMsg);if(B&&!H){G.hoverMesg("",true);G.inPlaceLayoutHover(C,false,H,$(A.getUploadElement()).val(),J)}if(J){G.inPlaceLayoutHover(C,true,H,"",J);$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block");G.hoverMesg("",true)}}};this.setRestoreWidth=function(){if(J){var M=I.getCloudService();var O=I.isOneFileUpload();var L=$($(A.getField()).parent()[0].querySelector(".filename")).width();var K;var N=$(A.getImageIcons().querySelector(".calcIcon:last-child")).width()+1;if(M!=undefined&&(O||M==""||(M.indexOf("mycomputer")==-1))){K=L-N-2}else{K=L-(2*N)-2}$(A.getImageIcons().querySelector(".calcIcon")).width(K);$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block")}};this.hoverMesg=function(K,L){if(I.getDefaultValue()==undefined||I.getDefaultValue()==""||L){$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html(K)}};this.createUpload=function(K){K.beforeSend=function(){F.showLoader();F.getFormController().addActiveUploads()};K.success=function(P,Q,T){G.hoverMesg("",true);F.hideLoader();F.getFormController().removeActiveUploads();var O=[];for(var U in P){var L=P[U];for(var R=0,N=L.length;R<N;R++){var M=L[R];if(M.status=="error"){O.push("<b>"+M.docName+"</b>")}}}if(O.length>0){var S=(O.length>1)?"The following files are too larget to upload":"The following file is too large to upload";S+="<br/>"+O.join("<br/>");K.error()}else{if(P!=undefined&&!jQuery.isEmptyObject(P)){A.getFileInput().removeAttr("tabindex");if(B&&!H){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}}F.clearError();F.setValue(JSON.stringify(P));$(A.getFileInput()).trigger("focus");D=true}if(Object.keys(P).length>0){$(F.getField()).trigger("onuserinput");F.getView().bindFormulaForFileType(F)}};K.isPickerRestricted=function(){return F.isPickerRestricted()};K.ondelete=function(L){$(A.getFieldParentDiv().querySelector(".zc-file-upload")).trigger("mouseleave");G.setRestoreWidth();$(A.getImageIcons()).show();if(!K.isDefaultValuePreseent){$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html(i18n.selectfileMsg)}if($(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).removeClass("zc-bottomColr")}F.setValue("");if(B&&!H){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}D=false;F.getView().trigger("onuserinput");F.getView().bindFormulaForFileType(F);if(J){A.getFileInput().attr("tabindex","-1")}else{A.getFileInput().focus()}};K.onrestore=function(L){F.setValue(L);D=false};K.error=function(Q){var N;try{N=JSON.parse(Q.responseText)[0][0].errorMsg}catch(M){try{var P=new DOMParser().parseFromString(Q.responseText,"text/html");var O=JSON.parse(P.getElementsByName("errorMeta")[0].value).errorCode;N=O=="VIRUS_DETECTED"?i18n.virusdetected:O=="FILE_SIZE_MORE_THAN_ALLOWED_SIZE"?i18n.fileuploadsizelimit:i18n.fileuploaderror}catch(L){N=i18n.fileuploaderror}}F.clearError();F.hideLoader();F.getFormController().removeActiveUploads();$(A.getImageIcons()).show();$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html(i18n.selectfileMsg);F.showError(N);F.clear();LIB._stopLoading();clearTimeout(F.getFormController().submitTimeout)};$(A.getFileInput()).upload(K)};this.addToStore=function(){return D};this.destroy=function(){$(A.getUploadElement()).upload("destroy")};this.disableField=function(){A.getUploadElement().attr("disabled",true);$(A.getImageIcons().querySelectorAll(".calcIcon")).addClass("zc-eventDisable");A.getUploadElement().parent().addClass("zc-disabled");A.getUploadElement().parent().parent().addClass("zc-hideicon")};this.enableField=function(){var L=A.getImageIcons().querySelector(".calcIcon.cloudIcon");var K=(L!=null&&L!=undefined)?$(L).attr("isrestictedcno"):"false";if(K!="true"){A.getUploadElement().attr("disabled",false);$(A.getImageIcons().querySelectorAll(".calcIcon")).removeClass("zc-eventDisable");A.getUploadElement().parent().removeClass("zc-disabled");A.getUploadElement().parent().parent().removeClass("zc-hideicon")}};this.bindFocus=function(){if(!H){var K=A.getUploadElement();if(!LIB._isNull($(K).val())&&!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}$(K).on("mouseover",function(){G.inPlaceLayoutHover(C,true,H,"",J);G.hoverMesg(i18n.selectfileMsg,true);G.adjustLabelWidth(F.getModel().getComponentType(),true)}).on("mouseout",function(){G.hoverMesg("",true);G.inPlaceLayoutHover(C,false,H,$(K).val(),J);G.adjustLabelWidth(F.getModel().getComponentType(),false)})}}});createPrototype(FileUploadView,FieldView.prototype);var MediaUploadView=(function(A,F,E){FieldView.call(this,A,F,E);var D=false,G=this;var I=A.getModel();var B=G.isFloatLabelAlignment();var C=A.getFieldParentGroup();var H=I.isSubformField();var J=false;this.focus=function(){$(A.getUploadElement()).trigger("focus")};this.fieldEvents=function(){F.regFileUploadEvent();$(A.getImageIcons()).css("z-index",A.getFieldDOM().style.zIndex+1+"");if(I.getDefaultValue()!=""&&I.getDefaultValue()!=undefined){if(B&&!H){if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}J=true;$(A.getImageIcons().querySelector(".calcIcon")).append(i18n.restoreMsg);G.setRestoreWidth();$(A.getImageIcons()).hide();$(A.getFieldParentDiv()).addClass("zc-bottomColr")}else{$($(A.getImageIcons()).children("span").eq(1)).removeAttr("tabindex")}G.bindFieldHoverEvent(A.getFieldParentDiv().querySelector(".zc-file-upload"));G.bindFieldFocusEvent(A.getFileInput(),A.getFieldParentDiv().querySelector(".zc-file-upload"),false);if(!B||H){if(isMobileBrowser()&&A.hiddenDiv()!=undefined){G.hoverMesg(i18n.cameraHoverMsg)}else{G.hoverMesg(i18n.selectfileMsg)}}$(A.getImageIcons().querySelectorAll(".calcIcon")).on("mouseenter mouseleave",function(K){if(K.type=="mouseenter"){G.adjustLabelWidth(F.getModel().getComponentType(),true);G.placeHolderMsgRelatedChanges($(this),true);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().addClass("zc-restore-hover")}if($(this).find("i").hasClass("media-1-video-64")){$(this).parent().parent().addClass("zc-video-upload-hover")}if($(this).find("i").hasClass("media-1-audio-91")){$(this).parent().parent().addClass("zc-audio-upload-hover")}if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().addClass("zc-image-upload-hover")}}else{if(K.type=="mouseleave"){G.adjustLabelWidth(F.getModel().getComponentType(),false);if($(this).find("i").hasClass("arrows-4-undo-29")){$(this).parent().parent().removeClass("zc-restore-hover")}G.placeHolderMsgRelatedChanges($(this),false);if($(this).find("i").hasClass("media-1-video-64")){$(this).parent().parent().removeClass("zc-video-upload-hover")}if($(this).find("i").hasClass("media-1-audio-91")){$(this).parent().parent().removeClass("zc-audio-upload-hover")}if($(this).find("i").hasClass("arrows-2-square-upload")){$(this).parent().parent().removeClass("zc-image-upload-hover")}}}});$(A.getImageIcons().querySelectorAll(".calcIcon")).off("click");$(A.getImageIcons().querySelectorAll(".calcIcon")).on("click keyup focus blur",function(K){if(K.type=="focus"){$(this).addClass("zc-icon-focus");$(A.getFieldParentDiv()).addClass("zc-field-focus");G.placeHolderMsgRelatedChanges($(this),true);return }else{if(K.type=="blur"){$(this).removeClass("zc-icon-focus");$(A.getFieldParentDiv()).removeClass("zc-field-focus");G.placeHolderMsgRelatedChanges($(this),false);return }else{if(K.type=="keyup"&&K.which!=13){return }}}if($(this).find("i").hasClass("media-1-video-64")){K.preventDefault();$(A.getUploadElement()).trigger("focus");F.getMediaPopup().openCamRecorder(A)}if($(this).find("i").hasClass("media-1-audio-91")){K.preventDefault();$(A.getUploadElement()).trigger("focus");F.getMediaPopup().openAudioRecorder(A)}if($(this).find("i").hasClass("arrows-2-square-upload")){$(A.getFileInput()).trigger("click")}if($(this).find("i").hasClass("arrows-4-undo-29")){A.getFileInput().removeAttr("tabindex");$($(A.getField()).parent()[0].querySelector(".arrows-4-undo-29.file-restore")).trigger("click");$(A.getImageIcons()).hide();if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}A.getFileInput().focus()}});if(A.hiddenDiv()!=undefined){$(A.hiddenDiv()).on("click",function(K){$(this).parent()[0].querySelector(".videoIcon").trigger("click")})}};this.placeHolderMsgRelatedChanges=function(L,K){if(K){G.inPlaceLayoutHover(C,true,H,"",J);if(J&&!$(L).find("i").hasClass("arrows-4-undo-29")){$(A.getImageIcons().querySelector(".calcIcon")).hide()}if($(L).find("i").hasClass("media-1-video-64")){G.hoverMesg(i18n.cameraHoverMsg);if(J){G.hoverMesg(i18n.cameraHoverMsg,true)}}if($(L).find("i").hasClass("media-1-audio-91")){G.hoverMesg(i18n.audioHoverMsg);if(J){G.hoverMesg(i18n.audioHoverMsg,true)}}if($(L).find("i").hasClass("arrows-2-square-upload")){G.hoverMesg(i18n.localuploadHoverMsg);if(J){G.hoverMesg(i18n.localuploadHoverMsg,true)}}}else{G.hoverMesg(i18n.selectfileMsg);if(B&&!H){G.inPlaceLayoutHover(C,false,H,$(A.getUploadElement()).val(),J);G.hoverMesg("",true)}if(J){G.inPlaceLayoutHover(C,true,H,"",J);$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block");G.hoverMesg("",true)}}};this.setRestoreWidth=function(){if(J){var L=$($(A.getField()).parent()[0].querySelector(".filename")).width();var M=$(A.getImageIcons().querySelector(".calcIcon:last-child")).width()+1;var K=L-(2*M)-2;$(A.getImageIcons().querySelector(".calcIcon")).width(K);$(A.getImageIcons().querySelector(".calcIcon")).css("display","inline-block")}};this.hoverMesg=function(K,L){if(I.getDefaultValue()==undefined||I.getDefaultValue()==""||L){$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html(K)}};this.createUpload=function(K){K.beforeSend=function(){F.showLoader();F.getFormController().addActiveUploads()};K.success=function(P,Q,U){G.hoverMesg("",true);F.hideLoader();F.getFormController().removeActiveUploads();var O=[];var T=false;for(var W in P){var L=P[W];for(var R=0,N=L.length;R<N;R++){var M=L[R];if(M.status=="error"){O.push(M.docName)}else{if(M.status=="mismatchedTypeError"){T=true;O.push(M.errorMsg)}}}}var V=F.getMediaPopup();F.clearError();V.clearError();$(A.getImageIcons()).hide();$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html("");if(O.length>0){var S=(O.length>1)?"The following files are too larget to upload":"The following file is too large to upload";if(T){S=""}S+=O;K.error(S);V.setError()}else{A.getFileInput().removeAttr("tabindex");if(B&&!H){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}if(!$(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).addClass("zc-bottomColr")}F.setValue(JSON.stringify(P));$(A.getFileInput()).trigger("focus");D=true}$(F.getField()).trigger("onuserinput");F.getView().bindFormulaForFileType(F)};K.ondelete=function(L){$(A.getFieldParentDiv().querySelector(".zc-file-upload")).trigger("mouseleave");G.setRestoreWidth();$(A.getImageIcons()).show();if(!K.isDefaultValuePreseent){$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html(i18n.selectfileMsg)}if($(A.getFieldParentDiv()).hasClass("zc-bottomColr")){$(A.getFieldParentDiv()).removeClass("zc-bottomColr")}F.setValue("");if(B&&!H){$(C).addClass("zc-focus");if(!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}}if(J){A.getFileInput().attr("tabindex","-1")}else{A.getFileInput().focus()}D=false;$(F.getField()).trigger("onuserinput");F.getView().bindFormulaForFileType(F)};K.onrestore=function(L){F.setValue(L);D=false};K.error=function(R){F.clearError();F.hideLoader();var O=F.getMediaPopup();F.getFormController().removeActiveUploads();if(typeof R=="object"){var N;try{N=JSON.parse(R.responseText)[0][0].errorMsg}catch(M){try{var Q=new DOMParser().parseFromString(R.responseText,"text/html");var P=JSON.parse(Q.getElementsByName("errorMeta")[0].value).errorCode;N=P=="VIRUS_DETECTED"?i18n.virusdetected:P=="FILE_SIZE_MORE_THAN_ALLOWED_SIZE"?i18n.fileuploadsizelimit:i18n.fileuploaderror}catch(L){N=i18n.fileuploaderror}}$(A.getImageIcons()).show();$($(A.getField()).parent()[0].querySelector(".filename")).html("");$($(A.getField()).parent()[0].querySelector(".zc-image-hover-msg")).html(i18n.selectfileMsg);F.showError(N)}else{if(typeof R=="string"){F.showError(R)}else{O.setError();O.showError(R)}}F.clear();LIB._stopLoading();clearTimeout(F.getFormController().submitTimeout)};$(A.getUploadElement()).upload(K)};this.addToStore=function(){return D};this.destroy=function(){$(A.getUploadElement()).upload("destroy")};this.disableField=function(){A.getUploadElement().attr("disabled",true);$(A.getImageIcons().querySelectorAll(".calcIcon")).addClass("zc-eventDisable");A.getUploadElement().parent().addClass("zc-disabled");A.getUploadElement().parent().parent().addClass("zc-hideicon")};this.enableField=function(){A.getUploadElement().attr("disabled",false);A.getUploadElement().parent().removeClass("zc-disabled");A.getUploadElement().parent().parent().removeClass("zc-hideicon");$(A.getImageIcons().querySelectorAll(".calcIcon")).addClass("zc-eventDisable")};this.bindFocus=function(){if(!H){var K=A.getUploadElement();if(!LIB._isNull($(K).val())&&!$(C).hasClass("zc-label-float")){$(C).addClass("zc-label-float")}$(K).on("mouseover",function(){G.inPlaceLayoutHover(C,true,H,"",J);G.hoverMesg(i18n.selectfileMsg,true);G.adjustLabelWidth(F.getModel().getComponentType(),true)}).on("mouseout",function(){G.hoverMesg("",true);G.inPlaceLayoutHover(C,false,H,$(K).val(),J);G.adjustLabelWidth(F.getModel().getComponentType(),false)})}};this.getUploadField=function(){return A.getUploadField()}});createPrototype(MediaUploadView,FieldView.prototype);var SelectView=(function(D,C,B){FieldView.call(this,D,C,B);var A=this;this.setValue=function(E){$(D.getField()).select2("zcData",E);D.getModel().setDefaultValue(E);if(this.isFloatLabelAlignment()){D.getField().trigger("blur")}};this.destroy=function(){D.getField().select2("destroy")};this.focus=function(){var E=this.getField();if(D.getField().data("select2")==undefined){setTimeout(function(){A.setFocus(E)},10)}else{A.setFocus(E)}};this.setFocus=function(F){if(ZCGlobal.isMobileLayout){var E=$(F).data("select2");$(E.focusser).attr("readonly","readonly")}F.select2("focus")};this.fieldEvents=function(){if(C.getModel().isCompositeSubField()){return }else{setTimeout(function(){C.createSelect()},0)}var E=C.getModel();var F=D.getField();if(!E.isSubformField()&&E.getComponentType()==FieldType.INLINE_RADIO){F=$(D.getFieldDOM().querySelectorAll("input"))}$(F).on("change",function(){if($(this).val()==Constants.OTHER_OPTION){D.getOtherValueContainer().show(400)}else{D.getOtherValueContainer().hide(400)}})};this.getSelectedChoice=function(){return D.getModel().getDefaultValue()};this.intitateSelect=function(F,I){var K=this;var M=true;var E=this.isFloatLabelAlignment();var L=!LIB._isNull(K.getValue());if(E&&L&&!D.getFieldParentGroup().hasClass("zc-label-float")){if(D.getModel().getComponentType()==FieldType.LIST&&D.getModel().getDefaultValue().length==0){L=false}if(L){D.getFieldParentGroup().addClass("zc-label-float")}}function J(){if(E){D.getFieldParentGroup().addClass("zc-focus");if(!D.getFieldParentGroup().hasClass("zc-label-float")){D.getFieldParentGroup().addClass("zc-label-float")}}var O=$(this).data("select2");var N=this;setTimeout(function(){var S=C.getFormController().getModel().getFirstFieldName();if(!O.opened()&&!$(N).parent(".form-field").hasClass("select2Err")&&S!=C.getModel().getActualLabelName()){var V=false;var Q=C.getModel();if(Q.hasAddToParent()){var P=0;var R=Q.getChoices("");var U=R.length;var T=D.getField().select2("data");if(!isNull(T)){P=T.length}if(P>0){R=R.filter(function(W){return(W.text!="")});U=R.length}if(U==P){V=true}}if(Q.isFromReport()||V){O.open()}}$(N).parent(".form-field").removeClass("select2Err")},0)}var G=D.getField().select2(F).on("change",function(N){if(!D.getModel().isFromReport()){if(F.multiple){$(this).data().select2.highlight(0)}}else{I.reinitZCScrollPane()}if(C.getModel().getSystemDisplayType()==100){C.triggerFormHeightCalculation()}}).on("select2-loaded",function(){C.positionDropDown($("#select2-drop")[0],$(D.getDropDownWrapper()));if(F.multiple&&F.isFirstValue){$(this).data().select2.highlight(0)}}).on("select2-opening",function(){if(M){$(F.data).each(function(P,O){if(O!=undefined){var Q=document.createElement("textarea");O.text=decode(Q,O.text);if(!D.getModel().isLookup()){O.id=(D.getModel().isTranslatedField()?decode(Q,O.id):Q.value)}}});M=false;if(ZCGlobal.isMobileLayout){G.select2("container").find(".select2-focusser").attr("readonly","readonly")}var N=C.getModel();if(F.data.length<=10&&!N.isExternalField()&&N.isSaturated("")){D.getSearchBoxContainer().addClass("select2-search-hidden select2-offscreen")}}}).on("select2-open",function(){if(F.multiple){$(this).data().select2.highlight(0)}}).one("select2-focus",J).on("select2-blur",function(){$(this).one("select2-focus",J);if(E){if(D.getFieldParentGroup().hasClass("zc-focus")){D.getFieldParentGroup().removeClass("zc-focus")}var N=!LIB._isNull(K.getValue());if(D.getModel().getComponentType()==FieldType.INLINE_PICK_LIST){var O=D.getModel().getDefaultValue();O=(O!=undefined&&O!=null)?O.id:"";if(Constants.OTHER_OPTION==O){N=true}}if(D.getModel().getComponentType()==FieldType.LIST){N=D.getModel().getDefaultValue().length>0}if(!N){D.getFieldParentGroup().removeClass("zc-label-float")}}}).on("select2-selecting",function(P){var N=D.getField().select2("data");if(D.getModel().isSingleSelect()){N=P.object}else{if(N!=null&&N.length>0){N.push(P.object)}else{N=[];N.push(P.object)}}if(ZCGlobal.isMobileLayout){G.select2("container").find(".select2-focusser").attr("readonly","readonly")}N=(N==null)?"":N;D.getModel().setDefaultValue(N);if(D.getModel().isFromReport()){var O=P.choice;var R=D.getField().select2("data");var Q=0;if(R!=null){$.each(R,function(S,T){if(T.id instanceof Object){$.each(T.id,function(U,V){Q++})}else{Q++}})}if(O.id instanceof Object){$.each(O.id,function(S,T){Q++})}else{Q++}if(Q>6){D.getField().select2("close");$.alert({msg:i18n.searchlimit});return false}}}).on("select2-clearing",function(N){D.getModel().setDefaultValue("")}).on("select2-removing",function(Q){var N=D.getField().select2("data");for(var P=0;P<N.length;P++){var O=N[P];if(Q.choice.id==O.id&&Q.choice.text==O.text){N.splice(P,1)}}D.getModel().setDefaultValue(N)});if(D.getModel().isFromReport()){$((D.getField().parent()).find(".select2-search-field > input.select2-input")).on("paste",function(O,N){var P=$.trim(O.originalEvent.clipboardData.getData("text"));$(this).val(P);return false});$(D.getField()).trigger("focus")}var H=D.getModel().getLabelName();D.getFieldParent().find(".select2-input").attr("name","zc-sel2-inp-"+H);D.getFieldParent().find(".select2-input").attr("autocomplete","new-zc-sel2-inp-"+H);D.getFieldParent().find(".select2-focusser.select2-offscreen").attr("name","zc-sel2-foc-"+H);D.getFieldParent().find(".select2-focusser.select2-offscreen").attr("autocomplete","new-zc-sel2-foc-"+H);return G};this.disableField=function(){var G=function(){var H=navigator.userAgent;if(H.indexOf("MSIE ")!=-1){return true}if(H.indexOf("Trident/")!=-1){return true}if(H.indexOf("Edge/")!=-1){return true}return false};if(G()==true){var F=D.getField().select2("data");D.getField().select2("destroy");D.getField().prop("disabled",true);C.createSelect();D.getField().select2("data",F)}else{D.getField().prop("disabled",true)}var E=D.getModel();if(E.isOtherEnabled()){D.getOtherValueField().attr("disabled",true);if(isEdgeBrowser()){D.getOtherValueField().attr("readonly",true)}}};this.enableField=function(){this.getField().attr("disabled",false);var E=D.getModel();if(E.isOtherEnabled()){D.getOtherValueField().prop("disabled",false);if(isEdgeBrowser()){D.getOtherValueField().attr("readonly",false)}}};this.loadValues=function(H){var F=C.getModel();var G={};G=C.getFormController().collectData();if(F.isSubformField()){G.subformName=F.getFormModel().getLabelName();G.rowseqid=F.getRowID()}var E=F.isSubformField()?F.getFormModel().getFormModel():F.getFormModel();G.formAccessType=E.getAccessType();if(C.getChildRelation()!=""){G=$.extend(G,C.getChildRelation())}if(H!==undefined){G.noOfRecsInCache=H}if(E.hasPrivateLink()&&!isNull(E.getPrivateLink())){G.privatelink=E.getPrivateLink()}$.ajax({url:C.getURL().getRelDataURL(),method:"POST",data:G,success:function(L){var K=null,J="",M=1;var I=F.getChoices(J).length;F.addChoices(J,M,L,true);if(J==""&&F.isFromReport()==undefined){C.toggleSearchBox(L)}K={more:L.isSaturated,results:L};if(K.results.length==0&&!L.isSaturated){loadValues(200);return }C.setValue(F.getChoices(""));F.lookupFirstFetchCompleted()}})}});createPrototype(SelectView,FieldView.prototype);var DropdownView=(function(C,B,A){SelectView.call(this,C,B,A);this.getValue=function(){if(C.getModel().isName_PrefixField()||C.getModel().isAddress_CountryField()){var J=C.getModel().getLabelName();var G=B.getParentField();if(C.getModel().isName_PrefixField()){return G.getView().getValue(J)}var L="";var K=G.getView().getValue(J);L=Constants.COUNTRY_MAP[K];L=(L!=undefined)?L:K;return L}var E=C.getModel().getDefaultValue();if(C.getModel().getSystemDisplayType()==FieldType.USER_MULTI_SELECT){var H=C.getModel().getDefaultValue(),D=[];if(E!=undefined&&E!=null){for(var I=0,F=H.length;I<F;I++){D.push(H[I].id)}}return JSON.stringify(D)}E=(E!=undefined&&E!=null)?E.id:"";if(E==Constants.OTHER_OPTION){E=$((C.getField().closest(".form-field"))[0].querySelectorAll('div[elname="othersinput"] > input')).val()}return E};$((C.getField().closest(".form-field"))[0].querySelectorAll('div[elname="othersinput"] > input')).on("change",function(){$(B.getField()).trigger("change")})});createPrototype(DropdownView,SelectView.prototype);var RadioView=(function(D,B,A){SelectView.call(this,D,B,A);var C=false;this.trigger=function(E){D.getField().first().trigger(E)};$(D.getFieldParent()).find('span[elname="zc-show-parent"]').on("click",function(){if(!C){B.addNewParent($(D.getFieldDOM().querySelectorAll("input")))}});if(D.getField().data("select2")==undefined){this.focus=function(){this.getField().trigger("focus")}}this.setValue=function(E){if(D.getField().data("select2")!=undefined){D.getField().select2("data",E);D.getModel().setDefaultValue(E)}else{if(E==""){$(D.getFieldDOM().querySelectorAll("input")).filter(":checked").prop("checked",false)}else{$(D.getFieldDOM().querySelectorAll("input")).filter('[value="'+escapeDoubleQuotes(E.id)+'"]').prop("checked",true)}}};this.getValue=function(){var E;if(D.getModel().isSelectField()){E=D.getModel().getDefaultValue();E=(E!=undefined&&E!=null)?E.id:""}else{E=$(D.getFieldDOM().querySelectorAll("input")).filter(":checked").val();E=(E!=null&&E!=undefined)?E:""}if(E==Constants.OTHER_OPTION){E=$((D.getField().closest(".form-field"))[0].querySelector('div[elname="othersinput"] > input')).val()}return E};this.getSelectedChoice=function(){if(D.getField().data("select2")!=undefined){return D.getField().select2("data")}else{return this.getValue()}};this.deselect=function(E){$(D.getFieldDOM().querySelectorAll("input")).filter('[value="'+escapeDoubleQuotes(E[0].id)+'"]').prop("checked",false)};this.clearChoices=function(){D.getOptionsDiv().empty()};this.appendChoices=function(R){var N=D.getOptionsDiv(),S=$(N.find(".choice-table-row")).length;var M=D.getOptionTemplate();var K=D.getModel().getChoiceColumn();var Q=R.length;var G=0;var O=D.getModel();if(O.isOtherEnabled()){var E=N[0].querySelector("input[elname=othersVal"+O.getFormComponentId()+"]");if(E!=null){$(E).parent().parent().empty()}}for(var P=0;P<Q;P++){N.append('<div class="choice-table-row">');for(var J=0,H=K;J<H;J++){if(Q>G){var I=$(M.replace(/\$\{INDEX\}/g,S+1).replace("${CHOICE.TEXT}",R[G].text));I.find("input").val(R[G].id);N.append(I);S++;G++}}N.append("</div>");if((Q==G)&&O.isOtherEnabled()){if((G%K)==0){N.append('<div class="choice-table-row">')}var F=D.getOtherTemplate();N.append(F)}if(Q>G){N.append('<div class="choice-table-row">')}else{break}}var L=$(D.getFieldDOM().querySelectorAll("input"));$(L).off("change").on("change",function(){if($(this).val()==Constants.OTHER_OPTION){D.getOtherValueContainer().show(400)}else{D.getOtherValueContainer().hide(400)}});if(C){this.disableField()}};this.disableField=function(){if(D.getModel().isSelectField()){this.getField().attr("disabled",true)}else{$(D.getFieldDOM().querySelectorAll("input")).prop("disabled","disabled")}C=true};this.enableField=function(){if(D.getModel().isSelectField()){this.getField().attr("disabled",false)}else{$(D.getFieldDOM().querySelectorAll("input")).prop("disabled","")}C=false};$((D.getField().closest(".form-field"))[0].querySelectorAll('div[elname="othersinput"] > input')).on("change",function(){$(B.getField()).trigger("change")})});createPrototype(RadioView,SelectView.prototype);var MultiSelectView=(function(C,B,A){SelectView.call(this,C,B,A);this.getValue=function(){var G=C.getModel().getDefaultValue(),F=[];for(var E=0,D=G.length;E<D;E++){F.push(G[E].id)}return JSON.stringify(F)}});createPrototype(MultiSelectView,SelectView.prototype);var CheckBoxView=(function(D,B,A){SelectView.call(this,D,B,A);var C=false;this.trigger=function(E){D.getField().first().trigger(E)};$(D.getFieldParent()).find('span[elname="zc-show-parent"]').on("click",function(){if(!C){B.addNewParent($(D.getFieldDOM().querySelectorAll("input")))}});if(D.getField().data("select2")==undefined){this.focus=function(){this.getField().trigger("focus")}}this.setValue=function(F){var G=B;var H=G.getModel().isSubformField()?G.getFormController().getFormController():G.getFormController();var E=H.getWorkflowController();if(E==undefined){E=new WorkflowController(H)}if(E.getIsSetTask()){$(D.getFieldDOM().querySelectorAll("input")).prop("checked",false)}if(D.getField().data("select2")!=undefined){$(D.getField()).select2("data",F)}else{if(typeof (F)=="object"){for(ind in F){$(D.getFieldDOM().querySelectorAll("input")).filter('[value="'+escapeDoubleQuotes(F[ind].id)+'"]').prop("checked",true)}}else{if(F==""&&!E.getIsSelectTask()){$(D.getFieldDOM().querySelectorAll("input")).prop("checked",false)}}}D.getModel().setDefaultValue(F)};this.getValue=function(){var I=[],K=D.getModel();if(K.isSearchEnabled()||K.isSubformField()){var J=K.getDefaultValue();for(var G=0,E=J.length;G<E;G++){I.push(J[G].id)}}else{var F=$(D.getFieldDOM().querySelectorAll("input")).serializeArray();if($(D.getFieldDOM().querySelectorAll("input")).prop("disabled")){var H=$(D.getFieldDOM().querySelectorAll("input")).removeAttr("disabled");F=$(D.getFieldDOM().querySelectorAll("input")).serializeArray();H.attr("disabled","disabled")}for(var G=0,E=F.length;G<E;G++){I.push(F[G].value)}}return JSON.stringify(I)};this.getSelectedChoice=function(){if(D.getField().data("select2")!=undefined){return $(D.getField()).select2("data")}else{return $(D.getFieldDOM().querySelectorAll("input")).serializeArray()}};this.deselect=function(E){for(ind in E){$(D.getFieldDOM().querySelectorAll("input")).filter('[value="'+escapeDoubleQuotes(E[ind].id)+'"]').prop("checked",false)}};this.clearChoices=function(){D.getOptionsDiv().empty()};this.appendChoices=function(N){var K=D.getOptionsDiv(),O=$(K.find(".choice-table-row")).length;var J=D.getOptionTemplate();var I=D.getModel().getChoiceColumn();var M=N.length;var E=0;for(var L=0;L<M;L++){K.append('<div class="choice-table-row">');for(var H=0,F=I;H<F;H++){if(M>E){var G=$(J.replace(/\$\{INDEX\}/g,O+1).replace("${CHOICE.TEXT}",N[E].text));G.find("input").val(N[E].id);K.append(G);O++;E++}}K.append("</div>");if(M>E){K.append('<div class="choice-table-row">')}else{break}}if(C){this.disableField()}};this.disableField=function(){if(D.getModel().isSelectField()){this.getField().attr("disabled",true)}else{$(D.getFieldDOM().querySelectorAll("input")).prop("disabled","disabled")}C=true};this.enableField=function(){if(D.getModel().isSelectField()){this.getField().attr("disabled",false)}else{$(D.getFieldDOM().querySelectorAll("input")).prop("disabled","")}C=false}});createPrototype(CheckBoxView,SelectView.prototype);var CompositeView=(function(C,B,A){FieldView.call(this,C,B,A);this.fieldEvents=function(){this.bindEvents()};this.initiateSelect=function(D){};this.bindEvents=function(){};this.getValue=function(D){return C.getChildField(D).val()};this.setValue=function(E,D){if(C.getChildField(E).is("select")){$(C.getChildField(E).find("option[value='"+D+"']")).attr("selected",true);if(this.isFloatLabelAlignment()){C.getField().trigger("blur")}}else{C.getChildField(E).val(D);if(this.isFloatLabelAlignment()){C.getField().trigger("blur")}}};this.resetDropdown=function(D){C.getDropdown(D).get(0).selectedIndex=0};this.clearError=function(){if(this.hasError){C.getFieldParent().removeClass("validationError");C.getAllChildFields().removeClass("childValError");$(C.getFieldParent().find(".fieldErrorMsg")).remove();this.hasError=false}};this.bindFocus=function(){$.each(C.getAllChildFields(),function(){var D=this;var E=$(this).attr("elname");var F=$(D.querySelector("#"+E));if($(F).data("select2")!=undefined){if(!LIB._isNull($(F).val())&&!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}$(F).on("select2-focus",function(){$(D).addClass("zc-focus");if(!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}).on("select2-blur",function(){if($(D).hasClass("zc-focus")){$(D).removeClass("zc-focus")}if(LIB._isNull($(F).val())&&$(D).hasClass("zc-label-float")){$(D).removeClass("zc-label-float")}else{if(!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}})}else{if(!LIB._isNull($(F).val())&&!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}$(F).on("focus",function(){$(D).addClass("zc-focus");if(!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}).on("blur",function(){if($(D).hasClass("zc-focus")){$(D).removeClass("zc-focus")}if(LIB._isNull($(F).val())&&$(D).hasClass("zc-label-float")){$(D).removeClass("zc-label-float")}else{if(!$(D).hasClass("zc-label-float")){$(D).addClass("zc-label-float")}}})}})}});createPrototype(CompositeView,FieldView.prototype);var NameView=(function(C,B,A){CompositeView.call(this,C,B,A);this.destroy=function(){C.getPrefixSelect().select2("destroy")};this.showError=function(D){if(!this.hasError){C.getAllChildFields().each(function(F,G){var H=$(G).attr("elname");var I=$(G).find("#"+H).val();if(isNull(I.trim())){$(G).addClass("childValError")}});var E=$('<div class="fieldErrorMsg zc-dem-box-sizing">'+D+"</div>");C.getFieldParent().append(E).addClass("validationError");this.hasError=true}};this.initiateSelect=function(H){var D=B.getModel().getActualLabelNameFromMapKey("prefix");var E=B.getCompositeSubField(D).getModel();if(H==="prefix"){var F=C.getPrefixSelect().find("option");var K=document.createElement("textarea");$.each(F,function(L,M){K.innerHTML=M.value;M.value=K.value;K.innerHTML=M.text;M.text=K.value});var J=E.getDefaultValue();if(J&&!F.filter('[value="'+J+'"]').length){var G='<option value="'+J+'">'+J+"</option>";$(C.getPrefixSelect()).append(G)}C.getPrefixSelect().val(E.getDefaultValue());var I=C.getPrefixSelect().select2({placeholder:(!this.isFloatLabelAlignment())?(ZCGlobal.isMobileLayout?E.getDisplayName():i18n.prefixplaceholder):" ",minimumResultsForSearch:-1}).on("select2-loaded",function(){B.positionDropDown($("#select2-drop")[0],$(C.getDropDownWrapper()))})}};this.disableField=function(){if(C.getPrefixSelect().length>0&&C.getPrefixSelect().data("select2")!=undefined){C.getPrefixSelect().attr("disabled",true);if(isEdgeBrowser()){C.getPrefixSelect().attr("readonly",true)}}this.getDOM().getInputFields().attr("disabled",true);this.getDOM().getInputFields().attr("readonly",true)};this.enableField=function(){if(C.getPrefixSelect().length>0&&C.getPrefixSelect().data("select2")!=undefined){C.getPrefixSelect().attr("disabled",false);if(isEdgeBrowser()){C.getPrefixSelect().attr("readonly",false)}}this.getDOM().getInputFields().attr("disabled",false);this.getDOM().getInputFields().attr("readonly",false)}});createPrototype(NameView,CompositeView.prototype);var AddressView=(function(E,D,C){CompositeView.call(this,E,D,C);var B=this;this.showGeocodeLoader=function(){E.getAdjustLocationWrapper().append('<i class="zc-geocodeLoader fa fa-spinner fa-spin"></i>')};this.hideGeocodeLoader=function(){$(E.getAdjustLocationWrapper().find(".zc-geocodeLoader")).remove()};this.destroy=function(){E.getCountrySelect().select2("destroy")};this.showError=function(G){if(!this.hasError){var I;try{var H=JSON.parse(G);I=H[Constants.ADDRESS_ERROR_MESSAGE];if(H[Constants.ADDRESS_ERROR_TYPE]==Constants.ADDRESS_INVALID_ZIP_TYPE){E.getPostalCodeEl().addClass("childValError")}else{E.getAllChildFields().each(function(L,M){var N=$(M).attr("elname");var O=$(M).find("#"+N).val();if(N!="locality"&&isNull(O.trim())){$(M).addClass("childValError")}})}}catch(K){I=G}E.getFieldParent().addClass("validationError");var J=$('<div class="fieldErrorMsg zc-dem-box-sizing">'+I+"</div>");J.insertBefore(E.getLocationContainer());this.hasError=true}};var A;var F;this.isCountrySubFieldPresent=function(){return(E.getCountrySelect().length>0)};this.initiateSelect=function(I){if(I==="country"&&this.isCountrySubFieldPresent()&&E.getCountrySelect().data("select2")==undefined){var J=D.getModel().getActualLabelNameFromMapKey("country");var L=D.getCompositeSubField(J).getModel();E.getCountrySelect().val(L.getDefaultValue());var K=Constants.COUNTRY_DATA;if(!LIB._isNull(E.getCountrySelect().val())&&LIB._isNull(A)){var G=K.length;for(var H=0;H<G;H++){if((K[H].id).toLowerCase===(E.getCountrySelect()).val()||(K[H].text).toLowerCase()===(E.getCountrySelect().val()).toLowerCase()){A=K[H];break}}}F=E.getCountrySelect().select2({allowClear:true,placeholder:(!this.isFloatLabelAlignment())?(ZCGlobal.isMobileLayout?L.getDisplayName():i18n.selectplaceholder):" ",data:K}).on("select2-loaded",function(){D.positionDropDown($("#select2-drop")[0],$(E.getDropDownWrapper()))});if(A!=undefined&&A.iso2!=undefined){$(F).val(A.iso2);$(F).select2("data",{id:A.id,text:A.text})}}};this.bindEvents=function(){E.getAdjustLocationIcon().on("click",function(){if(!$(this).hasClass("disable")){B.openZMap()}})};this.openZMap=function(){var H="map_"+(Math.floor(Math.random()*100000));var G={lat:"",lon:""};var J="",I="";$.zcmodal({title:i18n.pickyourlocation,type:ZCModalConstants.JIT_MODAL,width:700,closeOnAnyClick:false,beforeShow:function(K){if(useCompression){require(["mapbox"],function(M){window.mapboxgl=M;L()})}else{L()}function L(){var P;var R=[];var N=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("latitude"));J=G.lat=N.getValue();var M=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("longitude"));I=G.lon=M.getValue();var Q=$("#zMap");function O(){P.on("click",function(S){G.lat=S.lngLat.lat.toString();G.lon=S.lngLat.lng.toString();R.push(G);Q.find("#"+H+" .zc-marker-div").remove();createMarker(R,P)});Q.find('a[elname="mapstyle"]').off("click").on("click",function(){var S=$(this).attr("value");if(S=="basic"){P.setStyle(OpenSansMapReportJson)}else{P.setStyle(streetStyleJson)}Q.find('a[elname="mapstyle"]').removeClass("selected");$(this).addClass("selected")})}P=new mapboxgl.Map({container:H,style:OpenSansMapReportJson,hash:false,zoom:10,maxZoom:18,minZoom:7.5,center:new mapboxgl.LngLat(G.lon,G.lat)});R.push(G);createMarker(R,P);O()}},beforeClose:function(){var K=false;jQuery.each(E.getAllChildFields(),function(O,N){var L=$(this).attr("elname");var M=$(this).find("#"+L);if($(M).val()!=undefined&&isNull($(M).val().trim())){$(N).find("input").focus();K=true;return false}});if(!K){$(E.getPrimaryOuterEl()).find("input").focus()}},buildDOM:function(){var K=500;if($(window).height()<700){K=$(window).height()-230}var L="<div id='zMap' class='zc-form-address-map'>";L+="<div id='"+H+"' style='height:"+K+"px; position:relative'><div style='height:"+K+"px; background-color:#E8E5D8; position:absolute; left:0; top:0; width:100%'>";L+="<div class='zc-map-types'><a elname='mapstyle' value='basic' class='selected zc-map-basic'></a><a elname='mapstyle' value='street' class='zc-map-street'></a></div></div></div>";L+="</div>";return L},buttons:[{id:"Done",name:i18n.done,type:ZCModalConstants.MODAL_SUBMIT,action:function(){var K=(J!=G.lat)||(I!=G.lon);if(K){B.updateZMAPLocation(G.lat,G.lon,true)}}},{id:"Cancel",name:i18n.cancel,type:ZCModalConstants.MODAL_CANCEL,action:function(){}}]})};this.updateZMapAddress=function(J){var L=E.getField();var I;for(k in J){var K=E.getField().find("#"+k).val();if(k=="countryCode"){K=E.getField().find("#country").val()}if(k!="country"&&K!=J[k]){I=E.getField().find("#"+k);break}}E.getInputFields().val("");var H=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("latitude"));H.getView().setValue("");var G=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("longitude"));G.getView().setValue("");for(k in J){if(J[k]==undefined||J[k]==null){$(L).find("#"+k).val("")}else{if(k==="country"){var M={id:J.countryCode,text:Constants.COUNTRY_MAP[J.countryCode]};$(E.getCountrySelect()).select2("data",M);if(this.isFloatLabelAlignment()){E.getField().find("#"+k).trigger("blur")}}else{$(L).find("#"+k).val(J[k]);if(this.isFloatLabelAlignment()){E.getField().find("#"+k).trigger("blur")}}}}if(I!==undefined){$(I).trigger("change")}};this.updateZMAPLocation=function(J,K,G){var I=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("latitude"));I.getView().setValue(J);var H=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("longitude"));H.getView().setValue(K);this.toggleAdjustLocationContent();if(E.getModel().isOnChangeExist()&&G){this.trigger("onuserinput")}};this.disableAdjustLocation=function(){$(E.getAdjustLocationIcon()).addClass("disable");E.getAdjustLocationWrapper().find(".zc-adjustlocation-info").hide()};this.enableAdjustLocation=function(){$(E.getAdjustLocationIcon()).removeClass("disable");E.getAdjustLocationWrapper().find(".zc-adjustlocation-info").show()};this.showWarning=function(H){var G=$('<div class="zc-geocodeWarning"><i class="zc-geocodeWarningIcon zc-li-outline ui-3-alert"></i><span class="zc-geocodeWarning-content">'+H+"</span></div>");E.getAdjustLocationWrapper().append(G)};this.clearWarning=function(){$((E.getAdjustLocationWrapper()).find(".zc-geocodeWarning")).remove()};this.disableField=function(){if(E.getCountrySelect().length>0&&E.getCountrySelect().data("select2")!=undefined){E.getCountrySelect().attr("disabled",true);if(isEdgeBrowser()){E.getCountrySelect().attr("readonly",true)}}var G=E.getPrimarySelectFld();if(G.length>0&&G.data("select2")!=undefined){G.attr("disabled",true);if(isEdgeBrowser()){G.attr("readonly",true)}E.getPrimaryOuterEl().hasClass("map-icon-disable")?"":E.getPrimaryOuterEl().addClass("map-icon-disable")}this.getDOM().getInputFields().attr("disabled",true);this.getDOM().getInputFields().attr("readonly",true)};this.enableField=function(){if(E.getCountrySelect().length>0&&E.getCountrySelect().data("select2")!=undefined){E.getCountrySelect().attr("disabled",false);if(isEdgeBrowser()){E.getCountrySelect().attr("readonly",false)}}var G=E.getPrimarySelectFld();if(G.length>0&&G.data("select2")!=undefined){G.attr("disabled",false);if(isEdgeBrowser()){G.attr("readonly",false)}E.getPrimaryOuterEl().removeClass("map-icon-disable")}this.getDOM().getInputFields().attr("disabled",false);this.getDOM().getInputFields().attr("readonly",false)};this.toggleAdjustLocationContent=function(){var I=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("latitude"));var J=I.getValue();var H=D.getCompositeSubField(E.getModel().getActualLabelNameFromMapKey("longitude"));var G=H.getValue();if(!isNull(J)||!isNull(G)){E.getLocationPlaceHolder().hide();E.getCoordinateInputs().show()}else{E.getLocationPlaceHolder().show();E.getCoordinateInputs().hide()}if(E.getModel().isAdjustLocation()){isNull(J)||isNull(G)?this.disableAdjustLocation():this.enableAdjustLocation()}}});createPrototype(AddressView,CompositeView.prototype);var SubformView=(function(G,D,C){FieldView.call(this,G,D,C);var B=false;var A=this,F=0,H=0,E=0;if(ZCGlobal.isMobileLayout){H=0}E=G.getField().closest("div.formColumn").width()-H;this.fieldEvents=function(){if(B){setTimeout(function(){D.createDefaultRow()},0)}else{D.createDefaultRow()}};this.getValue=function(){return $(G.getField()).val()};this.clearRow=function(){G.setRow(undefined)};this.setRow=function(I){G.setRow(I)};this.bindSortable=function(I){I.containment=G.getField(),G.getInnerWrapper().sortable(I)};this.reorderSubform=function(M,P){var L=$(M).prev(),O=$(M).nextAll('div[elname="dataRow"]'),N=0;if(L.length>0){var J=$(L).attr("rowno");N=parseInt(J.substr(J.indexOf("_")+1,J.length))}var I=N;O.each(function(){K(this,I+2);I++});K(M,N+1);function K(Q,T){var R=$(Q).attr("rowno"),S=R.substr(0,R.indexOf("_"));$(Q).attr("rowno",S+"_"+T)}};this.createNewRow=function(K,M,J){var L=$(M).attr("rowNo",K),I=L[0].querySelector(".form-group");if(G.getModel().getSubformType()==Constants.POPUP_SUBFORM){$(L[0].querySelectorAll(".notes-field")).hide()}if(!J){$(I.querySelectorAll("label")).hide()}if(G.getModel().isEmptyRow()){G.getInnerWrapper().empty();G.getModel().setEmptyRow(false)}G.getInnerWrapper().append(L);return L};this.createVoidRow=function(){var J="t::row_0";G.getModel().setEmptyRow(true);G.getInnerWrapper().append(G.getModel().getVoidRow());var I=G.getRow(J);this.calibrateWidth(I);this.showPlaceHolder(true);G.getBottomAddNewLink().hide();this.getField().addClass("zcPlacehldflow");this.getField().removeClass("zc-placeholder-overflow")};this.getRow=function(I){return G.getRow(I)};this.getDeleteLink=function(I){return G.getDeleteLink(I)};this.getAddLink=function(){return G.getAddNewLink()};this.setFormStyle=function(R,U){var N="",V=1;var I=0;var S=G.getModel();if(!S.isNewSubform()){var L={};while(V<=M()){L=P(V,N,I);N=L.css;I=L.totColsWidth;++V}}else{V=0;var L=P(V,N,I);N=L.css;I=L.totColsWidth}T(N);$(R).parent().css("width",Math.ceil(I)+"px");function P(b,a,Z){var d=0,Y=30;var X=K(O(b));var c=b==0||b==1?"first-column":(b==2?"second-column":"column-"+b);a+=".subform-popup ."+c+" .form-label{width : "+X.LABEL+"px;}";a+=".subform-popup ."+c+" .form-field{width : "+X.INPUT+"px;}";var W=X.LABEL+X.INPUT+d+Y;a+=".subform-popup ."+c+" {width : "+W+"px;}";Z=Z+W;return{css:a,totColsWidth:Z}}function K(a){var c=0,Z=0;for(var Y=0,W=a.length;Y<W;Y++){var X=a[Y],b=X.FIELDCOMPTYPE;if(b==FieldType.SUB_FORM_GRID||b==FieldType.SECTION||b==FieldType.PLAIN_TEXT||b==FieldType.DECISIONBOX){continue}lblWidth=J(X.FIELDCLASSNAME+"-label");inpWidth=Q(X.FIELDCLASSNAME);if(b==FieldType.IMAGE&&X.IMAGETYPE==3){inpWidth=inpWidth+30}if(lblWidth>c){c=lblWidth}if(inpWidth>Z){Z=inpWidth}}return{LABEL:c,INPUT:Z}}function O(Y){var Z=U,a=[];for(var X=0,W=Z.length;X<W;X++){if(Z[X].FIELDCOLUMN==Y){a.push(Z[X])}}return a}function M(){var a=0;var Y=U,Z=[];for(var X=0,W=Y.length;X<W;X++){if(a<Y[X].FIELDCOLUMN){a=Y[X].FIELDCOLUMN}}return a}function J(X){var W=R[0].querySelector("."+X);if(W!=null){return W.getBoundingClientRect().width}return 0}function Q(W){var X=R[0].querySelector(".column-block ."+W+"-group > .form-field");if(X!=null){return X.getBoundingClientRect().width}return 0}function T(W){var X=document.createElement("style");X.type="text/css";if(X.styleSheet){X.styleSheet.cssText=W}else{X.appendChild(document.createTextNode(W))}R[0].appendChild(X)}};this.calibrateWidth=function(N){F=0;var K=$(N[0].querySelectorAll(".form-group")),M=0;K.each(function(){var O=$(this)[0].getBoundingClientRect().width;F+=O});F=Math.ceil(F)+2;G.getInnerWrapper().width(F);if(G.getParentFormDOM().isPopup()&&$(G.getField()).parents(".mono-column").length==1&&!G.getParentFormDOM().isFullScreenPopup()){var I=$(G.getParentFormDOM().getFormParentContainer()).closest(".popupboxOuter")[0].style.width;I=parseInt(I,10);var L=$(G.getParentFormDOM().getFormDOM()).width();if(isNaN(I)&&(F+M>0.9*document.body.offsetWidth)&&(F+M>L)){if(L<0.9*document.body.offsetWidth){L=0.9*document.body.offsetWidth}}if(F+M>L){G.getField().parent().width(L-40);var J=G.getParentFormDOM().getFormParentContainer().parentElement;$(J).trigger("subformFixedHeader",{value:L,type:"w"});if(J.offsetWidth+2>=L){$(G.getParentFormDOM().getFormDOM()).width(J.offsetWidth)}}else{G.getField().parent().width(F+M)}}else{G.getField().parent().width(Math.min((F+M),E))}};this.adjustWidth=function(I){var J=this.getRow(I);if(!J.length){return }sfFields=$(J.find(".form-group:visible")),innerWrapperPadding=2,rowWidth=0;sfFields.each(function(){var K=$(this)[0].getBoundingClientRect().width;rowWidth+=K});rowWidth=Math.ceil(rowWidth)+2;G.getInnerWrapper().width(rowWidth);G.getField().parent().width(Math.min((rowWidth+innerWrapperPadding),G.getField().parents(".formColumn:first").width()-2))};this.clearRows=function(){$(G.getFieldDOM().querySelector(".subform-inner-wrapper"))[0].innerHTML="";this.createVoidRow()};this.hidePlaceHolder=function(){G.getModel().setCentreAddLinkStatus(true);G.getPlaceHolder().css({display:"none"});G.getField().removeClass("zc-placeholder-overflow");G.getBottomAddNewLink().css({display:"block"});if(isMobileBrowser()){G.getBottomAddNewLink().addClass("suform-add-row-link")}};this.showPlaceHolder=function(I){if(I){G.getPlaceHolder().css({opacity:"0"});G.getModel().setCentreAddLinkStatus(false);G.getPlaceHolder().show("blind",{direction:"up"},200,function(){if(G.getModel().hideCentreAddLink()){A.hidePlaceHolder()}else{$(this).animate({opacity:1},200)}})}};this.deleteRow=function(L,K){var I=$((G.getField())[0].querySelector('div[rowNo="'+L+'"]')),J=I.next();I.remove();if(K&&J.length>0){J.find(".form-group").find("label").show();this.updateFieldLableHeight(J)}if(D.getModel().isFormulaExist()){D.getField().trigger("change")}};this.hideAddLink=function(){G.getAddNewLink().hide()};this.showAddLink=function(){G.getAddNewLink().show()};this.hideDeleteLink=function(){G.getDeleteLinks().hide()};this.showDeleteLink=function(){G.getDeleteLinks().show()};this.showError=function(I){if(!this.hasError){var J=$('<div class="fieldErrorMsg zc-dem-box-sizing">'+I+"</div>");G.getFieldParent().parent().append(J);this.hasError=true}};this.clearError=function(){if(this.hasError){$(G.getFieldParent().parent().find(".fieldErrorMsg")).remove();this.hasError=false}};this.bindFieldHelpText=function(){var K=G.getField().parent()[0];if(K!=undefined){var J=$(K.querySelector(".form-field")).width()-4;var I=$('<div class="zc-help-txt" style="white-space:pre-line;width:'+J+'px;"></div>');I.text(fieldModel.getTitle());$(K.querySelector(".form-label")).append(I)}};this.bindFieldDescription=function(){var I={tooltip:G.getModel().getTitle(),position:"auto"};I.tooltipelem=$(G.getField()).parent().find(".zc-label-text");$(I.tooltipelem).tooltipPositionCalc(I);$($(G.getField()[0].querySelector(".subform-placeholder .add_value_link")).find("a[elname=subFormLink]")).tooltipPositionCalc(I)};this.updateFieldLableHeight=function(K){if(ZCGlobal.isMobileLayout){var J=$(K).find(".form-group .form-label");var I=Math.max.apply(null,$(J).map(function(L,M){return $(M).outerHeight()}));$.each($(J),function(L,M){$(M).css("height",I+"px")})}}});createPrototype(SubformView,FieldView.prototype);var PhoneNumberView=(function(A,F,D){FieldView.call(this,A,F,D);var G=this;var H=false;var I=A.getModel();var E;this.getPhoneNumberObj=function(){return E};this.fieldEvents=function(){var Q=this;var P={};P.dropdownContainer=document.body;P.separateDialCode=true;P.preferredCountries=[];P.manualPadding=true;var O=true;if(this.isFloatLabelAlignment()&&!I.isSubformField()){P.customPlaceholder=function(S,T){return""}}var J=false;if(I.getCountryList()!=undefined&&I.getCountryList().trim().length>0){var M=I.getCountryList().split(",");if(C()&&M.indexOf("us")==-1){var K=M.filter(function(S){return Constants.COUNTRY_CODES[1].indexOf(S)!==-1});if(K.length>=0){P.initialCountry=K[0]}}if(M.length==1){J=true}P.onlyCountries=M}E=intlTelInput(A.getFieldDOM(),P);if(I.getParentFormModel().getAccessType()==FormAccessType.VIEW_EDIT_RECORD&&C()){E.setNumber(I.getDefaultValue())}$(A.getField()).on("countrychange",function(T,S){if(O){$(A.getField()).trigger("change")}else{O=true}});if(LIB._isNull($(A.getField()).val())){if(I.getDefaultCountryCode()!=undefined&&I.getDefaultCountryCode().trim().length>0){O=false;E.setCountry(I.getDefaultCountryCode())}else{if(!ZCGlobal.isOnPremiseVersion){O=false;var L=ZCWebStorage.getItem("countrycode");var R=/^[a-zA-Z]{1,2}$/;if(L!=undefined&&L!=""&&R.test(L)){B(P,L)}else{iplocate(function(T){var S=(T&&T.COUNTRY_CODE)?T.COUNTRY_CODE.toLowerCase():"";if(R.test(S)){ZCWebStorage.setItem("countrycode",S)}else{S="us"}B(P,S)},function(){},I.getParentFormModel().getPrivateLink())}}}}$(A.getFlagContainer()).on("click",function(){G.showMask()});$(A.getFlagContainer()).on("keydown",function(S){if(S.keyCode==$.ui.keyCode.UP||S.keyCode==$.ui.keyCode.DOWN||S.keyCode==$.ui.keyCode.SPACE){if(!H){G.showMask()}}else{if(S.keyCode==$.ui.keyCode.TAB||S.keyCode==$.ui.keyCode.ESCAPE){G.hideMask()}else{if(S.keyCode==$.ui.keyCode.ENTER){if($(".country-list").length){G.hideMask()}else{if(!H){G.showMask()}}}}}});$(A.getFlagContainer()).find(".selected-flag").on("focus blur",function(S){if(S.type=="focus"){$(this).addClass("zc-icon-focus")}else{if(S.type=="blur"){$(this).removeClass("zc-icon-focus")}}});$(".zc-scroll-mask").on("click",function(){$(window).scroll();$(".zc-scroll-mask").hide();if(ZCGlobal.isMobileLayout){$(".zc-mobile-frz-layer").hide();$(".zc-mobile-back-button").removeClass("zc-popup-enable")}});if(J){var N=A.getFlagContainer();if(N[0]){N[0].style.pointerEvents="none";N.off("keydown");if(N[0].querySelector(".iti-arrow")){N[0].querySelector(".iti-arrow").style.display="none"}if(N[0].querySelector(".selected-flag")){N[0].querySelector(".selected-flag").removeAttribute("tabindex")}}}};function B(K,J){if(K.onlyCountries==undefined||(K.onlyCountries!=undefined&&K.onlyCountries.indexOf(J)>=0)){E.setCountry(J)}}function C(){var J=I.getDefaultValue();var L=$(A.getField()).data("plugin_intlTelInput");if(L&&L._isRegionlessNanp){return L._isRegionlessNanp(J)}else{var N=["800","822","833","844","855","866","877","880","881","882","883","884","885","886","887","888","889"];var M=J.replace(/\D/g,"");if(M.charAt(0)=="1"){var K=M.substr(1,3);return $.inArray(K,N)>-1}return false}}this.hideMask=function(){unfreeze({container:"body",type:ZCFreezeConstants.MASK_ONLY_TYPE});H=false;if(ZCGlobal.isMobileLayout){$(".zc-mobile-back-button").removeClass("zc-popup-enable")}};this.showMask=function(){if(I.isDisabledField()){return }if(ZCGlobal.appDirectionMeta.isRTL){var L=A.getField()[0].offsetWidth;var K=$(".intl-tel-input.iti-container").css("left");var J=parseInt(L,10)+parseInt(K,10)}H=true;if(ZCGlobal.isMobileLayout){$(".zc-mobile-back-button").addClass("zc-popup-enable")}ifreeze({container:"body",type:ZCFreezeConstants.MASK_ONLY_TYPE,clickCallBack:function(){$(window).scroll();G.hideMask()}});if(ZCGlobal.appDirectionMeta.isRTL){$(".intl-tel-input.iti-container").css({"z-index":1000+"",left:J+"px"})}$(".intl-tel-input.iti-container").css("z-index","1000");$(".intl-tel-input.iti-container").off("click").on("click",function(){$(window).trigger("scroll");G.hideMask()})};this.getValue=function(){var J=A.getField().val();if(!LIB._isNull(J)&&(E.getSelectedCountryData().dialCode!=undefined)){J=E.getNumber()}return J};this.setValue=function(J){E.setNumber(J);$(A.getField()).trigger("blur")};this.destroy=function(){E.destroy()};this.showField=function(){G.getFieldContainer().show();var K=A.getFlagContainer();var J=K.width();if(J!=undefined&&J!=""){$(A.getField()).css("padding-left",(parseInt(J)+6)+"px")}}});createPrototype(PhoneNumberView,FieldView.prototype);var ExternalView=(function(D,C,B){FieldView.call(this,D,C,B);var A=this;this.fieldEvents=function(){D.getActionLink().on("click",function(){var E=D.getField().attr("disabled");if(E!=="disabled"){C.externalWindow()}});D.getField().on("focus",function(){A.triggerExternalOnUser()})};this.triggerExternalOnUser=function(){};this.openExternalWindow=function(E){window.open(E,"creatorwindow","location=1,status=1,scrollbars=1,width=700,height=600")}});createPrototype(ExternalView,FieldView.prototype);var RichTextView=(function(E,D,B){FieldView.call(this,E,D,B);this.zeObj={setContent:function(F){},getContent:function(){return""}};var A=this;var C=Math.floor(Math.random()*10000000);this.focus=function(){var G=D.getFormController().getModel().getFirstFieldName();var H=D.getLabelName();var F=this;if(this.zeObj.state!=undefined&&(G==H)){if(this.zeObj.state=="loading"){setTimeout(function(){F.trigger("focus")},1000)}else{if(this.zeObj.state=="loaded"){F.zeObj.squireInstance._win.trigger("focus")}}}};this.fieldEvents=function(){E.getRTDiv().attr("id",C);D.createEditor()};this.safelyCreateEditor=function(F){try{ZE}catch(H){if(H instanceof ReferenceError){setTimeout(function(){A.safelyCreateEditor(F)},1000);return }}F.allowAttrsInsertHTML=["target"];F.maintainStructure=true;var G=D.getFormController().getModel().getFirstFieldName();var I=D.getLabelName();if(G==I){ZE_Init.needEditorFocus=true}else{ZE_Init.needEditorFocus=false}this.zeObj=ZE.create(F);this.addCreatorClass();A.disablePageTranslate();ZE_Init.loadFontCss(this.zeObj,ZCPath.staticCss.fontsBundledCss);ZE_Init.changeFFDisplay()};this.addCreatorClass=function(){$(this.zeObj.editordiv).find("ul:has(span.zei-bgclr)").addClass("zc-ze-richtext-bgclr");$(this.zeObj.editordiv).find("ul:has(span.zei-textclr)").addClass("zc-ze-richtext-textclr");$(this.zeObj.editordiv).find("ul:has(em#fontsizeEditable)").addClass("zc-ze-richtext-fs");$(this.zeObj.editordiv).find("ul:has(span.zeFFce)").addClass("zc-ze-richtext-ff");$(this.zeObj.editordiv).find("li:has(span.zei-arrow.ze-big)").addClass("zc-ze-richtext-modeswitch")};this.disablePageTranslate=function(){if(this.zeObj==undefined||this.zeObj.doc==undefined||(this.zeObj.state!=undefined&&this.zeObj.state=="loading")){setTimeout(function(){A.disablePageTranslate()},500);return false}$(this.zeObj.doc.body).addClass("notranslate")};this.createEditor=function(F){F.id=C+"";this.safelyCreateEditor(F)};this.getValue=function(){var F=(this.zeObj.doc==undefined||this.zeObj.state=="loading")&&this.zeObj.initobj!=undefined?this.zeObj.initobj.content:this.zeObj.getContent();if(F.length==15&&F=="<div><br></div>"){F=""}return F};this.setValue=function(H){var F=this;if(this.zeObj.doc==undefined||(this.zeObj.state!=undefined&&this.zeObj.state=="loading")){setTimeout(function(){F.setValue(H)},1000);return false}var G=document.activeElement;this.zeObj.setContent(H);G.focus()};this.disableField=function(){var F=this;if(this.zeObj.doc==undefined||(this.zeObj.state!=undefined&&this.zeObj.state=="loading")){setTimeout(function(){F.disableField()},1000);return false}if($.browser.msie){this.zeObj.doc.body.contentEditable="false"}else{this.zeObj.doc.body.contentEditable="false";this.zeObj.doc.designMode="off"}this.zeObj.initobj.allowPaste=false;var G=E.getRTDiv();G.addClass("rt-disable-toolbar")};this.enableField=function(){var F=this;if(this.zeObj.doc==undefined||(this.zeObj.state!=undefined&&this.zeObj.state=="loading")){setTimeout(function(){F.enableField()},1000);return false}if($.browser.msie){this.zeObj.doc.body.contentEditable="true"}else{this.zeObj.doc.body.contentEditable="true";this.zeObj.doc.designMode="on"}this.zeObj.initobj.allowPaste=true;var G=E.getRTDiv();G.removeClass("rt-disable-toolbar")};this.destroy=function(){$(E.getRTDiv()).empty();$(E.getRTDiv()).removeAttr("id")}});createPrototype(RichTextView,FieldView.prototype);var SignatureView=(function(D,C,B){FieldView.call(this,D,C,B);var F,E;var A=false;this.isResized=function(){return A};this.fieldEvents=function(){var P=D.getField();var O=$(P).attr("recordsequence");O=O!==undefined?O:"1";if(O!=="0"){var G=D.getSignature();$(D.getClearEle()).on("click",function(){$(G).jSignature("reset");if(ZCGlobal.isMobileLayout){F=[];E=[]}});var H={"decor-color":"transparent",height:"100",width:"300"};if(ZCGlobal.isMobileLayout){H.width="ratio";H.height="ratio";H.sizeRatio="3"}$(G).jSignature(H);$(G).addClass("signature-div");if(ZCGlobal.isMobileLayout){var L=$(G).find("canvas")[0];var J=D.getSignatureTextarea();var N=D.getSignatureContainer();if($(N).find(".zc-signature-freezer").length==0){$(G).wrap("<div class='zc-signature-freezer'></div>")}$(G).find(".signature-line-div").hide();$(N).delegate("div.zc-signature-freezer","click",function(){var Q=$.zcmodal({type:ZCModalConstants.JIT_MODAL,closeOnAnyClick:false,bodyClass:"zc-signature-popup",wrapperClass:"zc-signature-wrapper",title:D.getModel().getDisplayName(),buildDOM:function(){return'<div class="signature-popup-clear"><span><span><a href="javascript:;" elename="signatureClear">[Clear]</a></span></div><div elename="signaturePopup" class="signature-div" labelname="Signature"></div><div class="signature-line-div"></div>'},afterOpen:function(R){var T=$(R).find("div[eleName=signaturePopup]");var S={"decor-color":"transparent",height:"ratio",width:"ratio",sizeRatio:"3"};$(T).jSignature(S);T.height("100%");if(F!=undefined&&F[1]!=undefined&&F[1].length!=0){data=K($(G).jSignature("getSettings").data,T.width()*1/G.width());$(T).jSignature("updateSetting","data",data)}$(R).find("a[eleName=signatureClear]").on("click",function(){$(T).jSignature("clear");$(G).jSignature("clear");F=[];E=[]})},afterClose:function(R){},buttons:[{id:"Done",name:i18n.done,type:ZCModalConstants.MODAL_SUBMIT,action:function(R){A=false;$(G).jSignature("clear");var S=$(R).find("div[eleName=signaturePopup]");F=$(S).jSignature("getData","base30");if(F!=undefined&&F[1]!=undefined&&F[1].length!=0){E=$(S).jSignature("getData","image");data=K($(S).jSignature("getSettings").data,G.width()*1/S.width());$(G).jSignature("updateSetting","data",data)}return false}},{id:"Cancel",name:i18n.cancel,type:ZCModalConstants.MODAL_CANCEL,action:function(){}}]})});window.addEventListener("resize",function(){A=true});function K(V,S){var Y=[];var Q,W,T,U,R,X;for(W=0,T=V.length;W<T;W++){X=V[W];Q={x:[],y:[]};for(U=0,R=X.x.length;U<R;U++){Q.x.push(X.x[U]*S);Q.y.push(X.y[U]*S)}Y.push(Q)}return Y}function I(){var Q=$(".zc-signature-popup").find("div[elename=signaturePopup]");if($zcmodal.hasInstance()){if($(Q).find(".jSignature").length==1){$(Q).jSignature("updateSetting","height",Q.width()/3)}}}}var M=D.getSignatureContainer();if($(M).attr("isHide")==="true"){$(M).hide()}$(D.getToggleChangeEle()).on("click",function(){$(D.getEditEle()).hide();$(M).show();$(G).attr("update","true");D.getToggleRestoreEle().parent().show()});$(D.getToggleRestoreEle()).on("click",function(){$(D.getEditEle()).show();$(M).hide();$(G).attr("update","false")})}};this.getValue=function(){var J=D.getSignature(),L=$(J).attr("isEdit"),N="add",K="true";if(L==="true"){N="update";K=$(J).attr("update");K=K===undefined?true:K}if(K==="true"){var O=$(J).jSignature("getData","base30");if(O!=undefined){var I=O[1].length;if(I>0){var M=$(J).jSignature("getData","image");var G=N+","+M[1];D.getSignatureTextarea().val(G)}else{if(L){D.getSignatureTextarea().val("")}}}if(ZCGlobal.isMobileLayout){if(F!=undefined&&F[1]!=undefined){var G=N+","+E[1];D.getSignatureTextarea().val(G)}}}var H=D.getSignatureTextarea().val();return(H!=undefined&&H!=null)?H:""};this.setValue=function(H){if(H==""){var G=D.getSignature().attr("isEdit");if(G){D.getToggleRestoreEle().trigger("click")}else{D.getClearEle().trigger("click")}}}});createPrototype(SignatureView,FieldView.prototype);var PlainTextView=(function(C,B,A){FieldView.call(this,C,B,A);this.getValue=function(){return C.getField().html()};this.setValue=function(D){C.getField().html(D)}});createPrototype(PlainTextView,FieldView.prototype);var ZiaTextView=(function(C,B,A){FieldView.call(this,C,B,A);this.setValue=function(I,D){var H;var E=B.getModel();if(E.getFieldType()==FieldType.CURRENCY){var G=new CurrencyView(C,B,A);var F=G.formatNumber(I);if(F!==""){H=E.getCurrencySymbol()+" "+F}else{H=F}}else{if(I instanceof Object){H=I.text}else{H=I}}$(C.getField()).val(H);if(!D){E.setFieldValue(I)}if(this.hasInfo){this.clearInfo()}if(this.isFloatLabelAlignment()){C.getField().trigger("blur")}};this.getValue=function(){var D=B.getModel();return D.getFieldValue()};this.hasInfo=false;this.showInfo=function(D){if(!this.hasInfo){this.setValue(D,true);C.getFieldParent().addClass("ziaInfo");this.hasInfo=true}};this.clearInfo=function(){if(this.hasInfo){C.getFieldParent().removeClass("ziaInfo");this.hasInfo=false}}});createPrototype(ZiaTextView,FieldView.prototype);var ZiaMultiLineView=(function(C,B,A){FieldView.call(this,C,B,A);this.setValue=function(F,D){$(C.getField()).val(F);if(this.isFloatLabelAlignment()){C.getField().trigger("blur")}var E=B.getModel();if(!D){E.setFieldValue(F)}if(this.hasInfo){this.clearInfo()}};this.getValue=function(){var D=B.getModel();return D.getFieldValue()};this.hasInfo=false;this.showInfo=function(F){if(!this.hasInfo){this.setValue(F,true);C.getFieldParent().addClass("ziaInfo");this.hasInfo=true;var D=B.getModel().getHeight();if(D!=undefined&&D>20){var E=(D-12)/2;C.getField().css("padding-top",E+"px")}}};this.clearInfo=function(){if(this.hasInfo){C.getFieldParent().removeClass("ziaInfo");C.getField().css("padding-top","");this.hasInfo=false}}});createPrototype(ZiaMultiLineView,FieldView.prototype);var SectionView=(function(C,B,A){FieldView.call(this,C,B,A);this.getValue=function(){if(bootConfig.isC5){return C.getField().html()}};this.setValue=function(D){if(bootConfig.isC5){C.getField().html(D)}};this.hideField=function(){if(bootConfig.isC5){C.getSectionRow().hide()}};this.showField=function(){if(bootConfig.isC5){C.getSectionRow().show()}};if(isMobileBrowser()&&!this.getDOM().getModel().isSubformField()&&this.getDOM().getModel().getFormModel().getFormAlign()==FormAlign.TOP){if(!this.hasVisibleFields(C.getSectionRow())){if(!C.getSectionRow().hasClass("zc-section-hidden-field")){C.getSectionRow().addClass("zc-section-hidden-field")}}}});createPrototype(SectionView,FieldView.prototype);var IntegrationView=(function(E,D,B){FieldView.call(this,E,D,B);var A=this;var F=E.getModel();var C;this.fieldEvents=function(){this.getField().on("click.loadOptions",function(){A.opener()});this.getField().on("keydown.loadOptions",function(G){if(G.keyCode==13||G.keyCode==40){G.preventDefault();if(!A.isOptionsVisible()){A.opener();G.stopPropagation()}}});E.getValueDeselectButton().on("click.deselectValue",function(G){G.stopPropagation();D.removeValue()});E.getDropArrow().on("click.loadOptionsClickOnDropArrow",function(G){G.stopPropagation();A.opener()})};this.onDemandBindEvents=function(){E.getOptionsDOM().find(".zc-combined-lookup-search-table").on("scroll.fetchData",function(){var G=Math.abs(($(this).scrollTop()+$(this).outerHeight())-$(this)[0].scrollHeight);if(G<100&&!F.getInProgress()){D.preDataController()}});$(document).on("keydown.lookupSearchTable",function(H){if(A.isOptionsVisible()){var G=E.getHighlightedRow();if(H.keyCode==40){H.preventDefault();if(G.next().length>0&&!F.getInProgress()){G.toggleClass("combined-lookup-row-highlighted");G.next().toggleClass("combined-lookup-row-highlighted");A.changeViewPort()}else{if(!F.getInProgress()){D.preDataController()}}}else{if(H.keyCode==38){H.preventDefault();if(G.prev().length>0&&!F.getInProgress()){G.toggleClass("combined-lookup-row-highlighted");G.prev().toggleClass("combined-lookup-row-highlighted");A.changeViewPort()}}else{if(H.keyCode==13&&!F.getInProgress()){H.preventDefault();D.setValueForField(G[0])}else{if(H.keyCode==27){H.preventDefault();H.stopPropagation();A.hideOptionsDOM();D.reset(false)}}}}}});E.getOptionsDOM().on("click.integFieldFocus",".zc-combined-lookup-search-icon",function(){$(this).prev("input").focus()});E.getOptionsDOM().on("keydown.showOptionsOnKeyDown",".zc-combined-lookup-search-head > input",A.triggerSearchQuery);E.getOptionsDOM().on("mouseover.highlightCurrentRecord","tbody[layoutType=options] > tr , tbody[layoutType=search] > tr",function(H){var G=E.getHighlightedRow();G.removeClass("combined-lookup-row-highlighted");$(H.target.parentElement).toggleClass("combined-lookup-row-highlighted")});E.getOptionsDOM().on("click.selectIntegrationValue","tbody[layoutType=options] > tr , tbody[layoutType=search] > tr",function(){D.setValueForField(this)})};this.unbindOnDemandEvents=function(){E.getOptionsDOM().find(".zc-combined-lookup-search-table").off("scroll.fetchData");$(document).off("keydown.lookupSearchTable");E.getOptionsDOM().off("click.integFieldFocus");E.getOptionsDOM().off("keydown.showOptionsOnKeyDown");E.getOptionsDOM().off("mouseover.highlightCurrentRecord");E.getOptionsDOM().off("click.selectIntegrationValue")};this.triggerSearchQuery=function(G){if(!((G.keyCode>=36&&G.keyCode<=40)||(G.keyCode>=16&&G.keyCode<=20)||(G.keyCode==9||G.keyCode==16)||(G.keyCode==91||G.keyCode==92))){clearTimeout(C);A.unbindSearchInputsTooltip();E.setSearchTriggerInputElement(G.target);C=setTimeout(D.initiateSearchQuery,1000)}};this.opener=function(){if(!A.isOptionsVisible()){A.constructColumnHeaders(F.getColumnHeaders());A.showSpinner();A.showDefaultLayout();E.getScrollMask().show();E.getOptionsLayout().empty();E.getSearchLayout().empty();E.getMessageContainer().empty();F.setCurrentDisplayCount(0);D.preDataController();E.getScrollMask().on("click.integrationPopup",function(G){if(!($(G.target).closest(".zc-combined-lookup-search").length)&&!$(G.target).is(A.getField())){if(A.isOptionsVisible()){A.hideOptionsDOM();D.reset(false)}}});E.getFieldParentGroup().addClass("zc-focus");if(A.isFloatLabelAlignment()){E.getFieldParentGroup().addClass("zc-label-float")}}A.showOptionsDOM();A.onDemandBindEvents();A.searchBoxFocusHanlder();A.firstRowFocus()};this.constructOptionsDOM=function(){if(!E.getOptionsDOM().length){var G='<div id="zc-combined-lookup-popup" class="zc-dem-clearfix zc-combined-lookup-field-select" style="display:none"><div class="zc-combined-lookup-spinner"><i class="fa fa-spin fa-spinner"></i></div><div class="zc-combined-lookup-search-container"><table id="combinedlookupsearchtable" class="zc-combined-lookup-search"><thead><tr></tr></thead></table><div class="zc-combined-lookup-search-table"><table id="combinedlookupoptionstable"><tbody layouttype="options"></tbody><tbody layouttype="search"></tbody><tbody layouttype="default" class="zc-combined-lookup-nodata"><tr><td><span id="combinedlookupmessagecontainer"></span></td></tr></tbody></table></div></div></div>';$("body").append(G)}};this.changeViewPort=function(){var H=$(E.getHighlightedRow()).offset().top;var J=$(E.getHighlightedRow()).outerHeight(true);var I=$(E.getSearchOptionsTable()).outerHeight(true);var G=$(E.getSearchOptionsTable()).offset().top;if((G+I-H-J)<0){E.getSearchOptionsTable().scrollTop(E.getSearchOptionsTable().scrollTop()+J)}else{if((G-H)>0){E.getSearchOptionsTable().scrollTop(E.getSearchOptionsTable().scrollTop()-J)}}};this.isOptionsVisible=function(){return E.getOptionsDOM().is(":visible")};this.showOptionsDOM=function(){E.getOptionsDOM().show();F.setActive(true);A.calculatePosition();E.getSearchOptionsTable().scrollTop(0)};this.calculatePosition=function(){var T=E.getOptionsDOM();T.removeClass("zc-lookup-single-display-small zc-lookup-single-display-medium zc-lookup-single-display-large zc-combined-lookup-overflow-column");if(E.getSearchHeader().find("th").length<=3){if(E.getSearchHeader().find("th").length==1){if(E.getFieldParent().hasClass("smallSizeLive")){T.addClass("zc-lookup-single-display-small")}else{if(E.getFieldParent().hasClass("mediumSizeLive")){T.addClass("zc-lookup-single-display-medium")}else{if(E.getFieldParent().hasClass("largeSizeLive")){T.addClass("zc-lookup-single-display-large")}}}}T.addClass("zc-combined-lookup-overflow-column")}var G=T.outerHeight();var M=T.outerWidth();var P=A.getField().offset();var I=A.getField().outerWidth();var J=P.top+A.getField().outerHeight(true)-1,S=J;var R=P.left,N=R;var U=$(document).height();var L=$(document).width();var K=P.top;var Q=U-J;var O=L-R;var H=R;if(Q>=G){S=J}else{if(Q<G&&K>=G){S=K-G}else{if(K>Q){S=0;E.getSearchOptionsTable().height(K-40)}else{S=J;E.getSearchOptionsTable().height(Q-40)}}}if(O>=M){N=R}else{if(O<M&&H>=M){N=(R+I)-M}}$(T).css({top:S+"px",left:N+"px"});E.getSearchOptionsTable().width(E.getSearchHeader().width())};this.hideOptionsDOM=function(){E.getOptionsDOM().hide();F.setActive(false);E.getScrollMask().off("click.integrationPopup");E.getSearchOptionsTable().removeAttr("style");E.getScrollMask().hide();E.getFieldParentGroup().removeClass("zc-focus");if(A.isFloatLabelAlignment()&&!this.getField().attr("field-id")){E.getFieldParentGroup().removeClass("zc-label-float")}E.getOptionsLayout().empty();E.getSearchLayout().empty();E.getMessageContainer().empty();A.unbindOnDemandEvents()};this.showSpinner=function(){E.getSearchSpinner().show();E.getOptionsDOM().addClass("zc-combined-lookup-freeze")};this.hideSpinner=function(){E.getSearchSpinner().hide();E.getOptionsDOM().removeClass("zc-combined-lookup-freeze")};this.showDeselector=function(){E.getValueDeselectButton().removeClass("zc-hide")};this.hideDeselector=function(){E.getValueDeselectButton().addClass("zc-hide")};this.disableField=function(){this.getField().attr("disabled",true);E.getFieldParentGroup().addClass("zc-disabled");if(isEdgeBrowser()){this.getField().attr("readonly",true)}};this.enableField=function(){this.getField().attr("disabled",false);E.getFieldParentGroup().removeClass("zc-disabled");if(isEdgeBrowser()){this.getField().attr("readonly",false)}};this.disableSearchBoxes=function(){E.getSearchBoxes().attr("disabled",true);E.getSearchBoxes().css("cursor","not-allowed")};this.enableSearchBoxes=function(){E.getSearchBoxes().removeAttr("disabled");E.getSearchBoxes().removeAttr("style")};this.showOptionsLayout=function(){E.getOptionsLayout().show();E.getSearchLayout().hide();E.getDefaultLayout().hide()};this.showSearchLayout=function(){E.getOptionsLayout().hide();E.getSearchLayout().show();E.getDefaultLayout().hide()};this.showDefaultLayout=function(){E.getOptionsLayout().hide();E.getSearchLayout().hide();E.getDefaultLayout().show()};this.unbindSearchInputsTooltip=function(){$.each(E.getSearchBoxes(),function(G,H){$(H).off("mouseenter mouseleave keydown click focus")});$("#zc-fieldTooltipMsg").remove()};this.bindTooltip=function(J,H,I){var G={tooltip:J,position:"bottom",zindex:10000};if(I){G.showTooltip=true;G.removeOnFocusOut=true}$(H).tooltipPositionCalc(G)};this.showPlaceholder=function(){if(!A.isFloatLabelAlignment()||F.isSubformField()){this.getField().attr("placeholder",i18n.selectplaceholder)}};this.hidePlaceholder=function(){this.getField().attr("placeholder","")};this.firstRowFocus=function(){if(!E.getCurrentLayout().is(E.getDefaultLayout())){if(E.getCurrentLayout().find("tr").length>0){E.getCurrentLayout().find("tr:first").addClass("combined-lookup-row-highlighted")}}};this.constructColumnHeaders=function(K){var I=E.getSearchTableHeader().find("tr");I.empty();var L,N,G,J;for(var H=0;H<K.length;H++){L=$("<th/>");N=$("<div/>").addClass("zc-combined-lookup-search-head");G=$('<input type="text" maxLength="255" autocomplete="off"/>');J=$("<i/>").addClass("ui-1-zoom zc-li-outline zc-combined-lookup-search-icon");$(G).attr("placeholder",K[H].displayName);var M=K[H].isSearchable;if(!M){$(G).attr("disabled",true);$(G).css("cursor","not-allowed");this.bindTooltip(i18n.searchnotsupported,N,false)}N.append(G);if(M){N.append(J)}L.append(N);I.append(L)}};this.constructOptions=function(I,N,O){var G,H;if(O){I.empty()}for(var M in N){var J=N[M];G=$("<tr/>").attr("id",J.id);var L=J.actualText.split("@#zoho-comma#@");for(var K in L){H=$("<td/>").text(L[K]);G.append(H)}I.append(G)}};this.getSearchValues=function(){var H=[];var N,G,K;var M=E.getSearchBoxes();var J=F.getColumnHeaders();var L=false;for(var I=0;I<M.length;I++){N={};G=J[I].labelName;K=M[I].value;N.labelName=G;N.value=K;H.push(N)}return H};this.searchBoxFocusHanlder=function(){$.each(E.getSearchBoxes(),function(G,H){if($(H).attr("disabled")==undefined){$(H).focus();return false}})}});createPrototype(IntegrationView,FieldView.prototype);var FormCacheHelper=(function(){var E;var J=this,G="";var B="formCache",H=36000*1000,I=36000*1000;this.status=G;this.isCacheAvailable=function(){return(G==="available")};this.generateKey=function(N,S){var R=(N).lastIndexOf("/form/")+"/form/".length,Q=N.length;for(var M=R;M<N.length;++M){if(N[M]==="/"||N[M]==="?"){Q=M;break}}var P=(N).substring(R,Q);var O=ZCGlobal.scopeName+"_"+ZCGlobal.appLinkName+"_"+P;if(S!==undefined){O+=S.formAccessType===FormAccessType.VIEW_EDIT_RECORD?"_edit":"";O+=S.editOnlyViewFields!==undefined?"_"+S.editOnlyViewFields:""}O+=previewURLRegex.test(N)?"_preview":"";return O};this.getFormHash=function(M){if(!J.isCacheAvailable()){throw new Error("Cache not initialized")}return new Promise(function(O,N){E.get(M).then(function(R){if(R!==undefined){var P=JSON.parse(R),Q=new Date().getTime();(Q-P.last_used_time<I)?O(P.CACHE_HASH):O(undefined)}else{O(undefined)}},function(){O(undefined)})})};this.getFormCache=function(M){if(!J.isCacheAvailable()){throw new Error("Cache not initialized")}return new Promise(function(O,N){E.get(M).then(function(Q){var P=JSON.parse(Q);O(P);P.last_used_time=new Date().getTime();E.put(M,JSON.stringify(P))},function(){O(undefined)})})};this.cacheForm=function(R,N,Q){if(!J.isCacheAvailable()){throw new Error("Cache not initialized")}var O=J.generateKey(N,Q);var P={MODEL:R.MODEL,HTML:R.HTML,CACHE_HASH:R.CACHE_HASH,cacheKey:O,last_used_time:new Date().getTime()};var M=E.put(O,JSON.stringify(P));return M};this.initFormCache=function(){return F().then(L)};function F(){return Promise.resolve()}function L(){var N=new CacheFactory();var O=CacheType.INMEMORY;E=N.getCache({type:O,poolName:B,NeededFallback:true});var M=E.init().then(A).then(function(){G="available"});catchPromiseChain(M,function(P){Console.log(P);G="error"})}function A(){return Promise.resolve()}function D(O){var P=O.map(function(Q){return E.get(Q)});var N=[];P.forEach(function(Q){Q.then(M)});return Promise.all(P).then(function(){return N});function M(Q){if(Q!==undefined){N.push(Q)}}}function C(M){var N=new Date().getTime();return M.map(function(O){return JSON.parse(O)}).filter(function(O){return(N-O.last_used_time>I)}).map(function(O){return O.cacheKey})}function K(N){var M=N.map(function(O){return E.remove(O)});return Promise.all(M)}});window.formCacheHelper=new FormCacheHelper();formCacheHelper.initFormCache();